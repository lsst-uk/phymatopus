#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2018, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#

# -----------------------------------------------------
# Login to our external VM.
#[user@desktop]

    ssh Etalema

    # -----------------------------------------------------
    # Create a container to work with.
    #[user@virtual]

        docker run \
            --rm \
            --tty \
            --interactive \
            --hostname openstacker \
            --env SSH_AUTH_SOCK=/tmp/ssh_auth_sock \
            --volume "${HOME}/settings/:/etc/phymatopus/" \
            --volume ${SSH_AUTH_SOCK}:/tmp/ssh_auth_sock \
            phymatopus/openstack-client \
            bash

        # -----------------------------------------------------
        # Load our OpenStack settings.
        #[root@openstacker]

            source '/etc/phymatopus/openstack.settings'

        # -----------------------------------------------------
        # Load our OpenStack and Eleanor functions.
        #[root@openstacker]

            source 'openstack-utils.sh'
            source 'eleanor-utils.sh'
            source 'eleanor-init.sh'

        # -----------------------------------------------------
        # Load our cluster and ZTF settings.
        #[root@openstacker]

            source '/etc/phymatopus/cluster.settings'
            source '/etc/phymatopus/ztf.settings'

        # -----------------------------------------------------
        # Configure our ssh proxy command.
        #[root@openstacker]

            sshproxy="ssh ${sshopts[*]} ${sshuser:?}@${controlip:?} nc %h %p"

        # -----------------------------------------------------
        # Build a list of ROE Kafka nodes.
        #[root@openstacker]

            delim=''
            port='9092'
            roeconnect=''

            for address in $(cat /etc/phymatopus/kfidents.txt)
            do
                roeconnect="${roeconnect}${delim}${address}:${port}"
                delim=','
            done

            echo "Kafka brokers [${roeconnect}]"

# BUG
# Not sure if this actually replied with the internal or external addresses ...

                Kafka brokers [172.16.49.217:9092,172.16.49.214:9092,172.16.49.12:9092,172.16.49.208:9092]
                Kafka brokers [192.168.1.5:9092,192.168.1.8:9092,192.168.1.15:9092,192.168.1.10:9092]

        # -----------------------------------------------------
        # Check the offsets in the ZTF brokers.
        #[root@openstacker]

            brokers=${ztfconnect:?}

cat > topics.txt << EOF
ztf_20181010_programid1
ztf_20181011_programid1
ztf_20181012_programid1
EOF

            for topicid in $(cat topics.txt)
            do
                echo "--------------------"
                echo "Topic [${topicid:?}]"

                if [[ "${topicid:?}" =~ ^ztf_[0-9]{8}_programid1$ ]]
                then
                    echo "
                        docker run --rm phymatopus/kafka-core \
                            bin/kafka-run-class.sh kafka.tools.GetOffsetShell \
                                --broker-list "${brokers:?}" \
                                --topic "${topicid:?}" \
                                --time -1

                        docker run --rm phymatopus/kafka-core \
                            bin/kafka-run-class.sh kafka.tools.GetOffsetShell \
                                --broker-list "${brokers:?}" \
                                --topic "${topicid:?}" \
                                --time -2
                        " \
                    | ssh \
                        ${sshopts[*]} \
                        ${sshuser:?}@${controlip:?} | sort
                else
                    echo "Skipping topic"
                fi
            done

                --------------------
                Topic [ztf_20181010_programid1]
                ztf_20181010_programid1:0:0
                ztf_20181010_programid1:0:0
                ztf_20181010_programid1:10:0
                ztf_20181010_programid1:10:0
                ztf_20181010_programid1:11:0
                ztf_20181010_programid1:11:0
                ztf_20181010_programid1:12:0
                ztf_20181010_programid1:12:0
                ztf_20181010_programid1:13:0
                ztf_20181010_programid1:13:0
                ztf_20181010_programid1:1:0
                ztf_20181010_programid1:1:0
                ztf_20181010_programid1:2:0
                ztf_20181010_programid1:2:0
                ztf_20181010_programid1:3:0
                ztf_20181010_programid1:3:0
                ztf_20181010_programid1:4:0
                ztf_20181010_programid1:4:0
                ztf_20181010_programid1:5:0
                ztf_20181010_programid1:5:0
                ztf_20181010_programid1:6:0
                ztf_20181010_programid1:6:0
                ztf_20181010_programid1:7:0
                ztf_20181010_programid1:7:0
                ztf_20181010_programid1:8:0
                ztf_20181010_programid1:8:0
                ztf_20181010_programid1:9:0
                ztf_20181010_programid1:9:0
                --------------------
                Topic [ztf_20181011_programid1]
                ztf_20181011_programid1:0:0
                ztf_20181011_programid1:0:0
                ztf_20181011_programid1:10:0
                ztf_20181011_programid1:10:0
                ztf_20181011_programid1:11:0
                ztf_20181011_programid1:11:0
                ztf_20181011_programid1:12:0
                ztf_20181011_programid1:12:0
                ztf_20181011_programid1:13:0
                ztf_20181011_programid1:13:0
                ztf_20181011_programid1:1:0
                ztf_20181011_programid1:1:0
                ztf_20181011_programid1:2:0
                ztf_20181011_programid1:2:0
                ztf_20181011_programid1:3:0
                ztf_20181011_programid1:3:0
                ztf_20181011_programid1:4:0
                ztf_20181011_programid1:4:0
                ztf_20181011_programid1:5:0
                ztf_20181011_programid1:5:0
                ztf_20181011_programid1:6:0
                ztf_20181011_programid1:6:0
                ztf_20181011_programid1:7:0
                ztf_20181011_programid1:7:0
                ztf_20181011_programid1:8:0
                ztf_20181011_programid1:8:0
                ztf_20181011_programid1:9:0
                ztf_20181011_programid1:9:0
                --------------------
                Topic [ztf_20181012_programid1]
                ztf_20181012_programid1:0:0
                ztf_20181012_programid1:0:0
                ztf_20181012_programid1:10:0
                ztf_20181012_programid1:10:0
                ztf_20181012_programid1:11:0
                ztf_20181012_programid1:11:0
                ztf_20181012_programid1:12:0
                ztf_20181012_programid1:12:0
                ztf_20181012_programid1:13:0
                ztf_20181012_programid1:13:0
                ztf_20181012_programid1:1:0
                ztf_20181012_programid1:1:0
                ztf_20181012_programid1:2:0
                ztf_20181012_programid1:2:0
                ztf_20181012_programid1:3:0
                ztf_20181012_programid1:3:0
                ztf_20181012_programid1:4:0
                ztf_20181012_programid1:4:0
                ztf_20181012_programid1:5:0
                ztf_20181012_programid1:5:0
                ztf_20181012_programid1:6:0
                ztf_20181012_programid1:6:0
                ztf_20181012_programid1:7:0
                ztf_20181012_programid1:7:0
                ztf_20181012_programid1:8:0
                ztf_20181012_programid1:8:0
                ztf_20181012_programid1:9:0
                ztf_20181012_programid1:9:0

        # -----------------------------------------------------
        # Check the offsets in the ROE brokers.
        #[root@openstacker]

            brokers=${roeconnect:?}

            for topicid in $(cat topics.txt)
            do
                echo "--------------------"
                echo "Topic [${topicid:?}]"

                if [[ "${topicid:?}" =~ ^ztf_[0-9]{8}_programid1$ ]]
                then
                    echo "
                        docker run --rm phymatopus/kafka-core \
                            bin/kafka-run-class.sh kafka.tools.GetOffsetShell \
                                --broker-list "${brokers:?}" \
                                --topic "${topicid:?}" \
                                --time -1

                        docker run --rm phymatopus/kafka-core \
                            bin/kafka-run-class.sh kafka.tools.GetOffsetShell \
                                --broker-list "${brokers:?}" \
                                --topic "${topicid:?}" \
                                --time -2
                        " \
                    | ssh \
                        ${sshopts[*]} \
                        ${sshuser:?}@${controlip:?} | sort

                else
                    echo "Skipping topic"
                fi
            done

            --------------------
            Topic [ztf_20181010_programid1]
            [2018-10-12 10:35:30,954] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181010_programid1)] from broker [BrokerEndPoint(1,192.168.1.8,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:35:31,986] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181010_programid1)] from broker [BrokerEndPoint(0,192.168.1.5,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:35:32,994] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181010_programid1)] from broker [BrokerEndPoint(3,192.168.1.10,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:35:34,002] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181010_programid1)] from broker [BrokerEndPoint(2,192.168.1.15,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Exception in thread "main" kafka.common.KafkaException: fetching topic metadata for topics [Set(ztf_20181010_programid1)] from broker [ArrayBuffer(BrokerEndPoint(1,192.168.1.8,9092), BrokerEndPoint(0,192.168.1.5,9092), BrokerEndPoint(3,192.168.1.10,9092), BrokerEndPoint(2,192.168.1.15,9092))] failed
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:77)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Caused by: java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            ... 3 more
            [2018-10-12 10:35:40,588] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181010_programid1)] from broker [BrokerEndPoint(3,192.168.1.10,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:35:41,605] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181010_programid1)] from broker [BrokerEndPoint(0,192.168.1.5,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:35:42,614] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181010_programid1)] from broker [BrokerEndPoint(1,192.168.1.8,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:35:43,619] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181010_programid1)] from broker [BrokerEndPoint(2,192.168.1.15,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Exception in thread "main" kafka.common.KafkaException: fetching topic metadata for topics [Set(ztf_20181010_programid1)] from broker [ArrayBuffer(BrokerEndPoint(3,192.168.1.10,9092), BrokerEndPoint(0,192.168.1.5,9092), BrokerEndPoint(1,192.168.1.8,9092), BrokerEndPoint(2,192.168.1.15,9092))] failed
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:77)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Caused by: java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            ... 3 more
            --------------------
            Topic [ztf_20181011_programid1]
            [2018-10-12 10:35:51,240] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181011_programid1)] from broker [BrokerEndPoint(1,192.168.1.8,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:35:52,260] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181011_programid1)] from broker [BrokerEndPoint(0,192.168.1.5,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:35:53,268] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181011_programid1)] from broker [BrokerEndPoint(3,192.168.1.10,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:35:54,275] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181011_programid1)] from broker [BrokerEndPoint(2,192.168.1.15,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Exception in thread "main" kafka.common.KafkaException: fetching topic metadata for topics [Set(ztf_20181011_programid1)] from broker [ArrayBuffer(BrokerEndPoint(1,192.168.1.8,9092), BrokerEndPoint(0,192.168.1.5,9092), BrokerEndPoint(3,192.168.1.10,9092), BrokerEndPoint(2,192.168.1.15,9092))] failed
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:77)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Caused by: java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            ... 3 more
            [2018-10-12 10:36:00,895] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181011_programid1)] from broker [BrokerEndPoint(1,192.168.1.8,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:36:01,914] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181011_programid1)] from broker [BrokerEndPoint(2,192.168.1.15,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:36:02,922] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181011_programid1)] from broker [BrokerEndPoint(0,192.168.1.5,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:36:03,928] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181011_programid1)] from broker [BrokerEndPoint(3,192.168.1.10,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Exception in thread "main" kafka.common.KafkaException: fetching topic metadata for topics [Set(ztf_20181011_programid1)] from broker [ArrayBuffer(BrokerEndPoint(1,192.168.1.8,9092), BrokerEndPoint(2,192.168.1.15,9092), BrokerEndPoint(0,192.168.1.5,9092), BrokerEndPoint(3,192.168.1.10,9092))] failed
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:77)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Caused by: java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            ... 3 more
            --------------------
            Topic [ztf_20181012_programid1]
            [2018-10-12 10:36:11,110] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181012_programid1)] from broker [BrokerEndPoint(2,192.168.1.15,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:36:12,129] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181012_programid1)] from broker [BrokerEndPoint(0,192.168.1.5,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:36:13,137] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181012_programid1)] from broker [BrokerEndPoint(3,192.168.1.10,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:36:14,145] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181012_programid1)] from broker [BrokerEndPoint(1,192.168.1.8,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Exception in thread "main" kafka.common.KafkaException: fetching topic metadata for topics [Set(ztf_20181012_programid1)] from broker [ArrayBuffer(BrokerEndPoint(2,192.168.1.15,9092), BrokerEndPoint(0,192.168.1.5,9092), BrokerEndPoint(3,192.168.1.10,9092), BrokerEndPoint(1,192.168.1.8,9092))] failed
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:77)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Caused by: java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            ... 3 more
            [2018-10-12 10:36:20,874] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181012_programid1)] from broker [BrokerEndPoint(3,192.168.1.10,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:36:21,891] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181012_programid1)] from broker [BrokerEndPoint(2,192.168.1.15,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:36:22,905] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181012_programid1)] from broker [BrokerEndPoint(0,192.168.1.5,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            [2018-10-12 10:36:23,910] WARN Fetching topic metadata with correlation id 0 for topics [Set(ztf_20181012_programid1)] from broker [BrokerEndPoint(1,192.168.1.8,9092)] failed (kafka.client.ClientUtils$)
            java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Exception in thread "main" kafka.common.KafkaException: fetching topic metadata for topics [Set(ztf_20181012_programid1)] from broker [ArrayBuffer(BrokerEndPoint(3,192.168.1.10,9092), BrokerEndPoint(2,192.168.1.15,9092), BrokerEndPoint(0,192.168.1.5,9092), BrokerEndPoint(1,192.168.1.8,9092))] failed
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:77)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:98)
	            at kafka.tools.GetOffsetShell$.main(GetOffsetShell.scala:79)
	            at kafka.tools.GetOffsetShell.main(GetOffsetShell.scala)
            Caused by: java.net.SocketTimeoutException
	            at sun.nio.ch.SocketAdaptor$SocketInputStream.read(SocketAdaptor.java:211)
	            at sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)
	            at java.nio.channels.Channels$ReadableByteChannelImpl.read(Channels.java:385)
	            at org.apache.kafka.common.network.NetworkReceive.readFromReadableChannel(NetworkReceive.java:122)
	            at kafka.network.BlockingChannel.readCompletely(BlockingChannel.scala:131)
	            at kafka.network.BlockingChannel.receive(BlockingChannel.scala:122)
	            at kafka.producer.SyncProducer.liftedTree1$1(SyncProducer.scala:82)
	            at kafka.producer.SyncProducer.kafka$producer$SyncProducer$$doSend(SyncProducer.scala:79)
	            at kafka.producer.SyncProducer.send(SyncProducer.scala:124)
	            at kafka.client.ClientUtils$.fetchTopicMetadata(ClientUtils.scala:63)
	            ... 3 more
            [root@openstacker /]#


         # -----------------------------------------------------
         # Check the disc space on each of our Kafka nodes.
         #[root@openstacker]

             innerpath=/var/local/inner/kafka
             outerpath=/var/local/outer/kafka

             for address in $(cat /etc/phymatopus/kfidents.txt)
                 do
                     echo "
                         echo "---- [${address:?}] ----"
                         df -h /
                         echo "---- ----"
                         df -h "${outerpath:?}/data-00"
                         echo "---- ----"
                         df -h "${outerpath:?}/data-01"
                         " \
                     | ssh \
                         ${sshopts[*]} \
                         -o ProxyCommand="${sshproxy:?}" \
                         ${sshuser:?}@${address:?}
                 done

                ---- [192.168.1.5] ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vda3        39G  4.6G   33G  13% /
                ---- ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vdb        512G  400G  112G  79% /var/local/outer/kafka/data-00
                ---- ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vdc        512G  400G  112G  79% /var/local/outer/kafka/data-01
                ---- [192.168.1.8] ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vda3        39G   11G   27G  28% /
                ---- ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vdb        512G  400G  112G  79% /var/local/outer/kafka/data-00
                ---- ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vdc        512G  400G  112G  79% /var/local/outer/kafka/data-01
                ---- [192.168.1.15] ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vda3        39G   10G   27G  28% /
                ---- ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vdb        512G  400G  112G  79% /var/local/outer/kafka/data-00
                ---- ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vdc        512G  400G  112G  79% /var/local/outer/kafka/data-01
                ---- [192.168.1.10] ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vda3        39G   12G   26G  32% /
                ---- ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vdb        512G  400G  112G  79% /var/local/outer/kafka/data-00
                ---- ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vdc        512G  400G  112G  79% /var/local/outer/kafka/data-01


         # -----------------------------------------------------
         # Check the running containers on the Kafka nodes.
         #[root@openstacker]

             for address in $(cat /etc/phymatopus/kfidents.txt)
                 do
                     echo "
                         echo "---- [${address:?}] ----"
                         docker ps -a
                         echo ""
                         " \
                     | ssh \
                         ${sshopts[*]} \
                         -o ProxyCommand="${sshproxy:?}" \
                         ${sshuser:?}@${address:?}
                 done


                ---- [192.168.1.5] ----
                CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES
                27cc83641088        confluentinc/cp-kafka:4.1.1   "/etc/confluent/dock"   3 months ago        Up 3 months         0.0.0.0:9092->9092/tcp   stevedore_emily_1

                ---- [192.168.1.8] ----
                CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES
                b31b6de75cf4        confluentinc/cp-kafka:4.1.1   "/etc/confluent/dock"   3 months ago        Up 3 months         0.0.0.0:9092->9092/tcp   stevedore_emily_1

                ---- [192.168.1.15] ----
                CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES
                cc955ce1dc6c        confluentinc/cp-kafka:4.1.1   "/etc/confluent/dock"   3 months ago        Up 3 months         0.0.0.0:9092->9092/tcp   stevedore_emily_1

                ---- [192.168.1.10] ----
                CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES
                0a8037ccf02a        confluentinc/cp-kafka:4.1.1   "/etc/confluent/dock"   3 months ago        Up 3 months         0.0.0.0:9092->9092/tcp   stevedore_emily_1

         # -----------------------------------------------------
         # Check the running containers on the Mirror Maker nodes.
         #[root@openstacker]

             for address in $(cat /etc/phymatopus/mmidents.txt)
                 do
                     echo "
                         echo "---- [${address:?}] ----"
                         docker ps -a
                         echo ""
                         " \
                     | ssh \
                         ${sshopts[*]} \
                         -o ProxyCommand="${sshproxy:?}" \
                         ${sshuser:?}@${address:?}
                 done


                ---- [192.168.1.25] ----
                CONTAINER ID        IMAGE                   COMMAND                  CREATED             STATUS              PORTS               NAMES
                073369e07052        phymatopus/kafka-core   "bin/kafka-mirror-ma"   10 hours ago        Up 10 hours                             stevedore_tina_1

                ---- [192.168.1.22] ----
                CONTAINER ID        IMAGE                   COMMAND                  CREATED             STATUS              PORTS               NAMES
                1b7c6be6128b        phymatopus/kafka-core   "bin/kafka-mirror-ma"   10 hours ago        Up 10 hours                             stevedore_tina_1

                ---- [192.168.1.7] ----
                CONTAINER ID        IMAGE                   COMMAND                  CREATED             STATUS              PORTS               NAMES
                7915089df79a        phymatopus/kafka-core   "bin/kafka-mirror-ma"   10 hours ago        Up 10 hours                             stevedore_tina_1

                ---- [192.168.1.9] ----
                CONTAINER ID        IMAGE                   COMMAND                  CREATED             STATUS              PORTS               NAMES
                99dff0811292        phymatopus/kafka-core   "bin/kafka-mirror-ma"   10 hours ago        Up 10 hours                             stevedore_tina_1


        # -----------------------------------------------------
        # Process the gobal list of nodes.
        #[root@openstacker]

            unset controller

            unset unknowns
            unknowns=()

            unset kfidents
            kfidents=()

            unset mmidents
            mmidents=()

            unset zkidents
            zkidents=()

            echo ""
            echo "Processing OpenStack nodes"

            for ident in $(
                openstack \
                    server list \
                    --format json \
                | jq -r '.[] | .ID'
                )
                do
                    echo "Ident [$ident]"
                    getvminfo "${ident:?}"

                    name=$(getvmname)
                    echo "Name  [$name]"

                    case "${name}" in

                        ${phym_project:?}-zookeeper*)
                            echo "Match zookeeper"
                            zkidents+=(${ident})
                            ;;

                        ${phym_project:?}-mirror*)
                            echo "Match mirror"
                            mmidents+=(${ident})
                            ;;

                        ${phym_project:?}-kafka*)
                            echo "Match kafka"
                            kfidents+=(${ident})
                            ;;

                        ${phym_project:?}-control*)
                            echo "Match control"
                            controller=${ident}
                            ;;

                        *)
                            echo "unknown"
                            unknowns+=(${ident})
                            ;;
                    esac
                done


                Ident [c32e11f0-9d4f-49b0-bde5-a79306756a68]
                Name  [Raminiara-mirror-3]
                Match mirror
                Ident [e69f88ab-0da0-4faa-9aa7-ce1f71646dbf]
                Name  [Raminiara-mirror-2]
                Match mirror
                Ident [6883a92d-82e1-4635-8a36-2430597ade3f]
                Name  [Raminiara-mirror-1]
                Match mirror
                Ident [08aad6fe-3392-45f8-a49d-dc9aae314c7f]
                Name  [Raminiara-mirror-0]
                Match mirror
                Ident [bb409e47-cf2c-4e64-aea6-e893e5d05100]
                Name  [Raminiara-kafka-4]
                Match kafka
                Ident [aa73a427-2e9f-413d-a37b-3eaf35799f00]
                Name  [Raminiara-kafka-3]
                Match kafka
                Ident [6f971e48-f760-43bf-ad98-c38a7b90c321]
                Name  [Raminiara-kafka-2]
                Match kafka
                Ident [0824e436-6213-4893-8a67-40d152e7402c]
                Name  [Raminiara-kafka-1]
                Match kafka
                Ident [8cd2c6af-88b2-4cff-8c8a-81240bf63f70]
                Name  [Raminiara-zookeeper-3]
                Match zookeeper
                Ident [4bd50e51-ec0e-4d8d-9a2b-9af9185aefba]
                Name  [Raminiara-zookeeper-2]
                Match zookeeper
                Ident [39cbbdb1-4adb-439d-b9fe-71b8c48ec14b]
                Name  [Raminiara-zookeeper-1]
                Match zookeeper
                Ident [517b539b-0694-42d6-827e-016fb4474c68]
                Name  [Raminiara-control]
                Match control


        # -----------------------------------------------------
        # Get our controller address.
        #[root@openstacker]

            getvminfo "${controller:?}"
            controlip=$(geteleanor172)

        # -----------------------------------------------------
        # Configure our ssh proxy command.
        #[root@openstacker]

            sshproxy="ssh ${sshopts[*]} ${sshuser:?}@${controlip:?} nc %h %p"

        # -----------------------------------------------------
        # Test internal access to each of our Kafka nodes.
        #[root@openstacker]

echo "
---- ---- ---- ---- ----
Testing internal access to Kafka nodes.
"

            for vmident in ${kfidents[@]}
            do
                getvminfo "${vmident:?}"
                internalip=$(geteleanor192)

echo "
Node    [${vmident}]
Name    [$(getvmname)]
Address [${internalip}]
"
                echo "
                    hostname
                    " \
                    | ssh \
                        ${sshopts[*]} \
                        -o ProxyCommand="${sshproxy}" \
                        "${sshuser:?}@${internalip:?}"
            done

                Node    [bb409e47-cf2c-4e64-aea6-e893e5d05100]
                Name    [Raminiara-kafka-4]
                Address [192.168.1.5]

                raminiara-kafka-4.novalocal

                Node    [aa73a427-2e9f-413d-a37b-3eaf35799f00]
                Name    [Raminiara-kafka-3]
                Address [192.168.1.8]

                raminiara-kafka-3.novalocal

                Node    [6f971e48-f760-43bf-ad98-c38a7b90c321]
                Name    [Raminiara-kafka-2]
                Address [192.168.1.15]

                raminiara-kafka-2.novalocal

                Node    [0824e436-6213-4893-8a67-40d152e7402c]
                Name    [Raminiara-kafka-1]
                Address [192.168.1.10]

                raminiara-kafka-1.novalocal

        # -----------------------------------------------------
        # Test external access to each of our Kafka nodes.
        #[root@openstacker]

echo "
---- ---- ---- ---- ----
Testing external access to Kafka nodes.
"

            for vmident in ${kfidents[@]}
            do
                getvminfo "${vmident:?}"
                externalip=$(geteleanor172)

echo "
Node    [${vmident}]
Name    [$(getvmname)]
Address [${externalip}]
"
                echo "
                    hostname
                    " \
                    | ssh \
                        ${sshopts[*]} \
                        "${sshuser:?}@${externalip:?}"
            done

                Node    [bb409e47-cf2c-4e64-aea6-e893e5d05100]
                Name    [Raminiara-kafka-4]
                Address [172.16.49.217]

                raminiara-kafka-4.novalocal

                Node    [aa73a427-2e9f-413d-a37b-3eaf35799f00]
                Name    [Raminiara-kafka-3]
                Address [172.16.49.214]

                raminiara-kafka-3.novalocal

                Node    [6f971e48-f760-43bf-ad98-c38a7b90c321]
                Name    [Raminiara-kafka-2]
                Address [172.16.49.12]

                raminiara-kafka-2.novalocal

                Node    [0824e436-6213-4893-8a67-40d152e7402c]
                Name    [Raminiara-kafka-1]
                Address [172.16.49.208]

                raminiara-kafka-1.novalocal



        # -----------------------------------------------------
        # Check the logs on a Kafka node.
        #[root@openstacker]

            vmident=${kfidents[0]}
            getvminfo "${vmident:?}"
            internalip=$(geteleanor192)

            ssh \
                ${sshopts[*]} \
                -o ProxyCommand="${sshproxy}" \
                "${sshuser:?}@${internalip:?}"

                docker ps -a

                    CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES
                    27cc83641088        confluentinc/cp-kafka:4.1.1   "/etc/confluent/dock"   3 months ago        Up 3 months         0.0.0.0:9092->9092/tcp   stevedore_emily_1


                df -h

                    Filesystem      Size  Used Avail Use% Mounted on
                    devtmpfs        2.0G     0  2.0G   0% /dev
                    tmpfs           2.0G     0  2.0G   0% /dev/shm
                    tmpfs           2.0G  644K  2.0G   1% /run
                    tmpfs           2.0G     0  2.0G   0% /sys/fs/cgroup
                    /dev/vda3        39G  4.6G   33G  13% /
                    tmpfs           2.0G  4.0K  2.0G   1% /tmp
                    /dev/vda1       240M   83M  142M  37% /boot
                    /dev/vdb        512G  400G  112G  79% /var/local/outer/kafka/data-00
                    /dev/vdc        512G  400G  112G  79% /var/local/outer/kafka/data-01
                    tmpfs           395M     0  395M   0% /run/user/1000

                #
                # Dump the logs to a file.
                # TODO we need to clean or rotate the logs

                docker logs stevedore_emily_1 | tee "kafka-logs-$(hostname -s)-$(date +%Y%m%d%H%M).log"

                    [2018-06-27 00:28:07,494] DEBUG [Controller id=3] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:28:07,494] TRACE [Controller id=3] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:28:07,494] DEBUG [Controller id=3] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:28:07,494] TRACE [Controller id=3] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:28:07,494] DEBUG [Controller id=3] Topics not in preferred replica for broker 3 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:28:07,494] TRACE [Controller id=3] Leader imbalance ratio for broker 3 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:28:07,494] DEBUG [Controller id=3] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:28:07,494] TRACE [Controller id=3] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:32:36,975] INFO [GroupMetadataManager brokerId=3] Removed 0 expired offsets in 1 milliseconds. (kafka.coordinator.group.GroupMetadataManager)
                    [2018-06-27 00:33:07,495] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
                    [2018-06-27 00:33:07,496] DEBUG [Controller id=3] Preferred replicas by broker
                        Map(
                            2 -> Map(
                                ztf_20180626_programid1-4 -> Vector(2, 0, 1),
                                ztf_20180617_programid1-6 -> Vector(2, 0, 1),
                                ....
                                ....
                                ztf_20180615_programid1-0 -> Vector(2, 3, 0),
                                ztf_20180625_programid1-5 -> Vector(2, 0, 1)
                                ),
                            1 -> Map(
                                ztf_20180626_programid1-15 -> Vector(1, 2, 3),
                                ztf_20180623_programid1-7 -> Vector(1, 2, 3),
                                ....
                                ....
                                ztf_20180615_programid1-11 -> Vector(1, 0, 2),
                                ztf_20180618_programid1-8 -> Vector(1, 0, 2)
                                ),
                            3 -> Map(
                                ztf_20180616_programid1-10 -> Vector(3, 1, 2),
                                ztf_20180622_programid1-11 -> Vector(3, 2, 0),
                                ....
                                ....
                                ztf_20180623_programid1-13 -> Vector(3, 2, 0),
                                ztf_20180614_programid1-4 -> Vector(3, 1, 2)
                                ),
                            0 -> Map(
                                ztf_20180614_programid1-9 -> Vector(0, 3, 1),
                                ztf_20180622_programid1-0 -> Vector(0, 1, 2),
                                ....
                                ....
                                ztf_20180620_programid1-5 -> Vector(0, 1, 2),
                                ztf_20180623_programid1-2 -> Vector(0, 3, 1)
                                )
                            )
                        (kafka.controller.KafkaController)
                    [2018-06-27 00:33:07,496] DEBUG [Controller id=3] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:33:07,496] TRACE [Controller id=3] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:33:07,496] DEBUG [Controller id=3] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:33:07,496] TRACE [Controller id=3] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:33:07,497] DEBUG [Controller id=3] Topics not in preferred replica for broker 3 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:33:07,497] TRACE [Controller id=3] Leader imbalance ratio for broker 3 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:33:07,497] DEBUG [Controller id=3] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:33:07,497] TRACE [Controller id=3] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,497] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,499] DEBUG [Controller id=3] Preferred replicas by broker
                        Map(
                            2 -> Map(
                                ztf_20180626_programid1-4 -> Vector(2, 0, 1),
                                ztf_20180617_programid1-6 -> Vector(2, 0, 1),
                                ....
                                ....
                                ztf_20180615_programid1-0 -> Vector(2, 3, 0),
                                ztf_20180625_programid1-5 -> Vector(2, 0, 1)
                                ),
                            1 -> Map(
                                ztf_20180626_programid1-15 -> Vector(1, 2, 3),
                                ztf_20180623_programid1-7 -> Vector(1, 2, 3),
                                ....
                                ....
                                ztf_20180615_programid1-11 -> Vector(1, 0, 2),
                                ztf_20180618_programid1-8 -> Vector(1, 0, 2)
                                ),
                            3 -> Map(
                                ztf_20180616_programid1-10 -> Vector(3, 1, 2),
                                ztf_20180622_programid1-11 -> Vector(3, 2, 0),
                                ....
                                ....
                                ztf_20180623_programid1-13 -> Vector(3, 2, 0),
                                ztf_20180614_programid1-4 -> Vector(3, 1, 2)
                                ),
                            0 -> Map(
                                ztf_20180614_programid1-9 -> Vector(0, 3, 1),
                                ztf_20180622_programid1-0 -> Vector(0, 1, 2),
                                ....
                                ....
                                ztf_20180620_programid1-5 -> Vector(0, 1, 2),
                                ztf_20180623_programid1-2 -> Vector(0, 3, 1)
                                )
                            )
                        (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,499] DEBUG [Controller id=3] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,499] TRACE [Controller id=3] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,499] DEBUG [Controller id=3] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,499] TRACE [Controller id=3] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,499] DEBUG [Controller id=3] Topics not in preferred replica for broker 3 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,499] TRACE [Controller id=3] Leader imbalance ratio for broker 3 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,499] DEBUG [Controller id=3] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:38:07,499] TRACE [Controller id=3] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:42:36,975] INFO [GroupMetadataManager brokerId=3] Removed 0 expired offsets in 1 milliseconds. (kafka.coordinator.group.GroupMetadataManager)
                    [2018-06-27 00:43:07,500] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
                    [2018-06-27 00:43:07,502] DEBUG [Controller id=3] Preferred replicas by broker
                        Map(
                            2 -> Map(
                                ztf_20180626_programid1-4 -> Vector(2, 0, 1),
                                ztf_20180617_programid1-6 -> Vector(2, 0, 1),
                                ....
                                ....
                                ztf_20180615_programid1-0 -> Vector(2, 3, 0),
                                ztf_20180625_programid1-5 -> Vector(2, 0, 1)
                                ),
                            1 -> Map(
                                ztf_20180626_programid1-15 -> Vector(1, 2, 3),
                                ztf_20180623_programid1-7 -> Vector(1, 2, 3),
                                ....
                                ....
                                ztf_20180615_programid1-11 -> Vector(1, 0, 2),
                                ztf_20180618_programid1-8 -> Vector(1, 0, 2)
                                ),
                            3 -> Map(
                                ztf_20180616_programid1-10 -> Vector(3, 1, 2),
                                ztf_20180622_programid1-11 -> Vector(3, 2, 0),
                                ....
                                ....
                                ztf_20180623_programid1-13 -> Vector(3, 2, 0),
                                ztf_20180614_programid1-4 -> Vector(3, 1, 2)
                                ),
                            0 -> Map(
                                ztf_20180614_programid1-9 -> Vector(0, 3, 1),
                                ztf_20180622_programid1-0 -> Vector(0, 1, 2),
                                ....
                                ....
                                ztf_20180620_programid1-5 -> Vector(0, 1, 2),
                                ztf_20180623_programid1-2 -> Vector(0, 3, 1)
                                )
                            )
                        (kafka.controller.KafkaController)
                    [2018-06-27 00:43:07,503] DEBUG [Controller id=3] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:43:07,504] TRACE [Controller id=3] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:43:07,504] DEBUG [Controller id=3] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:43:07,504] TRACE [Controller id=3] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:43:07,504] DEBUG [Controller id=3] Topics not in preferred replica for broker 3 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:43:07,504] TRACE [Controller id=3] Leader imbalance ratio for broker 3 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:43:07,504] DEBUG [Controller id=3] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:43:07,504] TRACE [Controller id=3] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,505] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,507] DEBUG [Controller id=3] Preferred replicas by broker
                        Map(
                            2 -> Map(
                                ztf_20180626_programid1-4 -> Vector(2, 0, 1),
                                ztf_20180617_programid1-6 -> Vector(2, 0, 1),
                                ....
                                ....
                                ztf_20180615_programid1-0 -> Vector(2, 3, 0),
                                ztf_20180625_programid1-5 -> Vector(2, 0, 1)
                                ),
                            1 -> Map(
                                ztf_20180626_programid1-15 -> Vector(1, 2, 3),
                                ztf_20180623_programid1-7 -> Vector(1, 2, 3),
                                ....
                                ....
                                ztf_20180615_programid1-11 -> Vector(1, 0, 2),
                                ztf_20180618_programid1-8 -> Vector(1, 0, 2)
                                ),
                            3 -> Map(
                                ztf_20180616_programid1-10 -> Vector(3, 1, 2),
                                ztf_20180622_programid1-11 -> Vector(3, 2, 0),
                                ....
                                ....
                                ztf_20180623_programid1-13 -> Vector(3, 2, 0),
                                ztf_20180614_programid1-4 -> Vector(3, 1, 2)
                                ),
                            0 -> Map(
                                ztf_20180614_programid1-9 -> Vector(0, 3, 1),
                                ztf_20180622_programid1-0 -> Vector(0, 1, 2),
                                ....
                                ....
                                ztf_20180620_programid1-5 -> Vector(0, 1, 2),
                                ztf_20180623_programid1-2 -> Vector(0, 3, 1)
                                )
                            )
                        (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,507] DEBUG [Controller id=3] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,507] TRACE [Controller id=3] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,507] DEBUG [Controller id=3] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,507] TRACE [Controller id=3] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,507] DEBUG [Controller id=3] Topics not in preferred replica for broker 3 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,507] TRACE [Controller id=3] Leader imbalance ratio for broker 3 is 0.0 (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,508] DEBUG [Controller id=3] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
                    [2018-06-27 00:48:07,508] TRACE [Controller id=3] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)

                #
                # Initial glance, the logs look healthy.
                # BUT ... the dates are a little old
                #

                    [2018-06-27 00:48:07,508] ....

                #
                # Tail end of the logs look a lot less healthy.
                #

                    [2018-10-12 11:45:54,196] TRACE [Controller id=3] Leader imbalance ratio for broker 0 is 0.6299559471365639 (kafka.controller.KafkaController)
                    [2018-10-12 11:45:54,229] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:54,232] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:54,233] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:55,752] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:55,753] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:55,754] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:56,898] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:56,899] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:56,901] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:58,669] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:58,670] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:58,671] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:59,884] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:59,884] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:45:59,885] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:01,353] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:01,354] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:01,356] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:03,036] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:03,037] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:03,038] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:04,566] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:04,567] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:04,568] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:05,940] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:05,941] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:05,942] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:07,210] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:07,211] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:07,212] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:08,669] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:08,670] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:08,671] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:10,047] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:10,049] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:10,049] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:11,466] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:11,467] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:11,468] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:13,293] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:13,294] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:13,295] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:15,315] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:15,317] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:15,318] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:17,143] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:17,144] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:17,145] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:18,756] INFO Opening socket connection to server 192.168.1.11/192.168.1.11:2181. Will not attempt to authenticate using SASL (unknown error) (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:18,757] INFO Socket connection established to 192.168.1.11/192.168.1.11:2181, initiating session (org.apache.zookeeper.ClientCnxn)
                    [2018-10-12 11:46:18,758] INFO Unable to read additional data from server sessionid 0x164ecadc04c0014, likely server has closed socket, closing socket connection and attempting reconnect (org.apache.zookeeper.ClientCnxn)


                #
                # Check the log file status.

                stat kafka-logs-raminiara-kafka-4-201810121305.log

                      File: kafka-logs-raminiara-kafka-4-201810121305.log
                      Size: 599119857 	Blocks: 1170160    IO Block: 4096   regular file
                    Device: 29h/41d	Inode: 67986       Links: 1
                    Access: (0664/-rw-rw-r--)  Uid: ( 1000/Stevedore)   Gid: ( 1000/Stevedore)
                    Context: unconfined_u:object_r:user_home_t:s0
                    Access: 2018-10-12 13:26:39.520154092 +0100
                    Modify: 2018-10-12 13:25:05.670063797 +0100
                    Change: 2018-10-12 13:25:05.670063797 +0100

                #
                # What happens if we stop/start the Kafka container ?
                #

                #
                # Original start command ...
                #
                #  docker-compose \
                #      --file kafka.yml \
                #      up -d
                #

                #
                # The node that is down is Zookeper not Kafka.
                # Check the Zookeper nodes in another shell ...


                #
                # Follow the Kafka log ..
                docker logs --follow --tail 100 stevedore_emily_1



# -----------------------------------------------------
# Run another shell ....
#[user@desktop]

    ssh Etalema

    # -----------------------------------------------------
    # Login to the exsiting container.
    #[user@virtual]

        dcident=$(
            docker ps --latest --format '{{.ID}}'
            )

        docker exec\
            --tty \
            --interactive \
            "${dcident:?}" \
            bash

        # -----------------------------------------------------
        # Load our OpenStack settings.
        #[root@openstacker]

            source '/etc/phymatopus/openstack.settings'

        # -----------------------------------------------------
        # Load our OpenStack and Eleanor functions.
        #[root@openstacker]

            source 'openstack-utils.sh'
            source 'eleanor-utils.sh'
            source 'eleanor-init.sh'

        # -----------------------------------------------------
        # Load our cluster and ZTF settings.
        #[root@openstacker]

            source '/etc/phymatopus/cluster.settings'
            source '/etc/phymatopus/ztf.settings'

        # -----------------------------------------------------
        # Configure our ssh proxy command.
        #[root@openstacker]

            sshproxy="ssh ${sshopts[*]} ${sshuser:?}@${controlip:?} nc %h %p"

         # -----------------------------------------------------
         # Check the running containers on the Zookeeper nodes.
         #[root@openstacker]

             for address in $(cat /etc/phymatopus/zkidents.txt)
                 do
                     echo "
                         echo "---- [${address:?}] ----"
                         docker ps -a
                         echo ""
                         " \
                     | ssh \
                         ${sshopts[*]} \
                         -o ProxyCommand="${sshproxy:?}" \
                         ${sshuser:?}@${address:?}
                 done

                ---- [192.168.1.14] ----
                CONTAINER ID        IMAGE                             COMMAND                  CREATED             STATUS                     PORTS               NAMES
                ab1651c5c40e        confluentinc/cp-zookeeper:4.1.1   "/etc/confluent/dock"   3 months ago        Exited (139) 5 hours ago                       stevedore_courtney_1

                ---- [192.168.1.16] ----
                CONTAINER ID        IMAGE                             COMMAND                  CREATED             STATUS                    PORTS               NAMES
                9983f3ed0cb1        confluentinc/cp-zookeeper:4.1.1   "/etc/confluent/dock"   3 months ago        Exited (139) 2 days ago                       stevedore_courtney_1

                ---- [192.168.1.11] ----
                CONTAINER ID        IMAGE                             COMMAND                  CREATED             STATUS              PORTS                                                                    NAMES
                19d01a788dae        confluentinc/cp-zookeeper:4.1.1   "/etc/confluent/dock"   3 months ago        Up 3 months         0.0.0.0:2181->2181/tcp, 0.0.0.0:2888->2888/tcp, 0.0.0.0:3888->3888/tcp   stevedore_courtney_1


        #
        # Two down and the third is unhealthy ..
        #

        #
        # Debug the first Zookeeper node ...

            internalip=$(head -n 1 /etc/phymatopus/zkidents.txt)

            ssh \
                ${sshopts[*]} \
                -o ProxyCommand="${sshproxy}" \
                "${sshuser:?}@${internalip:?}"

                docker ps -a

                    CONTAINER ID        IMAGE                             COMMAND                  CREATED             STATUS                     PORTS               NAMES
                    ab1651c5c40e        confluentinc/cp-zookeeper:4.1.1   "/etc/confluent/dock"   3 months ago        Exited (139) 5 hours ago                       stevedore_courtney_1

                df -h .

                    Filesystem      Size  Used Avail Use% Mounted on
                    /dev/vda3        19G   18G   40K 100% /

                exit

        #
        # Check disc space on the Zookeeper nodes ...

             for address in $(cat /etc/phymatopus/zkidents.txt)
                 do
                     echo "
                         echo "---- [${address:?}] ----"
                         df -h .
                         echo ""
                         " \
                     | ssh \
                         ${sshopts[*]} \
                         -o ProxyCommand="${sshproxy:?}" \
                         ${sshuser:?}@${address:?}
                 done

                ---- [192.168.1.14] ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vda3        19G   18G   36K 100% /

                ---- [192.168.1.16] ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vda3        19G   18G     0 100% /

                ---- [192.168.1.11] ----
                Filesystem      Size  Used Avail Use% Mounted on
                /dev/vda3        19G  6.9G   11G  40% /

        #
        # Back to the first Zookeeper node ...

            internalip=$(head -n 1 /etc/phymatopus/zkidents.txt)

            ssh \
                ${sshopts[*]} \
                -o ProxyCommand="${sshproxy}" \
                "${sshuser:?}@${internalip:?}"

                #
                # Check the disc useage ..

                df -h /

                    Filesystem      Size  Used Avail Use% Mounted on
                    /dev/vda3        19G   18G   32K 100% /

                du -h -d1 /

                    81M     /boot
                    0       /dev
                    du: cannot access '/proc/6675/task/6675/fd/4': No such file or directory
                    du: cannot access '/proc/6675/task/6675/fdinfo/4': No such file or directory
                    du: cannot access '/proc/6675/fd/3': No such file or directory
                    du: cannot access '/proc/6675/fdinfo/3': No such file or directory
                    0       /proc
                    8.6M    /run
                    0       /sys
                    18M     /etc
                    40K     /root
                    17G     /var
                    1.1G    /usr
                    24K     /home
                    0       /media
                    0       /mnt
                    0       /opt
                    0       /srv
                    0       /tmp
                    18G     /

                du -h -d1 /var

                    17G     /var/lib
                    216M    /var/log
                    0       /var/adm
                    191M    /var/cache
                    0       /var/db
                    0       /var/empty
                    0       /var/ftp
                    0       /var/games
                    0       /var/gopher
                    0       /var/local
                    0       /var/nis
                    0       /var/opt
                    0       /var/preserve
                    12K     /var/spool
                    0       /var/tmp
                    0       /var/yp
                    0       /var/kerberos
                    17G     /var

                du -h -d1 /var/lib

                    2.2M    /var/lib/dnf
                    25M     /var/lib/rpm
                    0       /var/lib/games
                    0       /var/lib/misc
                    0       /var/lib/rpm-state
                    8.0K    /var/lib/alternatives
                    18M     /var/lib/selinux
                    140K    /var/lib/systemd
                    4.0K    /var/lib/dbus
                    0       /var/lib/initramfs
                    0       /var/lib/os-prober
                    0       /var/lib/polkit-1
                    0       /var/lib/stateless
                    4.0K    /var/lib/plymouth
                    30M     /var/lib/sss
                    0       /var/lib/dhclient
                    168K    /var/lib/cloud
                    0       /var/lib/authconfig
                    24K     /var/lib/NetworkManager
                    0       /var/lib/ntp
                    4.0K    /var/lib/chrony
                    0       /var/lib/tpm
                    17G     /var/lib/docker
                    17G     /var/lib

                du -h -d1 /var/lib/docker

                    80K     /var/lib/docker/containerd
                    0       /var/lib/docker/tmp
                    11G     /var/lib/docker/containers
                    0       /var/lib/docker/runtimes
                    0       /var/lib/docker/plugins
                    3.4G    /var/lib/docker/btrfs
                    1.2M    /var/lib/docker/image
                    2.5G    /var/lib/docker/volumes
                    0       /var/lib/docker/trust
                    44K     /var/lib/docker/network
                    0       /var/lib/docker/swarm
                    16K     /var/lib/docker/builder
                    17G     /var/lib/docker

                du -h -d1 /var/lib/docker/containers

                    11G     /var/lib/docker/containers/ab1651c5c40e4f3801947d5099a9617b0580f4d35ab33e0d902ca2becd9688c9
                    11G     /var/lib/docker/containers


                #
                # Try looking inside the container ....

                docker ps --all

                    CONTAINER ID        IMAGE                             COMMAND                  CREATED             STATUS                     PORTS               NAMES
                    ab1651c5c40e        confluentinc/cp-zookeeper:4.1.1   "/etc/confluent/dock"   3 months ago        Exited (139) 6 hours ago                       stevedore_courtney_1

                docker exec\
                    --tty \
                    --interactive \
                    "$(docker ps --all --latest --format '{{.ID}}')" \
                    bash

                Error response from daemon: Container ab1651c5c40e4f3801947d5099a9617b0580f4d35ab33e0d902ca2becd9688c9 is not running

                #
                # See what we can do from outside ....

                sudo -s
                pushd /var/lib/docker/containers/ab1651c5c40e4f3801947d5099a9617b0580f4d35ab33e0d902ca2becd9688c9

                    ls -alh .

                        total 11G
                        drwx------. 1 root root  312 Oct 12 09:10 .
                        drwx------. 1 root root  128 Jun 15 17:04 ..
                        -rw-r-----. 1 root root  11G Oct 12 09:10 ab1651c5c40e4f3801947d5099a9617b0580f4d35ab33e0d902ca2becd9688c9-json.log
                        drwx------. 1 root root    0 Jun 15 17:04 checkpoints
                        -rw-------. 1 root root 4.6K Oct 12 09:10 config.v2.json
                        -rw-r--r--. 1 root root 1.4K Oct 12 09:10 hostconfig.json
                        -rw-r--r--. 1 root root   13 Jun 15 17:04 hostname
                        -rw-r--r--. 1 root root  150 Oct 12 09:10 hosts
                        -rw-r--r--. 1 root root   92 Jun 15 17:04 resolv.conf
                        -rw-r--r--. 1 root root   71 Jun 15 17:04 resolv.conf.hash
                        drwx------. 1 root root    0 Jun 15 17:04 shm

                #
                # One big log file ....

                mv ab1651c5c40e4f3801947d5099a9617b0580f4d35ab33e0d902ca2becd9688c9-json.log container-json.log

                head container-json.log

                    {"log":"\n","stream":"stderr","time":"2018-06-15T16:04:14.304579014Z"}
                    {"log":"echo \"===\u003e ENV Variables ...\"\n","stream":"stderr","time":"2018-06-15T16:04:14.305022213Z"}
                    {"log":"+ echo '===\u003e ENV Variables ...'\n","stream":"stderr","time":"2018-06-15T16:04:14.30506885Z"}
                    {"log":"env | sort\n","stream":"stderr","time":"2018-06-15T16:04:14.305079129Z"}
                    {"log":"===\u003e ENV Variables ...\n","stream":"stdout","time":"2018-06-15T16:04:14.305098027Z"}
                    {"log":"+ sort\n","stream":"stderr","time":"2018-06-15T16:04:14.30605843Z"}
                    {"log":"+ env\n","stream":"stderr","time":"2018-06-15T16:04:14.306778649Z"}
                    {"log":"ALLOW_UNSIGNED=false\n","stream":"stdout","time":"2018-06-15T16:04:14.313471855Z"}
                    {"log":"COMPONENT=zookeeper\n","stream":"stdout","time":"2018-06-15T16:04:14.313511121Z"}
                    {"log":"CONFLUENT_DEB_VERSION=1\n","stream":"stdout","time":"2018-06-15T16:04:14.313520524Z"}

                tail container-json.log

                    {"log":"# An error report file with more information is saved as:\n","stream":"stdout","time":"2018-10-12T08:09:23.28326912Z"}
                    {"log":"# //hs_err_pid1.log\n","stream":"stdout","time":"2018-10-12T08:09:23.283474464Z"}
                    {"log":"[2018-10-12 08:09:23,972] INFO shutting down (org.apache.zookeeper.server.ZooKeeperServer)\n","stream":"stdout","time":"2018-10-12T08:09:23.972737489Z"}
                    {"log":"[2018-10-12 08:09:23,972] INFO Shutting down (org.apache.zookeeper.server.SessionTrackerImpl)\n","stream":"stdout","time":"2018-10-12T08:09:24.1401268Z"}
                    {"log":"[2018-10-12 08:09:23,973] INFO Shutting down (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:24.140167256Z"}
                    {"log":"[2018-10-12 08:09:23,973] INFO Shutting down (org.apache.zookeeper.server.quorum.ProposalRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:24.140198366Z"}
                    {"log":"[2018-10-12 08:09:23,973] INFO Shutting down (org.apache.zookeeper.server.quorum.CommitProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:24.140206686Z"}
                    {"log":"[2018-10-12 08:09:24,000] INFO SessionTrackerImpl exited loop! (org.apache.zookeeper.server.SessionTrackerImpl)\n","stream":"stdout","time":"2018-10-12T08:09:24.140214229Z"}
                    {"log":"[thread 140368538486528 also had an error]\n","stream":"stdout","time":"2018-10-12T08:09:24.170850152Z"}
                    {"log":"[thread 140368869295872 also had an error]\n","stream":"stdout","time":"2018-10-12T08:09:24.490417863Z"}
                    [root@raminiara-zookeeper-3 ab1651c5c40e4f3801947d5099a9617b0580f4d35ab33e0d902ca2becd9688c9]#

                tail -n 100 container-json.log

                    {"log":"[2018-10-12 08:09:20,369] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74d5 zxid:0x7004240c6 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180711_programid1/partitions/0/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180711_programid1/partitions/0/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.369277085Z"}
                    {"log":"[2018-10-12 08:09:20,369] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a7333c zxid:0x7004240c7 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180913_programid1/partitions/8/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180913_programid1/partitions/8/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.369554747Z"}
                    {"log":"[2018-10-12 08:09:20,389] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74d7 zxid:0x7004240c8 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180814_programid1/partitions/10/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180814_programid1/partitions/10/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.389718289Z"}
                    {"log":"[2018-10-12 08:09:20,389] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a7333e zxid:0x7004240c9 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180823_programid1/partitions/4/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180823_programid1/partitions/4/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.390030788Z"}
                    {"log":"[2018-10-12 08:09:20,390] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06972 zxid:0x7004240ca txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180620_programid1/partitions/0/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180620_programid1/partitions/0/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.390292405Z"}
                    {"log":"[2018-10-12 08:09:20,406] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74d9 zxid:0x7004240cb txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180727_programid1/partitions/4/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180727_programid1/partitions/4/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.406449077Z"}
                    {"log":"[2018-10-12 08:09:20,406] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73340 zxid:0x7004240cc txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180803_programid1/partitions/4/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180803_programid1/partitions/4/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.406911268Z"}
                    {"log":"[2018-10-12 08:09:20,407] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06974 zxid:0x7004240cd txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180714_programid1/partitions/0/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180714_programid1/partitions/0/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.407694129Z"}
                    {"log":"[2018-10-12 08:09:20,422] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73342 zxid:0x7004240ce txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180815_programid1/partitions/11/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180815_programid1/partitions/11/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.423107261Z"}
                    {"log":"[2018-10-12 08:09:20,450] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74db zxid:0x7004240cf txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180708_programid1/partitions/10/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180708_programid1/partitions/10/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.45077899Z"}
                    {"log":"[2018-10-12 08:09:20,451] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06976 zxid:0x7004240d0 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180724_programid1/partitions/1/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180724_programid1/partitions/1/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.451091939Z"}
                    {"log":"[2018-10-12 08:09:20,461] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74dd zxid:0x7004240d1 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180918_programid1/partitions/11/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180918_programid1/partitions/11/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.461837344Z"}
                    {"log":"[2018-10-12 08:09:20,462] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73344 zxid:0x7004240d2 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180720_programid1/partitions/10/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180720_programid1/partitions/10/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.462117567Z"}
                    {"log":"[2018-10-12 08:09:20,462] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06978 zxid:0x7004240d3 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180817_programid1/partitions/11/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180817_programid1/partitions/11/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.462482734Z"}
                    {"log":"[2018-10-12 08:09:20,476] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74df zxid:0x7004240d4 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180817_programid1/partitions/15/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180817_programid1/partitions/15/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.476339901Z"}
                    {"log":"[2018-10-12 08:09:20,477] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73346 zxid:0x7004240d5 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180627_programid1/partitions/10/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180627_programid1/partitions/10/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.477419356Z"}
                    {"log":"[2018-10-12 08:09:20,477] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b0697a zxid:0x7004240d6 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180827_programid1/partitions/11/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180827_programid1/partitions/11/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.477642996Z"}
                    {"log":"[2018-10-12 08:09:20,493] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74e1 zxid:0x7004240d7 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180927_programid1/partitions/13/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180927_programid1/partitions/13/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.493985326Z"}
                    {"log":"[2018-10-12 08:09:20,495] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73348 zxid:0x7004240d8 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180622_programid1/partitions/13/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180622_programid1/partitions/13/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.495162856Z"}
                    {"log":"[2018-10-12 08:09:20,532] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b0697c zxid:0x7004240d9 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180717_programid1/partitions/7/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180717_programid1/partitions/7/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.532794758Z"}
                    {"log":"[2018-10-12 08:09:20,546] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74e3 zxid:0x7004240da txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180717_programid1/partitions/11/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180717_programid1/partitions/11/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.547129977Z"}
                    {"log":"[2018-10-12 08:09:20,548] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b0697e zxid:0x7004240db txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180910_programid1/partitions/11/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180910_programid1/partitions/11/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.548130236Z"}
                    {"log":"[2018-10-12 08:09:20,548] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a7334a zxid:0x7004240dc txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180808_programid1/partitions/4/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180808_programid1/partitions/4/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.548403573Z"}
                    {"log":"[2018-10-12 08:09:20,578] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74e5 zxid:0x7004240dd txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180910_programid1/partitions/15/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180910_programid1/partitions/15/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.578319647Z"}
                    {"log":"[2018-10-12 08:09:20,579] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a7334c zxid:0x7004240de txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180615_programid1/partitions/5/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180615_programid1/partitions/5/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.579528832Z"}
                    {"log":"[2018-10-12 08:09:20,588] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06980 zxid:0x7004240df txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180820_programid1/partitions/7/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180820_programid1/partitions/7/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.588234646Z"}
                    {"log":"[2018-10-12 08:09:20,610] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74e7 zxid:0x7004240e0 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180727_programid1/partitions/3/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180727_programid1/partitions/3/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.610607735Z"}
                    {"log":"[2018-10-12 08:09:20,632] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a7334e zxid:0x7004240e1 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180713_programid1/partitions/1/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180713_programid1/partitions/1/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.632300422Z"}
                    {"log":"[2018-10-12 08:09:20,632] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06982 zxid:0x7004240e2 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180818_programid1/partitions/12/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180818_programid1/partitions/12/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.632662982Z"}
                    {"log":"[2018-10-12 08:09:20,632] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74e9 zxid:0x7004240e3 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180811_programid1/partitions/3/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180811_programid1/partitions/3/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.632842581Z"}
                    {"log":"[2018-10-12 08:09:20,664] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74eb zxid:0x7004240e4 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180701_programid1/partitions/7/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180701_programid1/partitions/7/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.665036838Z"}
                    {"log":"[2018-10-12 08:09:20,665] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06984 zxid:0x7004240e5 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180901_programid1/partitions/11/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180901_programid1/partitions/11/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.665388515Z"}
                    {"log":"[2018-10-12 08:09:20,665] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73350 zxid:0x7004240e6 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180918_programid1/partitions/6/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180918_programid1/partitions/6/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.665972138Z"}
                    {"log":"[2018-10-12 08:09:20,685] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74ed zxid:0x7004240e7 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/__consumer_offsets/partitions/13/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/__consumer_offsets/partitions/13/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.686091898Z"}
                    {"log":"[2018-10-12 08:09:20,724] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06986 zxid:0x7004240e8 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20181008_programid1/partitions/10/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20181008_programid1/partitions/10/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.725123994Z"}
                    {"log":"[2018-10-12 08:09:20,725] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73352 zxid:0x7004240e9 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180810_programid1/partitions/15/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180810_programid1/partitions/15/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.72546773Z"}
                    {"log":"[2018-10-12 08:09:20,748] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74ef zxid:0x7004240ea txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180905_programid1/partitions/13/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180905_programid1/partitions/13/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.748325593Z"}
                    {"log":"[2018-10-12 08:09:20,748] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06988 zxid:0x7004240eb txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/__consumer_offsets/partitions/39/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/__consumer_offsets/partitions/39/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.748879773Z"}
                    {"log":"[2018-10-12 08:09:20,755] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73354 zxid:0x7004240ec txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180916_programid1/partitions/0/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180916_programid1/partitions/0/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.756174863Z"}
                    {"log":"[2018-10-12 08:09:20,771] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74f1 zxid:0x7004240ed txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180625_programid1/partitions/7/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180625_programid1/partitions/7/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.77182999Z"}
                    {"log":"[2018-10-12 08:09:20,813] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b0698a zxid:0x7004240ee txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180903_programid1/partitions/2/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180903_programid1/partitions/2/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.813480292Z"}
                    {"log":"[2018-10-12 08:09:20,814] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73356 zxid:0x7004240ef txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180906_programid1/partitions/0/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180906_programid1/partitions/0/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.815086234Z"}
                    {"log":"[2018-10-12 08:09:20,833] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74f3 zxid:0x7004240f0 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180623_programid1/partitions/2/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180623_programid1/partitions/2/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.833492032Z"}
                    {"log":"[2018-10-12 08:09:20,834] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b0698c zxid:0x7004240f1 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180717_programid1/partitions/10/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180717_programid1/partitions/10/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.834158955Z"}
                    {"log":"[2018-10-12 08:09:20,835] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73358 zxid:0x7004240f2 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180830_programid1/partitions/15/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180830_programid1/partitions/15/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.835451883Z"}
                    {"log":"[2018-10-12 08:09:20,872] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74f5 zxid:0x7004240f3 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180723_programid1/partitions/3/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180723_programid1/partitions/3/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.872266466Z"}
                    {"log":"[2018-10-12 08:09:20,872] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b0698e zxid:0x7004240f4 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180727_programid1/partitions/2/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180727_programid1/partitions/2/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.872879678Z"}
                    {"log":"[2018-10-12 08:09:20,882] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a7335a zxid:0x7004240f5 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180913_programid1/partitions/10/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180913_programid1/partitions/10/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.882725506Z"}
                    {"log":"[2018-10-12 08:09:20,928] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74f7 zxid:0x7004240f6 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180923_programid1/partitions/7/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180923_programid1/partitions/7/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.928570288Z"}
                    {"log":"[2018-10-12 08:09:20,949] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06990 zxid:0x7004240f7 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180914_programid1/partitions/14/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180914_programid1/partitions/14/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.94994042Z"}
                    {"log":"[2018-10-12 08:09:20,986] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a7335c zxid:0x7004240f8 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180823_programid1/partitions/6/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180823_programid1/partitions/6/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:20.986594405Z"}
                    {"log":"[2018-10-12 08:09:21,008] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74f9 zxid:0x7004240f9 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180703_programid1/partitions/3/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180703_programid1/partitions/3/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:21.008479896Z"}
                    {"log":"[2018-10-12 08:09:21,056] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06992 zxid:0x7004240fa txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180704_programid1/partitions/10/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180704_programid1/partitions/10/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:21.05707206Z"}
                    {"log":"[2018-10-12 08:09:21,104] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a7335e zxid:0x7004240fb txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180815_programid1/partitions/13/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180815_programid1/partitions/13/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:21.104724981Z"}
                    {"log":"[2018-10-12 08:09:21,105] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74fb zxid:0x7004240fc txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180715_programid1/partitions/8/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180715_programid1/partitions/8/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:21.105167251Z"}
                    {"log":"[2018-10-12 08:09:21,153] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1bd74fd zxid:0x7004240fd txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20181008_programid1/partitions/15/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20181008_programid1/partitions/15/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:21.153455882Z"}
                    {"log":"[2018-10-12 08:09:21,187] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b06994 zxid:0x7004240fe txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20181008_programid1/partitions/11/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20181008_programid1/partitions/11/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:21.188190731Z"}
                    {"log":"[2018-10-12 08:09:21,238] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a73360 zxid:0x7004240ff txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180630_programid1/partitions/7/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180630_programid1/partitions/7/state (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:21.239246376Z"}
                    {"log":"[2018-10-12 08:09:22,719] ERROR Severe unrecoverable error, from thread : SyncThread:3 (org.apache.zookeeper.server.ZooKeeperCriticalThread)\n","stream":"stdout","time":"2018-10-12T08:09:22.756511342Z"}
                    {"log":"java.io.IOException: No space left on device\n","stream":"stdout","time":"2018-10-12T08:09:22.796318086Z"}
                    {"log":"\u0009at java.io.FileOutputStream.writeBytes(Native Method)\n","stream":"stdout","time":"2018-10-12T08:09:23.020796011Z"}
                    {"log":"\u0009at java.io.FileOutputStream.write(FileOutputStream.java:326)\n","stream":"stdout","time":"2018-10-12T08:09:23.086855119Z"}
                    {"log":"\u0009at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)\n","stream":"stdout","time":"2018-10-12T08:09:23.086871918Z"}
                    {"log":"\u0009at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:140)\n","stream":"stdout","time":"2018-10-12T08:09:23.086880797Z"}
                    {"log":"\u0009at org.apache.zookeeper.server.persistence.FileTxnLog.commit(FileTxnLog.java:326)\n","stream":"stdout","time":"2018-10-12T08:09:23.086908261Z"}
                    {"log":"\u0009at org.apache.zookeeper.server.persistence.FileTxnSnapLog.commit(FileTxnSnapLog.java:332)\n","stream":"stdout","time":"2018-10-12T08:09:23.086918078Z"}
                    {"log":"\u0009at org.apache.zookeeper.server.ZKDatabase.commit(ZKDatabase.java:485)\n","stream":"stdout","time":"2018-10-12T08:09:23.086926211Z"}
                    {"log":"\u0009at org.apache.zookeeper.server.SyncRequestProcessor.flush(SyncRequestProcessor.java:195)\n","stream":"stdout","time":"2018-10-12T08:09:23.086933803Z"}
                    {"log":"\u0009at org.apache.zookeeper.server.SyncRequestProcessor.run(SyncRequestProcessor.java:131)\n","stream":"stdout","time":"2018-10-12T08:09:23.086941629Z"}
                    {"log":"[2018-10-12 08:09:22,764] INFO Thread SyncThread:3 exits, error code 1 (org.apache.zookeeper.server.ZooKeeperServerListenerImpl)\n","stream":"stdout","time":"2018-10-12T08:09:23.086957546Z"}
                    {"log":"[2018-10-12 08:09:22,790] INFO SyncRequestProcessor exited! (org.apache.zookeeper.server.SyncRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:23.086969044Z"}
                    {"log":"#\n","stream":"stdout","time":"2018-10-12T08:09:23.086977459Z"}
                    {"log":"# A fatal error has been detected by the Java Runtime Environment:\n","stream":"stdout","time":"2018-10-12T08:09:23.086985243Z"}
                    {"log":"#\n","stream":"stdout","time":"2018-10-12T08:09:23.086993019Z"}
                    {"log":"#  SIGBUS (0x7) at pc=0x00007faa53af44be, pid=1, tid=0x00007faa2d07d700\n","stream":"stdout","time":"2018-10-12T08:09:23.087000929Z"}
                    {"log":"#\n","stream":"stdout","time":"2018-10-12T08:09:23.087009548Z"}
                    {"log":"# JRE version: OpenJDK Runtime Environment (8.0_172-b01) (build 1.8.0_172-b01)\n","stream":"stdout","time":"2018-10-12T08:09:23.087016729Z"}
                    {"log":"# Java VM: OpenJDK 64-Bit Server VM (25.172-b01 mixed mode linux-amd64 compressed oops)\n","stream":"stdout","time":"2018-10-12T08:09:23.087072802Z"}
                    {"log":"# Problematic frame:\n","stream":"stdout","time":"2018-10-12T08:09:23.087084365Z"}
                    {"log":"# V  [libjvm.so+0x8e94be][2018-10-12 08:09:23,190] INFO Shutting down (org.apache.zookeeper.server.quorum.Leader)\n","stream":"stdout","time":"2018-10-12T08:09:23.191006071Z"}
                    {"log":"[2018-10-12 08:09:23,191] INFO Shutdown called (org.apache.zookeeper.server.quorum.Leader)\n","stream":"stdout","time":"2018-10-12T08:09:23.191499714Z"}
                    {"log":"java.lang.Exception: shutdown Leader! reason: Unexpected internal error\n","stream":"stdout","time":"2018-10-12T08:09:23.191520615Z"}
                    {"log":"\u0009at org.apache.zookeeper.server.quorum.Leader.shutdown(Leader.java:517)\n","stream":"stdout","time":"2018-10-12T08:09:23.191528015Z"}
                    {"log":"\u0009at org.apache.zookeeper.server.quorum.Leader.lead(Leader.java:485)\n","stream":"stdout","time":"2018-10-12T08:09:23.191534905Z"}
                    {"log":"\u0009at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:950)\n","stream":"stdout","time":"2018-10-12T08:09:23.19155158Z"}
                    {"log":"  PerfLongVariant::sample()+0x1e\n","stream":"stdout","time":"2018-10-12T08:09:23.215000905Z"}
                    {"log":"#\n","stream":"stdout","time":"2018-10-12T08:09:23.215128761Z"}
                    {"log":"# Core dump written. Default location: //core or core.1\n","stream":"stdout","time":"2018-10-12T08:09:23.215298638Z"}
                    {"log":"#\n","stream":"stdout","time":"2018-10-12T08:09:23.215384627Z"}
                    {"log":"[2018-10-12 08:09:23,220] INFO exception while shutting down acceptor: java.net.SocketException: Socket closed (org.apache.zookeeper.server.quorum.Leader)\n","stream":"stdout","time":"2018-10-12T08:09:23.220180172Z"}
                    {"log":"# An error report file with more information is saved as:\n","stream":"stdout","time":"2018-10-12T08:09:23.28326912Z"}
                    {"log":"# //hs_err_pid1.log\n","stream":"stdout","time":"2018-10-12T08:09:23.283474464Z"}
                    {"log":"[2018-10-12 08:09:23,972] INFO shutting down (org.apache.zookeeper.server.ZooKeeperServer)\n","stream":"stdout","time":"2018-10-12T08:09:23.972737489Z"}
                    {"log":"[2018-10-12 08:09:23,972] INFO Shutting down (org.apache.zookeeper.server.SessionTrackerImpl)\n","stream":"stdout","time":"2018-10-12T08:09:24.1401268Z"}
                    {"log":"[2018-10-12 08:09:23,973] INFO Shutting down (org.apache.zookeeper.server.PrepRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:24.140167256Z"}
                    {"log":"[2018-10-12 08:09:23,973] INFO Shutting down (org.apache.zookeeper.server.quorum.ProposalRequestProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:24.140198366Z"}
                    {"log":"[2018-10-12 08:09:23,973] INFO Shutting down (org.apache.zookeeper.server.quorum.CommitProcessor)\n","stream":"stdout","time":"2018-10-12T08:09:24.140206686Z"}
                    {"log":"[2018-10-12 08:09:24,000] INFO SessionTrackerImpl exited loop! (org.apache.zookeeper.server.SessionTrackerImpl)\n","stream":"stdout","time":"2018-10-12T08:09:24.140214229Z"}
                    {"log":"[thread 140368538486528 also had an error]\n","stream":"stdout","time":"2018-10-12T08:09:24.170850152Z"}
                    {"log":"[thread 140368869295872 also had an error]\n","stream":"stdout","time":"2018-10-12T08:09:24.490417863Z"}

                #
                # Delete the log file to make space.
                rm container-json.log


                #
                # Can we add limits to the logs ?
                # https://medium.freecodecamp.org/how-to-setup-log-rotation-for-a-docker-container-a508093912b2
                # https://docs.docker.com/config/containers/logging/json-file/#options

                #
                # Update the compose YML file to add log limts.

cat > zookeeper.yml << EOYML

version: '3'

networks:
    zookeeper:

volumes:
    zklog:
    zkdata:

services:

    courtney:
        image:
            confluentinc/cp-zookeeper:4.1.1
        ports:
            - "2181:2181"
            - "2888:2888"
            - "3888:3888"
        environment:
            - ZOOKEEPER_SERVER_ID=3
            - ZOOKEEPER_SERVERS=192.168.1.11:2888:3888;192.168.1.16:2888:3888;0.0.0.0:2888:3888
            - ZOOKEEPER_TICK_TIME=2000
            - ZOOKEEPER_INIT_LIMIT=5
            - ZOOKEEPER_SYNC_LIMIT=2
            - ZOOKEEPER_CLIENT_PORT=2181
            - ZOOKEEPER_CLIENT_PORT_ADDRESS=0.0.0.0
        volumes:
            - "zklog:/var/lib/zookeeper/log"
            - "zkdata:/var/lib/zookeeper/data"
        networks:
            - zookeeper
        logging:
            driver: "json-file"
            options:
                max-size: "100k"
                max-file: "3"

EOYML

                #
                # Remove the existing container.
                docker-compose \
                    --file zookeeper.yml \
                    down

                    Removing stevedore_courtney_1 ... done
                    Removing network stevedore_zookeeper

                #
                # Start a new instance.
                docker-compose \
                    --file zookeeper.yml \
                    up -d

                #
                # Watch the logs ....
                docker logs \
                    --follow \
                    --tail 100 \
                    $(docker ps --latest --format '{{.ID}}')

                #
                # Not looking too healthy ...
                [2018-10-12 16:28:14,214] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a83d74 zxid:0x800018c54 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180915_programid1/partitions/3/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180915_programid1/partitions/3/state (org.apache.zookeeper.server.PrepRequestProcessor)
                [2018-10-12 16:28:14,214] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b16efe zxid:0x800018c55 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180619_programid1/partitions/3/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180619_programid1/partitions/3/state (org.apache.zookeeper.server.PrepRequestProcessor)
                [2018-10-12 16:28:14,229] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1be7e44 zxid:0x800018c56 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180808_programid1/partitions/14/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180808_programid1/partitions/14/state (org.apache.zookeeper.server.PrepRequestProcessor)
                [2018-10-12 16:28:14,230] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00001 type:setData cxid:0x1a83d76 zxid:0x800018c57 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180815_programid1/partitions/3/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180815_programid1/partitions/3/state (org.apache.zookeeper.server.PrepRequestProcessor)
                [2018-10-12 16:28:14,238] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00000 type:setData cxid:0x1b16f00 zxid:0x800018c58 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180929_programid1/partitions/5/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180929_programid1/partitions/5/state (org.apache.zookeeper.server.PrepRequestProcessor)
                [2018-10-12 16:28:14,245] INFO Got user-level KeeperException when processing sessionid:0x16653996fa00002 type:setData cxid:0x1be7e46 zxid:0x800018c59 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180901_programid1/partitions/13/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180901_programid1/partitions/13/state (org.apache.zookeeper.server.PrepRequestProcessor)

                #
                # Or perhaps not ?
                # https://github.com/allegro/hermes/issues/599

            #
            # Exit the Zookeeper node ..


        #
        # Do the same on the second Zookeeper node ...

            internalip=$(sed -n '2 p' /etc/phymatopus/zkidents.txt)

            ssh \
                ${sshopts[*]} \
                -o ProxyCommand="${sshproxy}" \
                "${sshuser:?}@${internalip:?}"

                #
                # Remove the existing container.
                docker-compose \
                    --file zookeeper.yml \
                    down

                    Removing stevedore_courtney_1 ... done
                    Removing network stevedore_zookeeper

                #
                # Add the log limits ..
                vi zookeeper.yml

    +   logging:
    +       driver: "json-file"
    +       options:
    +           max-size: "100k"
    +           max-file: "3"


                #
                # Start a new instance.
                docker-compose \
                    --file zookeeper.yml \
                    up -d

                #
                # Watch the logs ....
                docker logs \
                    --follow \
                    --tail 100 \
                    $(docker ps --latest --format '{{.ID}}')


                #
                # This looks a lot healthier ...
                [2018-10-12 16:38:28,012] INFO Server environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,012] INFO Server environment:java.io.tmpdir=/tmp (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,012] INFO Server environment:java.compiler=<NA> (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,012] INFO Server environment:os.name=Linux (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,012] INFO Server environment:os.arch=amd64 (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,012] INFO Server environment:os.version=4.14.14-300.fc27.x86_64 (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,012] INFO Server environment:user.name=root (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,012] INFO Server environment:user.home=/root (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,012] INFO Server environment:user.dir=/ (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,027] INFO Created server with tickTime 2000 minSessionTimeout 4000 maxSessionTimeout 40000 datadir /var/lib/zookeeper/log/version-2 snapdir /var/lib/zookeeper/data/version-2 (org.apache.zookeeper.server.ZooKeeperServer)
                [2018-10-12 16:38:28,037] INFO FOLLOWING - LEADER ELECTION TOOK - 139 (org.apache.zookeeper.server.quorum.Learner)
                [2018-10-12 16:38:28,044] INFO Resolved hostname: 192.168.1.14 to address: /192.168.1.14 (org.apache.zookeeper.server.quorum.QuorumPeer)
                [2018-10-12 16:38:28,073] INFO Getting a snapshot from leader (org.apache.zookeeper.server.quorum.Learner)
                [2018-10-12 16:38:28,125] WARN Got zxid 0x800026afc expected 0x1 (org.apache.zookeeper.server.quorum.Learner)
                [2018-10-12 16:38:28,137] INFO Snapshotting: 0x800026afb to /var/lib/zookeeper/data/version-2/snapshot.800026afb (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
                [2018-10-12 16:38:28,293] INFO Creating new log file: log.800026afc (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 16:38:28,311] WARN Got zxid 0x800026b13 expected 0x1 (org.apache.zookeeper.server.quorum.Learner)
                [2018-10-12 16:49:38,787] INFO Creating new log file: log.800038e58 (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 16:49:38,805] INFO Snapshotting: 0x800038e59 to /var/lib/zookeeper/data/version-2/snapshot.800038e59 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
                [2018-10-12 16:56:49,287] INFO Snapshotting: 0x8000475a2 to /var/lib/zookeeper/data/version-2/snapshot.8000475a2 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
                [2018-10-12 16:56:49,310] INFO Creating new log file: log.8000475a5 (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 16:59:56,505] WARN fsync-ing the write ahead log in SyncThread:2 took 1096ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:05:44,308] INFO Snapshotting: 0x80005967d to /var/lib/zookeeper/data/version-2/snapshot.80005967d (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
                [2018-10-12 17:05:44,321] INFO Creating new log file: log.800059680 (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:13:41,295] INFO Snapshotting: 0x80006b444 to /var/lib/zookeeper/data/version-2/snapshot.80006b444 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
                [2018-10-12 17:13:41,316] INFO Creating new log file: log.80006b447 (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:20:53,740] WARN fsync-ing the write ahead log in SyncThread:2 took 1222ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:21:31,036] WARN fsync-ing the write ahead log in SyncThread:2 took 1277ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:23:04,161] INFO Creating new log file: log.80007efc1 (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:23:04,172] INFO Snapshotting: 0x80007efc0 to /var/lib/zookeeper/data/version-2/snapshot.80007efc0 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
                [2018-10-12 17:28:31,051] WARN fsync-ing the write ahead log in SyncThread:2 took 1177ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:34:51,957] INFO Creating new log file: log.800096e91 (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:34:51,974] INFO Snapshotting: 0x800096e92 to /var/lib/zookeeper/data/version-2/snapshot.800096e92 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
                [2018-10-12 17:42:19,440] INFO Snapshotting: 0x8000a76f6 to /var/lib/zookeeper/data/version-2/snapshot.8000a76f6 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
                [2018-10-12 17:42:19,449] INFO Creating new log file: log.8000a76f9 (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:45:35,270] WARN fsync-ing the write ahead log in SyncThread:2 took 1345ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:45:41,157] WARN fsync-ing the write ahead log in SyncThread:2 took 1340ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:45:58,225] WARN fsync-ing the write ahead log in SyncThread:2 took 2300ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:46:01,737] WARN fsync-ing the write ahead log in SyncThread:2 took 1291ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:46:04,338] WARN fsync-ing the write ahead log in SyncThread:2 took 1076ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:46:06,234] WARN fsync-ing the write ahead log in SyncThread:2 took 1697ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:46:09,607] WARN fsync-ing the write ahead log in SyncThread:2 took 1874ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:50:16,089] WARN fsync-ing the write ahead log in SyncThread:2 took 1180ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:53:02,402] WARN fsync-ing the write ahead log in SyncThread:2 took 1129ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:53:23,965] INFO Creating new log file: log.8000be109 (org.apache.zookeeper.server.persistence.FileTxnLog)
                [2018-10-12 17:53:23,974] INFO Snapshotting: 0x8000be107 to /var/lib/zookeeper/data/version-2/snapshot.8000be107 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)


        #
        # Back to the first instance ...

            internalip=$(sed -n '1 p' /etc/phymatopus/zkidents.txt)

            ssh \
                ${sshopts[*]} \
                -o ProxyCommand="${sshproxy}" \
                "${sshuser:?}@${internalip:?}"

                #
                # Remove the existing container.
                docker-compose \
                    --file zookeeper.yml \
                    down

                    Removing stevedore_courtney_1 ... done
                    Removing network stevedore_zookeeper

                #
                # Start a new instance.
                docker-compose \
                    --file zookeeper.yml \
                    up -d

                #
                # Watch the logs ....
                docker logs \
                    --follow \
                    --tail 100 \
                    $(docker ps --latest --format '{{.ID}}')




# -----------------------------------------------------
# Run another shell ....
#[user@desktop]

    ssh Etalema

    # -----------------------------------------------------
    # Login to the exsiting container.
    #[user@virtual]

        docker exec\
            --tty \
            --interactive \
            $(
              docker ps --latest --format '{{.ID}}'
              ) \
            bash

        # -----------------------------------------------------
        # Load our OpenStack settings.
        #[root@openstacker]

            source '/etc/phymatopus/openstack.settings'

        # -----------------------------------------------------
        # Load our OpenStack and Eleanor functions.
        #[root@openstacker]

            source 'openstack-utils.sh'
            source 'eleanor-utils.sh'
            source 'eleanor-init.sh'

        # -----------------------------------------------------
        # Load our cluster and ZTF settings.
        #[root@openstacker]

            source '/etc/phymatopus/cluster.settings'
            source '/etc/phymatopus/ztf.settings'

        # -----------------------------------------------------
        # Configure our ssh proxy command.
        #[root@openstacker]

            sshproxy="ssh ${sshopts[*]} ${sshuser:?}@${controlip:?} nc %h %p"

        # -----------------------------------------------------
        # Update the third instance ...
        #[root@openstacker]

            internalip=$(sed -n '3 p' /etc/phymatopus/zkidents.txt)

            ssh \
                ${sshopts[*]} \
                -o ProxyCommand="${sshproxy}" \
                "${sshuser:?}@${internalip:?}"

                #
                # Remove the existing container.
                docker-compose \
                    --file zookeeper.yml \
                    down

                    Removing stevedore_courtney_1 ... done
                    Removing network stevedore_zookeeper


                #
                # Add the log limits ..
                vi zookeeper.yml

    +   logging:
    +       driver: "json-file"
    +       options:
    +           max-size: "100k"
    +           max-file: "3"

                #
                # Start a new instance.
                docker-compose \
                    --file zookeeper.yml \
                    up -d

                #
                # Watch the logs ....
                docker logs \
                    --follow \
                    --tail 100 \
                    $(docker ps --latest --format '{{.ID}}')

# -----------------------------------------------------
#[user@raminiara-zookeeper-1]

    df -h /

        Filesystem      Size  Used Avail Use% Mounted on
        /dev/vda3        19G  7.0G   11G  41% /

    docker logs \
        --follow \
        --tail 100 \
        $(docker ps --latest --format '{{.ID}}')

        [2018-10-12 18:19:36,127] INFO FOLLOWING - LEADER ELECTION TOOK - 158 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:19:36,130] INFO Resolved hostname: 192.168.1.14 to address: /192.168.1.14 (org.apache.zookeeper.server.quorum.QuorumPeer)
        [2018-10-12 18:19:36,145] INFO Getting a diff from the leader 0xa00021fc6 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:19:36,148] WARN Got zxid 0xa00021fc2 expected 0x1 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:19:36,218] INFO Creating new log file: log.a00021fc2 (org.apache.zookeeper.server.persistence.FileTxnLog)
        [2018-10-12 18:19:37,354] INFO Accepted socket connection from /192.168.1.10:45498 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:19:37,358] INFO Client attempting to renew session 0x16653996fa00002 at /192.168.1.10:45498 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,359] INFO Revalidating client: 0x16653996fa00002 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:19:37,363] INFO Invalid session 0x16653996fa00002 for client /192.168.1.10:45498, probably expired (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,365] INFO Closed socket connection for client /192.168.1.10:45498 which had sessionid 0x16653996fa00002 (org.apache.zookeeper.server.NIOServerCnxn)
        [2018-10-12 18:19:37,500] INFO Accepted socket connection from /192.168.1.5:46478 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:19:37,501] INFO Client attempting to renew session 0x164ecadc04c0014 at /192.168.1.5:46478 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,501] INFO Revalidating client: 0x164ecadc04c0014 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:19:37,503] INFO Invalid session 0x164ecadc04c0014 for client /192.168.1.5:46478, probably expired (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,503] INFO Closed socket connection for client /192.168.1.5:46478 which had sessionid 0x164ecadc04c0014 (org.apache.zookeeper.server.NIOServerCnxn)
        [2018-10-12 18:19:37,555] INFO Accepted socket connection from /192.168.1.5:46480 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:19:37,556] INFO Client attempting to establish new session at /192.168.1.5:46480 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,571] WARN Got zxid 0xa00021fc7 expected 0x1 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:19:37,589] INFO Established session 0x166698157530000 with negotiated timeout 6000 for client /192.168.1.5:46480 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,760] INFO Accepted socket connection from /192.168.1.15:58502 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:19:37,763] INFO Client attempting to renew session 0x16653996fa00001 at /192.168.1.15:58502 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,763] INFO Revalidating client: 0x16653996fa00001 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:19:37,765] INFO Invalid session 0x16653996fa00001 for client /192.168.1.15:58502, probably expired (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,770] INFO Closed socket connection for client /192.168.1.15:58502 which had sessionid 0x16653996fa00001 (org.apache.zookeeper.server.NIOServerCnxn)
        [2018-10-12 18:19:37,825] INFO Accepted socket connection from /192.168.1.15:58504 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:19:37,827] INFO Client attempting to establish new session at /192.168.1.15:58504 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,837] INFO Established session 0x166698157530001 with negotiated timeout 6000 for client /192.168.1.15:58504 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,978] INFO Accepted socket connection from /192.168.1.10:45500 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:19:37,981] INFO Client attempting to establish new session at /192.168.1.10:45500 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:37,996] INFO Established session 0x166698157530002 with negotiated timeout 6000 for client /192.168.1.10:45500 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:38,071] INFO Accepted socket connection from /192.168.1.8:33440 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:19:38,072] INFO Client attempting to renew session 0x16653996fa00000 at /192.168.1.8:33440 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:38,072] INFO Revalidating client: 0x16653996fa00000 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:19:38,073] INFO Invalid session 0x16653996fa00000 for client /192.168.1.8:33440, probably expired (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:38,074] INFO Closed socket connection for client /192.168.1.8:33440 which had sessionid 0x16653996fa00000 (org.apache.zookeeper.server.NIOServerCnxn)
        [2018-10-12 18:19:38,181] INFO Accepted socket connection from /192.168.1.8:33442 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:19:38,183] INFO Client attempting to establish new session at /192.168.1.8:33442 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:38,196] INFO Established session 0x166698157530003 with negotiated timeout 6000 for client /192.168.1.8:33442 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:19:43,978] WARN fsync-ing the write ahead log in SyncThread:1 took 3934ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)

        [2018-10-12 18:26:20,024] INFO Closed socket connection for client /192.168.1.8:33442 which had sessionid 0x166698157530003 (org.apache.zookeeper.server.NIOServerCnxn)
        [2018-10-12 18:26:26,260] INFO Accepted socket connection from /192.168.1.8:33446 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:26:26,266] INFO Client attempting to renew session 0x166698157530003 at /192.168.1.8:33446 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:26:26,266] INFO Revalidating client: 0x166698157530003 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:26:26,273] INFO Invalid session 0x166698157530003 for client /192.168.1.8:33446, probably expired (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:26:26,274] INFO Closed socket connection for client /192.168.1.8:33446 which had sessionid 0x166698157530003 (org.apache.zookeeper.server.NIOServerCnxn)
        [2018-10-12 18:26:26,316] INFO Accepted socket connection from /192.168.1.8:33448 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:26:26,320] INFO Client attempting to establish new session at /192.168.1.8:33448 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:26:26,352] INFO Established session 0x166698157530004 with negotiated timeout 6000 for client /192.168.1.8:33448 (org.apache.zookeeper.server.ZooKeeperServer)

        [2018-10-12 18:42:22,019] INFO Closed socket connection for client /192.168.1.10:45500 which had sessionid 0x166698157530002 (org.apache.zookeeper.server.NIOServerCnxn)
        [2018-10-12 18:42:24,313] INFO Accepted socket connection from /192.168.1.10:45506 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:42:24,317] INFO Client attempting to renew session 0x166698157530002 at /192.168.1.10:45506 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:42:24,317] INFO Revalidating client: 0x166698157530002 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:42:24,320] INFO Invalid session 0x166698157530002 for client /192.168.1.10:45506, probably expired (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:42:24,321] INFO Closed socket connection for client /192.168.1.10:45506 which had sessionid 0x166698157530002 (org.apache.zookeeper.server.NIOServerCnxn)
        [2018-10-12 18:42:24,333] INFO Accepted socket connection from /192.168.1.10:45508 (org.apache.zookeeper.server.NIOServerCnxnFactory)
        [2018-10-12 18:42:24,334] INFO Client attempting to establish new session at /192.168.1.10:45508 (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:42:24,346] INFO Established session 0x166698157530005 with negotiated timeout 6000 for client /192.168.1.10:45508 (org.apache.zookeeper.server.ZooKeeperServer)

# -----------------------------------------------------
#[user@raminiara-zookeeper-2]

    df -h /

        Filesystem      Size  Used Avail Use% Mounted on
        /dev/vda3        19G  4.9G   13G  29% /

    docker logs \
        --follow \
        --tail 100 \
        $(docker ps --latest --format '{{.ID}}')

        [2018-10-12 18:01:12,102] INFO FOLLOWING - LEADER ELECTION TOOK - 160 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:01:12,117] INFO Resolved hostname: 192.168.1.14 to address: /192.168.1.14 (org.apache.zookeeper.server.quorum.QuorumPeer)
        [2018-10-12 18:01:12,141] INFO Getting a snapshot from leader (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:01:12,327] WARN Got zxid 0xa00000e26 expected 0x1 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:01:12,338] INFO Snapshotting: 0xa00000e25 to /var/lib/zookeeper/data/version-2/snapshot.a00000e25 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
        [2018-10-12 18:01:12,560] INFO Creating new log file: log.a00000e26 (org.apache.zookeeper.server.persistence.FileTxnLog)
        [2018-10-12 18:01:12,575] WARN Got zxid 0xa00000e4e expected 0x1 (org.apache.zookeeper.server.quorum.Learner)
        [2018-10-12 18:10:21,866] INFO Snapshotting: 0xa00013b98 to /var/lib/zookeeper/data/version-2/snapshot.a00013b98 (org.apache.zookeeper.server.persistence.FileTxnSnapLog)
        [2018-10-12 18:10:21,876] INFO Creating new log file: log.a00013b9a (org.apache.zookeeper.server.persistence.FileTxnLog)
        [2018-10-12 18:17:38,827] WARN Connection broken for id 1, my id = 2, error =  (org.apache.zookeeper.server.quorum.QuorumCnxManager)
        java.io.EOFException
	        at java.io.DataInputStream.readInt(DataInputStream.java:392)
	        at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:1013)
        [2018-10-12 18:17:38,879] WARN Interrupting SendWorker (org.apache.zookeeper.server.quorum.QuorumCnxManager)
        [2018-10-12 18:17:38,880] WARN Interrupted while waiting for message on queue (org.apache.zookeeper.server.quorum.QuorumCnxManager)
        java.lang.InterruptedException
	        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	        at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	        at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:1097)
	        at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$700(QuorumCnxManager.java:74)
	        at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:932)
        [2018-10-12 18:17:38,892] WARN Send worker leaving thread (org.apache.zookeeper.server.quorum.QuorumCnxManager)
        [2018-10-12 18:19:36,008] INFO Received connection request /192.168.1.11:45412 (org.apache.zookeeper.server.quorum.QuorumCnxManager)
        [2018-10-12 18:19:36,041] INFO Notification: 1 (message format version), 1 (n.leader), 0xa00021fc1 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0xa (n.peerEpoch) FOLLOWING (my state) (org.apache.zookeeper.server.quorum.FastLeaderElection)
        [2018-10-12 18:19:36,052] INFO Notification: 1 (message format version), 1 (n.leader), 0xa00021fc1 (n.zxid), 0xc (n.round), LOOKING (n.state), 1 (n.sid), 0xa (n.peerEpoch) FOLLOWING (my state) (org.apache.zookeeper.server.quorum.FastLeaderElection)
        [2018-10-12 18:19:40,632] WARN fsync-ing the write ahead log in SyncThread:2 took 1029ms which will adversely effect operation latency. See the ZooKeeper troubleshooting guide (org.apache.zookeeper.server.persistence.FileTxnLog)


# -----------------------------------------------------
#[user@raminiara-zookeeper-3]

    df -h /

        Filesystem      Size  Used Avail Use% Mounted on
        /dev/vda3        19G  7.0G   11G  41% /

    docker logs \
        --follow \
        --tail 100 \
        $(docker ps --latest --format '{{.ID}}')

        [2018-10-12 18:26:26,875] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x1c zxid:0xa000244e1 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180618_programid1/partitions/13/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180618_programid1/partitions/13/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:26,902] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x1e zxid:0xa000244e7 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180917_programid1/partitions/2/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180917_programid1/partitions/2/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:26,992] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x20 zxid:0xa000244ef txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180920_programid1/partitions/1/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180920_programid1/partitions/1/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:27,037] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x22 zxid:0xa000244f8 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180714_programid1/partitions/8/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180714_programid1/partitions/8/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:27,098] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x24 zxid:0xa00024500 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180904_programid1/partitions/9/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180904_programid1/partitions/9/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:27,134] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x26 zxid:0xa00024507 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180724_programid1/partitions/9/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180724_programid1/partitions/9/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:27,207] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x28 zxid:0xa0002450f txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180704_programid1/partitions/2/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180704_programid1/partitions/2/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:27,240] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x2a zxid:0xa00024515 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180804_programid1/partitions/12/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180804_programid1/partitions/12/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:27,283] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x2c zxid:0xa0002451c txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180924_programid1/partitions/14/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180924_programid1/partitions/14/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:27,326] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x2e zxid:0xa00024522 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180911_programid1/partitions/13/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180911_programid1/partitions/13/state (org.apache.zookeeper.server.PrepRequestProcessor)
        [2018-10-12 18:26:27,371] INFO Got user-level KeeperException when processing sessionid:0x166698157530004 type:setData cxid:0x30 zxid:0xa00024528 txntype:-1 reqpath:n/a Error Path:/kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180905_programid1/partitions/8/state Error:KeeperErrorCode = BadVersion for /kafka,192.168.1.16:2181/kafka,192.168.1.14:2181/kafka/brokers/topics/ztf_20180905_programid1/partitions/8/state (org.apache.zookeeper.server.PrepRequestProcessor)


        [2018-10-12 18:42:22,001] INFO Expiring session 0x166698157530002, timeout of 6000ms exceeded (org.apache.zookeeper.server.ZooKeeperServer)
        [2018-10-12 18:42:22,004] INFO Processed session termination for sessionid: 0x166698157530002 (org.apache.zookeeper.server.PrepRequestProcessor)





# -----------------------------------------------------
# Run another shell ....
#[user@desktop]

    ssh Etalema

    # -----------------------------------------------------
    # Login to the exsiting container.
    #[user@virtual]

        docker exec\
            --tty \
            --interactive \
            $(
              docker ps --latest --format '{{.ID}}'
              ) \
            bash

        # -----------------------------------------------------
        # Load our OpenStack settings.
        #[root@openstacker]

            source '/etc/phymatopus/openstack.settings'

        # -----------------------------------------------------
        # Load our OpenStack and Eleanor functions.
        #[root@openstacker]

            source 'openstack-utils.sh'
            source 'eleanor-utils.sh'
            source 'eleanor-init.sh'

        # -----------------------------------------------------
        # Load our cluster and ZTF settings.
        #[root@openstacker]

            source '/etc/phymatopus/cluster.settings'
            source '/etc/phymatopus/ztf.settings'

        # -----------------------------------------------------
        # Configure our ssh proxy command.
        #[root@openstacker]

            sshproxy="ssh ${sshopts[*]} ${sshuser:?}@${controlip:?} nc %h %p"

        # -----------------------------------------------------
        # Build a list of ROE Kafka nodes.
        #[root@openstacker]

            delim=''
            port='9092'
            roeconnect=''

            for address in $(cat /etc/phymatopus/kfidents.txt)
            do
                roeconnect="${roeconnect}${delim}${address}:${port}"
                delim=','
            done

            echo "Kafka brokers [${roeconnect}]"

                Kafka brokers [192.168.1.5:9092,192.168.1.8:9092,192.168.1.15:9092,192.168.1.10:9092]

        # -----------------------------------------------------
        # Check the offsets in the ROE brokers.
        #[root@openstacker]

cat > topics.txt << EOF
ztf_20181001_programid1
ztf_20181002_programid1
ztf_20181003_programid1
ztf_20181004_programid1
ztf_20181005_programid1
ztf_20181006_programid1
ztf_20181007_programid1
ztf_20181008_programid1
ztf_20181009_programid1
ztf_20181010_programid1
ztf_20181011_programid1
ztf_20181012_programid1
EOF

            brokers=${roeconnect:?}

            for topicid in $(cat topics.txt)
            do
                echo "--------------------"
                echo "Topic [${topicid:?}]"

                if [[ "${topicid:?}" =~ ^ztf_[0-9]{8}_programid1$ ]]
                then
                    echo "
                        docker run --rm phymatopus/kafka-core \
                            bin/kafka-run-class.sh kafka.tools.GetOffsetShell \
                                --broker-list "${brokers:?}" \
                                --topic "${topicid:?}" \
                                --time -1

                        docker run --rm phymatopus/kafka-core \
                            bin/kafka-run-class.sh kafka.tools.GetOffsetShell \
                                --broker-list "${brokers:?}" \
                                --topic "${topicid:?}" \
                                --time -2
                        " \
                    | ssh \
                        ${sshopts[*]} \
                        ${sshuser:?}@${controlip:?} | sort

                else
                    echo "Skipping topic"
                fi
            done

            --------------------
            Topic [ztf_20181001_programid1]
            ztf_20181001_programid1:0:0
            ztf_20181001_programid1:10:0
            ztf_20181001_programid1:11:0
            ztf_20181001_programid1:12:0
            ztf_20181001_programid1:13:0
            ztf_20181001_programid1:14:0
            ztf_20181001_programid1:15:0
            ztf_20181001_programid1:1:0
            ztf_20181001_programid1:2:0
            ztf_20181001_programid1:3:0
            ztf_20181001_programid1:4:0
            ztf_20181001_programid1:5:0
            ztf_20181001_programid1:6:0
            ztf_20181001_programid1:7:0
            ztf_20181001_programid1:8:0
            ztf_20181001_programid1:9:0
            --------------------
            Topic [ztf_20181002_programid1]
            ztf_20181002_programid1:0:0
            ztf_20181002_programid1:10:0
            ztf_20181002_programid1:11:0
            ztf_20181002_programid1:12:0
            ztf_20181002_programid1:13:0
            ztf_20181002_programid1:14:0
            ztf_20181002_programid1:15:0
            ztf_20181002_programid1:1:0
            ztf_20181002_programid1:2:0
            ztf_20181002_programid1:3:0
            ztf_20181002_programid1:4:0
            ztf_20181002_programid1:5:0
            ztf_20181002_programid1:6:0
            ztf_20181002_programid1:7:0
            ztf_20181002_programid1:8:0
            ztf_20181002_programid1:9:0
            --------------------
            Topic [ztf_20181003_programid1]
            ztf_20181003_programid1:0:0
            ztf_20181003_programid1:10:0
            ztf_20181003_programid1:11:0
            ztf_20181003_programid1:12:0
            ztf_20181003_programid1:13:0
            ztf_20181003_programid1:14:0
            ztf_20181003_programid1:15:0
            ztf_20181003_programid1:1:0
            ztf_20181003_programid1:2:0
            ztf_20181003_programid1:3:0
            ztf_20181003_programid1:4:0
            ztf_20181003_programid1:5:0
            ztf_20181003_programid1:6:0
            ztf_20181003_programid1:7:0
            ztf_20181003_programid1:8:0
            ztf_20181003_programid1:9:0
            --------------------
            Topic [ztf_20181004_programid1]
            ztf_20181004_programid1:0:0
            ztf_20181004_programid1:10:0
            ztf_20181004_programid1:11:0
            ztf_20181004_programid1:12:0
            ztf_20181004_programid1:13:0
            ztf_20181004_programid1:14:0
            ztf_20181004_programid1:15:0
            ztf_20181004_programid1:1:0
            ztf_20181004_programid1:2:0
            ztf_20181004_programid1:3:0
            ztf_20181004_programid1:4:0
            ztf_20181004_programid1:5:0
            ztf_20181004_programid1:6:0
            ztf_20181004_programid1:7:0
            ztf_20181004_programid1:8:0
            ztf_20181004_programid1:9:0
            --------------------
            Topic [ztf_20181005_programid1]
            ztf_20181005_programid1:0:0
            ztf_20181005_programid1:10:0
            ztf_20181005_programid1:11:0
            ztf_20181005_programid1:12:0
            ztf_20181005_programid1:13:0
            ztf_20181005_programid1:14:0
            ztf_20181005_programid1:15:0
            ztf_20181005_programid1:1:0
            ztf_20181005_programid1:2:0
            ztf_20181005_programid1:3:0
            ztf_20181005_programid1:4:0
            ztf_20181005_programid1:5:0
            ztf_20181005_programid1:6:0
            ztf_20181005_programid1:7:0
            ztf_20181005_programid1:8:0
            ztf_20181005_programid1:9:0
            --------------------
            Topic [ztf_20181006_programid1]
            ztf_20181006_programid1:0:0
            ztf_20181006_programid1:0:10391
            ztf_20181006_programid1:10:0
            ztf_20181006_programid1:10:10392
            ztf_20181006_programid1:11:0
            ztf_20181006_programid1:11:10390
            ztf_20181006_programid1:12:0
            ztf_20181006_programid1:12:10392
            ztf_20181006_programid1:13:0
            ztf_20181006_programid1:13:10391
            ztf_20181006_programid1:14:0
            ztf_20181006_programid1:14:10391
            ztf_20181006_programid1:15:0
            ztf_20181006_programid1:15:10392
            ztf_20181006_programid1:1:0
            ztf_20181006_programid1:1:10392
            ztf_20181006_programid1:2:0
            ztf_20181006_programid1:2:10389
            ztf_20181006_programid1:3:0
            ztf_20181006_programid1:3:10392
            ztf_20181006_programid1:4:0
            ztf_20181006_programid1:4:10391
            ztf_20181006_programid1:5:0
            ztf_20181006_programid1:5:10390
            ztf_20181006_programid1:6:0
            ztf_20181006_programid1:6:10391
            ztf_20181006_programid1:7:0
            ztf_20181006_programid1:7:10391
            ztf_20181006_programid1:8:0
            ztf_20181006_programid1:8:10391
            ztf_20181006_programid1:9:0
            ztf_20181006_programid1:9:10392
            --------------------
            Topic [ztf_20181007_programid1]
            ztf_20181007_programid1:0:0
            ztf_20181007_programid1:10:0
            ztf_20181007_programid1:11:0
            ztf_20181007_programid1:12:0
            ztf_20181007_programid1:13:0
            ztf_20181007_programid1:14:0
            ztf_20181007_programid1:15:0
            ztf_20181007_programid1:1:0
            ztf_20181007_programid1:2:0
            ztf_20181007_programid1:3:0
            ztf_20181007_programid1:4:0
            ztf_20181007_programid1:5:0
            ztf_20181007_programid1:6:0
            ztf_20181007_programid1:7:0
            ztf_20181007_programid1:8:0
            ztf_20181007_programid1:9:0
            --------------------
            Topic [ztf_20181008_programid1]
            ztf_20181008_programid1:0:0
            ztf_20181008_programid1:0:1282
            ztf_20181008_programid1:10:0
            ztf_20181008_programid1:10:1281
            ztf_20181008_programid1:11:0
            ztf_20181008_programid1:11:1281
            ztf_20181008_programid1:12:0
            ztf_20181008_programid1:12:1281
            ztf_20181008_programid1:13:0
            ztf_20181008_programid1:13:1281
            ztf_20181008_programid1:14:0
            ztf_20181008_programid1:14:1282
            ztf_20181008_programid1:15:0
            ztf_20181008_programid1:15:1282
            ztf_20181008_programid1:1:0
            ztf_20181008_programid1:1:1281
            ztf_20181008_programid1:2:0
            ztf_20181008_programid1:2:1281
            ztf_20181008_programid1:3:0
            ztf_20181008_programid1:3:1282
            ztf_20181008_programid1:4:0
            ztf_20181008_programid1:4:1281
            ztf_20181008_programid1:5:0
            ztf_20181008_programid1:5:1282
            ztf_20181008_programid1:6:0
            ztf_20181008_programid1:6:1282
            ztf_20181008_programid1:7:0
            ztf_20181008_programid1:7:1282
            ztf_20181008_programid1:8:0
            ztf_20181008_programid1:8:1281
            ztf_20181008_programid1:9:0
            ztf_20181008_programid1:9:1281
            --------------------
            Topic [ztf_20181009_programid1]
            ztf_20181009_programid1:0:0
            ztf_20181009_programid1:10:0
            ztf_20181009_programid1:11:0
            ztf_20181009_programid1:12:0
            ztf_20181009_programid1:13:0
            ztf_20181009_programid1:14:0
            ztf_20181009_programid1:15:0
            ztf_20181009_programid1:1:0
            ztf_20181009_programid1:2:0
            ztf_20181009_programid1:3:0
            ztf_20181009_programid1:4:0
            ztf_20181009_programid1:5:0
            ztf_20181009_programid1:6:0
            ztf_20181009_programid1:7:0
            ztf_20181009_programid1:8:0
            ztf_20181009_programid1:9:0
            --------------------
            Topic [ztf_20181010_programid1]
            ztf_20181010_programid1:0:0
            ztf_20181010_programid1:10:0
            ztf_20181010_programid1:11:0
            ztf_20181010_programid1:12:0
            ztf_20181010_programid1:13:0
            ztf_20181010_programid1:14:0
            ztf_20181010_programid1:15:0
            ztf_20181010_programid1:1:0
            ztf_20181010_programid1:2:0
            ztf_20181010_programid1:3:0
            ztf_20181010_programid1:4:0
            ztf_20181010_programid1:5:0
            ztf_20181010_programid1:6:0
            ztf_20181010_programid1:7:0
            ztf_20181010_programid1:8:0
            ztf_20181010_programid1:9:0
            --------------------
            Topic [ztf_20181011_programid1]
            ztf_20181011_programid1:0:0
            ztf_20181011_programid1:10:0
            ztf_20181011_programid1:11:0
            ztf_20181011_programid1:12:0
            ztf_20181011_programid1:13:0
            ztf_20181011_programid1:14:0
            ztf_20181011_programid1:15:0
            ztf_20181011_programid1:1:0
            ztf_20181011_programid1:2:0
            ztf_20181011_programid1:3:0
            ztf_20181011_programid1:4:0
            ztf_20181011_programid1:5:0
            ztf_20181011_programid1:6:0
            ztf_20181011_programid1:7:0
            ztf_20181011_programid1:8:0
            ztf_20181011_programid1:9:0
            --------------------
            Topic [ztf_20181012_programid1]
            ztf_20181012_programid1:0:0
            ztf_20181012_programid1:10:0
            ztf_20181012_programid1:11:0
            ztf_20181012_programid1:12:0
            ztf_20181012_programid1:13:0
            ztf_20181012_programid1:14:0
            ztf_20181012_programid1:15:0
            ztf_20181012_programid1:1:0
            ztf_20181012_programid1:2:0
            ztf_20181012_programid1:3:0
            ztf_20181012_programid1:4:0
            ztf_20181012_programid1:5:0
            ztf_20181012_programid1:6:0
            ztf_20181012_programid1:7:0
            ztf_20181012_programid1:8:0
            ztf_20181012_programid1:9:0
            --------------------

        # -----------------------------------------------------
        # Check the offsets in the ZTF brokers.
        #[root@openstacker]

            brokers=${ztfconnect:?}

            for topicid in $(cat topics.txt)
            do
                echo "--------------------"
                echo "Topic [${topicid:?}]"

                if [[ "${topicid:?}" =~ ^ztf_[0-9]{8}_programid1$ ]]
                then
                    echo "
                        docker run --rm phymatopus/kafka-core \
                            bin/kafka-run-class.sh kafka.tools.GetOffsetShell \
                                --broker-list "${brokers:?}" \
                                --topic "${topicid:?}" \
                                --time -1

                        docker run --rm phymatopus/kafka-core \
                            bin/kafka-run-class.sh kafka.tools.GetOffsetShell \
                                --broker-list "${brokers:?}" \
                                --topic "${topicid:?}" \
                                --time -2
                        " \
                    | ssh \
                        ${sshopts[*]} \
                        ${sshuser:?}@${controlip:?} | sort

                else
                    echo "Skipping topic"
                fi
            done

            --------------------
            Topic [ztf_20181001_programid1]
            ztf_20181001_programid1:0:0
            ztf_20181001_programid1:0:0
            ztf_20181001_programid1:10:0
            ztf_20181001_programid1:10:0
            ztf_20181001_programid1:11:0
            ztf_20181001_programid1:11:0
            ztf_20181001_programid1:12:0
            ztf_20181001_programid1:12:0
            ztf_20181001_programid1:13:0
            ztf_20181001_programid1:13:0
            ztf_20181001_programid1:1:0
            ztf_20181001_programid1:1:0
            ztf_20181001_programid1:2:0
            ztf_20181001_programid1:2:0
            ztf_20181001_programid1:3:0
            ztf_20181001_programid1:3:0
            ztf_20181001_programid1:4:0
            ztf_20181001_programid1:4:0
            ztf_20181001_programid1:5:0
            ztf_20181001_programid1:5:0
            ztf_20181001_programid1:6:0
            ztf_20181001_programid1:6:0
            ztf_20181001_programid1:7:0
            ztf_20181001_programid1:7:0
            ztf_20181001_programid1:8:0
            ztf_20181001_programid1:8:0
            ztf_20181001_programid1:9:0
            ztf_20181001_programid1:9:0
            --------------------
            Topic [ztf_20181002_programid1]
            ztf_20181002_programid1:0:0
            ztf_20181002_programid1:0:0
            ztf_20181002_programid1:10:0
            ztf_20181002_programid1:10:0
            ztf_20181002_programid1:11:0
            ztf_20181002_programid1:11:0
            ztf_20181002_programid1:12:0
            ztf_20181002_programid1:12:0
            ztf_20181002_programid1:13:0
            ztf_20181002_programid1:13:0
            ztf_20181002_programid1:1:0
            ztf_20181002_programid1:1:0
            ztf_20181002_programid1:2:0
            ztf_20181002_programid1:2:0
            ztf_20181002_programid1:3:0
            ztf_20181002_programid1:3:0
            ztf_20181002_programid1:4:0
            ztf_20181002_programid1:4:0
            ztf_20181002_programid1:5:0
            ztf_20181002_programid1:5:0
            ztf_20181002_programid1:6:0
            ztf_20181002_programid1:6:0
            ztf_20181002_programid1:7:0
            ztf_20181002_programid1:7:0
            ztf_20181002_programid1:8:0
            ztf_20181002_programid1:8:0
            ztf_20181002_programid1:9:0
            ztf_20181002_programid1:9:0
            --------------------
            Topic [ztf_20181003_programid1]
            ztf_20181003_programid1:0:0
            ztf_20181003_programid1:0:0
            ztf_20181003_programid1:10:0
            ztf_20181003_programid1:10:0
            ztf_20181003_programid1:11:0
            ztf_20181003_programid1:11:0
            ztf_20181003_programid1:12:0
            ztf_20181003_programid1:12:0
            ztf_20181003_programid1:13:0
            ztf_20181003_programid1:13:0
            ztf_20181003_programid1:1:0
            ztf_20181003_programid1:1:0
            ztf_20181003_programid1:2:0
            ztf_20181003_programid1:2:0
            ztf_20181003_programid1:3:0
            ztf_20181003_programid1:3:0
            ztf_20181003_programid1:4:0
            ztf_20181003_programid1:4:0
            ztf_20181003_programid1:5:0
            ztf_20181003_programid1:5:0
            ztf_20181003_programid1:6:0
            ztf_20181003_programid1:6:0
            ztf_20181003_programid1:7:0
            ztf_20181003_programid1:7:0
            ztf_20181003_programid1:8:0
            ztf_20181003_programid1:8:0
            ztf_20181003_programid1:9:0
            ztf_20181003_programid1:9:0
            --------------------
            Topic [ztf_20181004_programid1]
            ztf_20181004_programid1:0:0
            ztf_20181004_programid1:0:0
            ztf_20181004_programid1:10:0
            ztf_20181004_programid1:10:0
            ztf_20181004_programid1:11:0
            ztf_20181004_programid1:11:0
            ztf_20181004_programid1:12:0
            ztf_20181004_programid1:12:0
            ztf_20181004_programid1:13:0
            ztf_20181004_programid1:13:0
            ztf_20181004_programid1:1:0
            ztf_20181004_programid1:1:0
            ztf_20181004_programid1:2:0
            ztf_20181004_programid1:2:0
            ztf_20181004_programid1:3:0
            ztf_20181004_programid1:3:0
            ztf_20181004_programid1:4:0
            ztf_20181004_programid1:4:0
            ztf_20181004_programid1:5:0
            ztf_20181004_programid1:5:0
            ztf_20181004_programid1:6:0
            ztf_20181004_programid1:6:0
            ztf_20181004_programid1:7:0
            ztf_20181004_programid1:7:0
            ztf_20181004_programid1:8:0
            ztf_20181004_programid1:8:0
            ztf_20181004_programid1:9:0
            ztf_20181004_programid1:9:0
            --------------------
            Topic [ztf_20181005_programid1]
            ztf_20181005_programid1:0:0
            ztf_20181005_programid1:0:0
            ztf_20181005_programid1:10:0
            ztf_20181005_programid1:10:0
            ztf_20181005_programid1:11:0
            ztf_20181005_programid1:11:0
            ztf_20181005_programid1:12:0
            ztf_20181005_programid1:12:0
            ztf_20181005_programid1:13:0
            ztf_20181005_programid1:13:0
            ztf_20181005_programid1:1:0
            ztf_20181005_programid1:1:0
            ztf_20181005_programid1:2:0
            ztf_20181005_programid1:2:0
            ztf_20181005_programid1:3:0
            ztf_20181005_programid1:3:0
            ztf_20181005_programid1:4:0
            ztf_20181005_programid1:4:0
            ztf_20181005_programid1:5:0
            ztf_20181005_programid1:5:0
            ztf_20181005_programid1:6:0
            ztf_20181005_programid1:6:0
            ztf_20181005_programid1:7:0
            ztf_20181005_programid1:7:0
            ztf_20181005_programid1:8:0
            ztf_20181005_programid1:8:0
            ztf_20181005_programid1:9:0
            ztf_20181005_programid1:9:0
            --------------------
            Topic [ztf_20181006_programid1]
            ztf_20181006_programid1:0:0
            ztf_20181006_programid1:0:11876
            ztf_20181006_programid1:10:0
            ztf_20181006_programid1:10:11876
            ztf_20181006_programid1:11:0
            ztf_20181006_programid1:11:11875
            ztf_20181006_programid1:12:0
            ztf_20181006_programid1:12:11876
            ztf_20181006_programid1:13:0
            ztf_20181006_programid1:13:11875
            ztf_20181006_programid1:1:0
            ztf_20181006_programid1:1:11876
            ztf_20181006_programid1:2:0
            ztf_20181006_programid1:2:11875
            ztf_20181006_programid1:3:0
            ztf_20181006_programid1:3:11876
            ztf_20181006_programid1:4:0
            ztf_20181006_programid1:4:11875
            ztf_20181006_programid1:5:0
            ztf_20181006_programid1:5:11875
            ztf_20181006_programid1:6:0
            ztf_20181006_programid1:6:11876
            ztf_20181006_programid1:7:0
            ztf_20181006_programid1:7:11876
            ztf_20181006_programid1:8:0
            ztf_20181006_programid1:8:11875
            ztf_20181006_programid1:9:0
            ztf_20181006_programid1:9:11876
            --------------------
            Topic [ztf_20181007_programid1]
            ztf_20181007_programid1:0:0
            ztf_20181007_programid1:0:0
            ztf_20181007_programid1:10:0
            ztf_20181007_programid1:10:0
            ztf_20181007_programid1:11:0
            ztf_20181007_programid1:11:0
            ztf_20181007_programid1:12:0
            ztf_20181007_programid1:12:0
            ztf_20181007_programid1:13:0
            ztf_20181007_programid1:13:0
            ztf_20181007_programid1:1:0
            ztf_20181007_programid1:1:0
            ztf_20181007_programid1:2:0
            ztf_20181007_programid1:2:0
            ztf_20181007_programid1:3:0
            ztf_20181007_programid1:3:0
            ztf_20181007_programid1:4:0
            ztf_20181007_programid1:4:0
            ztf_20181007_programid1:5:0
            ztf_20181007_programid1:5:0
            ztf_20181007_programid1:6:0
            ztf_20181007_programid1:6:0
            ztf_20181007_programid1:7:0
            ztf_20181007_programid1:7:0
            ztf_20181007_programid1:8:0
            ztf_20181007_programid1:8:0
            ztf_20181007_programid1:9:0
            ztf_20181007_programid1:9:0
            --------------------
            Topic [ztf_20181008_programid1]
            ztf_20181008_programid1:0:0
            ztf_20181008_programid1:0:1465
            ztf_20181008_programid1:10:0
            ztf_20181008_programid1:10:1464
            ztf_20181008_programid1:11:0
            ztf_20181008_programid1:11:1465
            ztf_20181008_programid1:12:0
            ztf_20181008_programid1:12:1464
            ztf_20181008_programid1:13:0
            ztf_20181008_programid1:13:1464
            ztf_20181008_programid1:1:0
            ztf_20181008_programid1:1:1464
            ztf_20181008_programid1:2:0
            ztf_20181008_programid1:2:1465
            ztf_20181008_programid1:3:0
            ztf_20181008_programid1:3:1464
            ztf_20181008_programid1:4:0
            ztf_20181008_programid1:4:1465
            ztf_20181008_programid1:5:0
            ztf_20181008_programid1:5:1465
            ztf_20181008_programid1:6:0
            ztf_20181008_programid1:6:1465
            ztf_20181008_programid1:7:0
            ztf_20181008_programid1:7:1464
            ztf_20181008_programid1:8:0
            ztf_20181008_programid1:8:1465
            ztf_20181008_programid1:9:0
            ztf_20181008_programid1:9:1464
            --------------------
            Topic [ztf_20181009_programid1]
            ztf_20181009_programid1:0:0
            ztf_20181009_programid1:0:9607
            ztf_20181009_programid1:10:0
            ztf_20181009_programid1:10:9608
            ztf_20181009_programid1:11:0
            ztf_20181009_programid1:11:9607
            ztf_20181009_programid1:12:0
            ztf_20181009_programid1:12:9608
            ztf_20181009_programid1:13:0
            ztf_20181009_programid1:13:9607
            ztf_20181009_programid1:1:0
            ztf_20181009_programid1:1:9608
            ztf_20181009_programid1:2:0
            ztf_20181009_programid1:2:9607
            ztf_20181009_programid1:3:0
            ztf_20181009_programid1:3:9608
            ztf_20181009_programid1:4:0
            ztf_20181009_programid1:4:9607
            ztf_20181009_programid1:5:0
            ztf_20181009_programid1:5:9607
            ztf_20181009_programid1:6:0
            ztf_20181009_programid1:6:9607
            ztf_20181009_programid1:7:0
            ztf_20181009_programid1:7:9607
            ztf_20181009_programid1:8:0
            ztf_20181009_programid1:8:9607
            ztf_20181009_programid1:9:0
            ztf_20181009_programid1:9:9608
            --------------------
            Topic [ztf_20181010_programid1]
            ztf_20181010_programid1:0:0
            ztf_20181010_programid1:0:0
            ztf_20181010_programid1:10:0
            ztf_20181010_programid1:10:0
            ztf_20181010_programid1:11:0
            ztf_20181010_programid1:11:0
            ztf_20181010_programid1:12:0
            ztf_20181010_programid1:12:0
            ztf_20181010_programid1:13:0
            ztf_20181010_programid1:13:0
            ztf_20181010_programid1:1:0
            ztf_20181010_programid1:1:0
            ztf_20181010_programid1:2:0
            ztf_20181010_programid1:2:0
            ztf_20181010_programid1:3:0
            ztf_20181010_programid1:3:0
            ztf_20181010_programid1:4:0
            ztf_20181010_programid1:4:0
            ztf_20181010_programid1:5:0
            ztf_20181010_programid1:5:0
            ztf_20181010_programid1:6:0
            ztf_20181010_programid1:6:0
            ztf_20181010_programid1:7:0
            ztf_20181010_programid1:7:0
            ztf_20181010_programid1:8:0
            ztf_20181010_programid1:8:0
            ztf_20181010_programid1:9:0
            ztf_20181010_programid1:9:0
            --------------------
            Topic [ztf_20181011_programid1]
            ztf_20181011_programid1:0:0
            ztf_20181011_programid1:0:0
            ztf_20181011_programid1:10:0
            ztf_20181011_programid1:10:0
            ztf_20181011_programid1:11:0
            ztf_20181011_programid1:11:0
            ztf_20181011_programid1:12:0
            ztf_20181011_programid1:12:0
            ztf_20181011_programid1:13:0
            ztf_20181011_programid1:13:0
            ztf_20181011_programid1:1:0
            ztf_20181011_programid1:1:0
            ztf_20181011_programid1:2:0
            ztf_20181011_programid1:2:0
            ztf_20181011_programid1:3:0
            ztf_20181011_programid1:3:0
            ztf_20181011_programid1:4:0
            ztf_20181011_programid1:4:0
            ztf_20181011_programid1:5:0
            ztf_20181011_programid1:5:0
            ztf_20181011_programid1:6:0
            ztf_20181011_programid1:6:0
            ztf_20181011_programid1:7:0
            ztf_20181011_programid1:7:0
            ztf_20181011_programid1:8:0
            ztf_20181011_programid1:8:0
            ztf_20181011_programid1:9:0
            ztf_20181011_programid1:9:0
            --------------------
            Topic [ztf_20181012_programid1]
            ztf_20181012_programid1:0:0
            ztf_20181012_programid1:0:0
            ztf_20181012_programid1:10:0
            ztf_20181012_programid1:10:0
            ztf_20181012_programid1:11:0
            ztf_20181012_programid1:11:0
            ztf_20181012_programid1:12:0
            ztf_20181012_programid1:12:0
            ztf_20181012_programid1:13:0
            ztf_20181012_programid1:13:0
            ztf_20181012_programid1:1:0
            ztf_20181012_programid1:1:0
            ztf_20181012_programid1:2:0
            ztf_20181012_programid1:2:0
            ztf_20181012_programid1:3:0
            ztf_20181012_programid1:3:0
            ztf_20181012_programid1:4:0
            ztf_20181012_programid1:4:0
            ztf_20181012_programid1:5:0
            ztf_20181012_programid1:5:0
            ztf_20181012_programid1:6:0
            ztf_20181012_programid1:6:0
            ztf_20181012_programid1:7:0
            ztf_20181012_programid1:7:0
            ztf_20181012_programid1:8:0
            ztf_20181012_programid1:8:0
            ztf_20181012_programid1:9:0
            ztf_20181012_programid1:9:0
            --------------------


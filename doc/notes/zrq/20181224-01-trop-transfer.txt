#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2018, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#


# -----------------------------------------------------

    #
    # System is broken .. :-(
    #

    #
    # Mirror maker nodes shut themselves down - no idea why ?
    #

    #
    # Kafka nodes shut themselves down - no idea why ?
    #


# -----------------------------------------------------
# Stop Kafka on each node.
#[user@trop03]

    for vmname in ${kfnames[@]}
        do
            echo "---- ----"
            echo "vmname [${vmname:?}]"
            ssh \
                ${scpopts[*]} \
                ${sshuser:?}@${vmname:?} \
                "
                docker-compose \
                    --file kafka.yml \
                    down
                "
        done


    >   ---- ----
    >   Stedigo
    >   Removing stevedore_emily_1 ... done
    >   Removing network stevedore_default
    >   ---- ----
    >   Angece
    >   Stopping stevedore_emily_1 ... done
    >   Removing stevedore_emily_1 ... done
    >   Removing network stevedore_default
    >   ---- ----
    >   Edwalafia
    >   Removing stevedore_emily_1 ... done
    >   Removing network stevedore_default
    >   ---- ----
    >   Onoza
    >   Removing stevedore_emily_1 ... done
    >   Removing network stevedore_default


# -----------------------------------------------------
# Stop MirroMaker on each node.
#[user@trop03]

    for vmname in ${mmnames[@]}
        do
            echo "---- ----"
            echo "vmname [${vmname:?}]"
            ssh \
                ${scpopts[*]} \
                ${sshuser:?}@${vmname:?} \
                "
                docker-compose \
                    --file mirror.yml \
                    down
                "
        done


    >   ---- ----
    >   vmname [Afoaviel]
    >   Removing stevedore_tina_1 ... done
    >   Removing network stevedore_default
    >   ---- ----
    >   vmname [Rusaldez]
    >   Removing stevedore_tina_1 ... done
    >   Removing network stevedore_default


# -----------------------------------------------------
# Check disc free on each node.
#[user@trop03]

    for vmname in ${kfnames[@]}
        do
            echo "---- ----"
            echo "vmname [${vmname:?}]"
            ssh \
                ${scpopts[*]} \
                ${sshuser:?}@${vmname:?} \
                "
                echo \"---- ----\"
                df -h \"/data1-01\"
                echo \"---- ----\"
                df -h \"/data1-02\"
                echo \"---- ----\"
                df -h \"/data2-01\"
                echo \"---- ----\"
                df -h \"/data2-02\"
                "
        done


    >   ---- ----
    >   vmname [Stedigo]
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdc         32G   31G  4.5M 100% /data1-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vde         64G  3.9G   59G   7% /data1-02
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdd         32G   31G  3.6M 100% /data2-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdf         64G   17M   62G   1% /data2-02
    >   ---- ----
    >   vmname [Angece]
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdc         32G   31G  4.0M 100% /data1-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vde         64G  3.9G   59G   7% /data1-02
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdd         32G   31G  4.4M 100% /data2-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdf         64G   17M   62G   1% /data2-02
    >   ---- ----
    >   vmname [Edwalafia]
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdc         32G   31G  6.2M 100% /data1-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vde         64G  3.9G   59G   7% /data1-02
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdd         32G   31G  3.7M 100% /data2-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdf         64G   17M   62G   1% /data2-02
    >   ---- ----
    >   vmname [Onoza]
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdc         32G   31G  4.7M 100% /data1-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vde         64G  3.9G   59G   7% /data1-02
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdd         32G   31G  4.9M 100% /data2-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdf         64G   17M   62G   1% /data2-02


# -----------------------------------------------------
# Start Kafka on each node.
#[user@trop03]

    for vmname in ${kfnames[@]}
        do
            echo "---- ----"
            echo "vmname [${vmname:?}]"
            ssh \
                ${scpopts[*]} \
                ${sshuser:?}@${vmname:?} \
                "
                docker-compose \
                    --file kafka.yml \
                    up -d
                "
        done


    >   ---- ----
    >   vmname [Stedigo]
    >   Creating network "stevedore_default" with the default driver
    >   Creating stevedore_emily_1 ... done
    >   ---- ----
    >   vmname [Angece]
    >   Creating network "stevedore_default" with the default driver
    >   Creating stevedore_emily_1 ... done
    >   ---- ----
    >   vmname [Edwalafia]
    >   Creating network "stevedore_default" with the default driver
    >   Creating stevedore_emily_1 ... done
    >   ---- ----
    >   vmname [Onoza]
    >   Creating network "stevedore_default" with the default driver
    >   Creating stevedore_emily_1 ... done


# -----------------------------------------------------
# Wait for Kafka debug logs to satbilize.

    #
    # Edwalafia (id=3) shut itself down ..
    # "current leader's latest offset 0 is less than replica's latest offset"
    #

#[Stevedore@Edwalafia]
    >   [2018-12-24 02:36:42,462] ERROR [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Exiting because log truncation is not allowed for partition ztf_20181219_programid1-11,
        current leader's latest offset 0 is less than replica's latest offset 10108 (kafka.server.ReplicaFetcherThread)
    >   [2018-12-24 02:36:42,463] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Stopped (kafka.server.ReplicaFetcherThread)

    #
    # Edwalafia (id=3) fails to contact self during shutdown process.
    # Probably because it is shutting down ..
    #

#[Stevedore@Edwalafia]
    >   [2018-12-24 02:36:45,275] WARN [Controller id=3, targetBrokerId=3] Connection to node 3 could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
    >   [2018-12-24 02:36:45,275] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker Edwalafia:9092 (id: 3 rack: 3) was unsuccessful (kafka.controller.RequestSendThread)
    >   java.io.IOException: Connection to Edwalafia:9092 (id: 3 rack: 3) failed.
    >   	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
    >   	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:271)
    >   	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:225)
    >   	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)

    #
    # Edwalafia (id=3) shutdown completed.
    #

#[Stevedore@Edwalafia]
    >   [2018-12-24 02:36:48,176] INFO [SocketServer brokerId=3] Shutting down socket server (kafka.network.SocketServer)
    >   [2018-12-24 02:36:48,207] INFO [SocketServer brokerId=3] Shutdown completed (kafka.network.SocketServer)
    >   [2018-12-24 02:36:48,222] INFO [KafkaServer id=3] shut down completed (kafka.server.KafkaServer)


    #
    # Stedigo (id=1) shut itself down ..
    # "current leader's latest offset 0 is less than replica's latest offset"
    #

#[Stevedore@Stedigo]
    >   [2018-12-24 02:25:55,888] ERROR [ReplicaFetcher replicaId=1, leaderId=4, fetcherId=0] Exiting because log truncation is not allowed for partition ztf_20181219_programid1-6,
        current leader's latest offset 0 is less than replica's latest offset 10110 (kafka.server.ReplicaFetcherThread)
    >   [2018-12-24 02:25:55,889] INFO [ReplicaFetcher replicaId=1, leaderId=4, fetcherId=0] Stopped (kafka.server.ReplicaFetcherThread)

    #
    # Stedigo (id=1) fails to contact self during shutdown process.
    # Probably because it is shutting down ..
    #

#[Stevedore@Stedigo]
    >   [2018-12-24 02:25:58,119] WARN [Controller id=1, targetBrokerId=1] Connection to node 1 could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
    >   [2018-12-24 02:25:58,119] WARN [RequestSendThread controllerId=1] Controller 1's connection to broker Stedigo:9092 (id: 1 rack: 1) was unsuccessful (kafka.controller.RequestSendThread)
    >   java.io.IOException: Connection to Stedigo:9092 (id: 1 rack: 1) failed.
    >   	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
    >   	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:271)
    >   	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:225)
    >   	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:82)

    #
    # Stedigo (id=1) shutdown complete.
    #

#[Stevedore@Stedigo]
    >   [2018-12-24 02:26:03,043] INFO [SocketServer brokerId=1] Shutting down socket server (kafka.network.SocketServer)
    >   [2018-12-24 02:26:03,080] INFO [SocketServer brokerId=1] Shutdown completed (kafka.network.SocketServer)
    >   [2018-12-24 02:26:03,087] INFO [KafkaServer id=1] shut down completed (kafka.server.KafkaServer)


    #
    # Onoza (id=4) shut itself down ..
    # "current leader's latest offset 0 is less than replica's latest offset"
    #

#[Stevedore@Onoza]
    >   [2018-12-24 02:36:42,436] ERROR [ReplicaFetcher replicaId=4, leaderId=2, fetcherId=0] Exiting because log truncation is not allowed for partition ztf_20181219_programid1-11,
        current leader's latest offset 0 is less than replica's latest offset 10117 (kafka.server.ReplicaFetcherThread)
    >   [2018-12-24 02:36:42,437] INFO [ReplicaFetcher replicaId=4, leaderId=2, fetcherId=0] Stopped (kafka.server.ReplicaFetcherThread)

    #
    # Onoza (id=4) tries to hand leadership to others.
    #

#[Stevedore@Onoza]
    >   [2018-12-24 02:36:50,803] TRACE [Controller id=4] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
    >   [2018-12-24 02:36:53,934] WARN [KafkaServer id=4] Retrying controlled shutdown after the previous attempt failed... (kafka.server.KafkaServer)
    >   [2018-12-24 02:36:53,940] INFO [Controller id=4] Shutting down broker 4 (kafka.controller.KafkaController)
    >   [2018-12-24 02:36:53,941] DEBUG [Controller id=4] All shutting down brokers: 4 (kafka.controller.KafkaController)
    >   [2018-12-24 02:36:53,941] DEBUG [Controller id=4] Live brokers: 2 (kafka.controller.KafkaController)
    >   [2018-12-24 02:36:53,963] ERROR [Controller id=4 epoch=12] Controller 4 epoch 12 failed to change state for partition ztf_20181205_programid1-9 from OnlinePartition to OnlinePartition (state.change.logger)
    >   kafka.common.StateChangeFailedException: Failed to elect leader for partition ztf_20181205_programid1-9 under strategy ControlledShutdownPartitionLeaderElectionStrategy
    >   	at kafka.controller.PartitionStateMachine$$anonfun$doElectLeaderForPartitions$3.apply(PartitionStateMachine.scala:328)
    >   	at kafka.controller.PartitionStateMachine$$anonfun$doElectLeaderForPartitions$3.apply(PartitionStateMachine.scala:326)

    #
    # Onoza (id=4) shutdown complete.
    #

#[Stevedore@Onoza]
    >   [2018-12-24 02:37:03,483] INFO [SocketServer brokerId=4] Shutting down socket server (kafka.network.SocketServer)
    >   [2018-12-24 02:37:03,510] INFO [SocketServer brokerId=4] Shutdown completed (kafka.network.SocketServer)
    >   [2018-12-24 02:37:03,517] INFO [KafkaServer id=4] shut down completed (kafka.server.KafkaServer)


    #
    # Angece (id=2) is still operating ..
    #

#[Stevedore@Angece]

    >   [2018-12-24 03:12:06,752] DEBUG [Controller id=2] Topics not in preferred replica for broker 2
    >       Map() (kafka.controller.KafkaController)
    >   [2018-12-24 03:12:06,752] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)

    >   [2018-12-24 03:12:06,753] DEBUG [Controller id=2] Topics not in preferred replica for broker 4
    >       Map(
    >           ztf_20181215_programid1-12 -> Vector(4, 1, 2),
    >           ztf_20181217_programid1-13 -> Vector(4, 1, 2),
    >           ztf_20181215_programid1-4  -> Vector(4, 2, 3),
    >           ztf_20181216_programid1-0  -> Vector(4, 1, 2),
    >           ztf_20181214_programid1-7  -> Vector(4, 2, 3),
    >           ztf_20181205_programid1-1  -> Vector(4, 1, 2),
    >           ztf_20181209_programid1-10 -> Vector(4, 2, 3),
    >           ztf_20181217_programid1-1  -> Vector(4, 1, 2),
    >           ztf_20181214_programid1-15 -> Vector(4, 1, 2),
    >           ztf_20181212_programid1-1  -> Vector(4, 1, 2),
    >           ztf_20181210_programid1-3  -> Vector(4, 1, 2),
    >           ztf_20181219_programid1-7  -> Vector(4, 1, 2),
    >           ztf_20181213_programid1-5  -> Vector(4, 2, 3),
    >           ztf_20181215_programid1-0  -> Vector(4, 1, 2),
    >           ztf_20181213_programid1-13 -> Vector(4, 1, 2),
    >           ztf_20181216_programid1-4  -> Vector(4, 2, 3),
    >           ztf_20181209_programid1-6  -> Vector(4, 1, 2),
    >           ztf_20181210_programid1-7  -> Vector(4, 2, 3),
    >           ztf_20181205_programid1-13 -> Vector(4, 1, 2),
    >           ztf_20181216_programid1-12 -> Vector(4, 1, 2),
    >           ztf_20181214_programid1-3  -> Vector(4, 1, 2),
    >           ztf_20181205_programid1-5  -> Vector(4, 2, 3),
    >           ztf_20181212_programid1-13 -> Vector(4, 1, 2),
    >           ztf_20181212_programid1-5  -> Vector(4, 2, 3),
    >           ztf_20181213_programid1-1  -> Vector(4, 1, 2),
    >           ztf_20181210_programid1-15 -> Vector(4, 1, 2),
    >           ztf_20181217_programid1-5  -> Vector(4, 2, 3),
    >           ztf_20181219_programid1-11 -> Vector(4, 2, 3)
    >           )
    >       (kafka.controller.KafkaController)
    >   [2018-12-24 03:12:06,753] TRACE [Controller id=2] Leader imbalance ratio for broker 4 is 0.7 (kafka.controller.KafkaController)

    >   [2018-12-24 03:12:06,753] DEBUG [Controller id=2] Topics not in preferred replica for broker 1
    >       Map(
    >           ztf_20181215_programid1-1  -> Vector(1, 2, 3),
    >           ztf_20181210_programid1-12 -> Vector(1, 2, 3),
    >           ztf_20181209_programid1-11 -> Vector(1, 3, 4),
    >           ztf_20181217_programid1-2  -> Vector(1, 2, 3),
    >           ztf_20181213_programid1-14 -> Vector(1, 2, 3),
    >           ztf_20181213_programid1-6  -> Vector(1, 3, 4),
    >           ztf_20181215_programid1-9  -> Vector(1, 4, 2),
    >           ztf_20181216_programid1-13 -> Vector(1, 2, 3),
    >           ztf_20181216_programid1-5  -> Vector(1, 3, 4),
    >           ztf_20181210_programid1-0  -> Vector(1, 2, 3),
    >           ztf_20181205_programid1-6  -> Vector(1, 3, 4),
    >           ztf_20181214_programid1-4  -> Vector(1, 3, 4),
    >           ztf_20181217_programid1-6  -> Vector(1, 3, 4),
    >           ztf_20181212_programid1-6  -> Vector(1, 3, 4),
    >           ztf_20181209_programid1-7  -> Vector(1, 2, 3),
    >           ztf_20181205_programid1-14 -> Vector(1, 2, 3),
    >           ztf_20181214_programid1-12 -> Vector(1, 2, 3),
    >           ztf_20181210_programid1-8  -> Vector(1, 4, 2),
    >           ztf_20181219_programid1-12 -> Vector(1, 4, 2),
    >           ztf_20181212_programid1-14 -> Vector(1, 2, 3),
    >           ztf_20181217_programid1-14 -> Vector(1, 2, 3),
    >           ztf_20181213_programid1-10 -> Vector(1, 4, 2),
    >           ztf_20181219_programid1-4  -> Vector(1, 2, 3),
    >           ztf_20181209_programid1-15 -> Vector(1, 4, 2),
    >           ztf_20181215_programid1-5  -> Vector(1, 3, 4),
    >           ztf_20181213_programid1-2  -> Vector(1, 2, 3),
    >           ztf_20181216_programid1-9  -> Vector(1, 4, 2),
    >           ztf_20181215_programid1-13 -> Vector(1, 2, 3),
    >           ztf_20181214_programid1-0  -> Vector(1, 2, 3),
    >           ztf_20181216_programid1-1  -> Vector(1, 2, 3),
    >           ztf_20181212_programid1-2  -> Vector(1, 2, 3),
    >           ztf_20181209_programid1-3  -> Vector(1, 4, 2),
    >           ztf_20181205_programid1-10 -> Vector(1, 4, 2),
    >           ztf_20181214_programid1-8  -> Vector(1, 4, 2),
    >           ztf_20181210_programid1-4  -> Vector(1, 3, 4),
    >           ztf_20181219_programid1-8  -> Vector(1, 3, 4),
    >           ztf_20181205_programid1-2  -> Vector(1, 2, 3),
    >           ztf_20181217_programid1-10 -> Vector(1, 4, 2),
    >           ztf_20181212_programid1-10 -> Vector(1, 4, 2),
    >           ztf_20181219_programid1-0  -> Vector(1, 4, 2)
    >           )
    >       (kafka.controller.KafkaController)
    >   [2018-12-24 03:12:06,754] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)

    >   [2018-12-24 03:12:06,754] DEBUG [Controller id=2] Topics not in preferred replica for broker 3
    >       Map(
    >           ztf_20181216_programid1-11 -> Vector(3, 2, 4),
    >           ztf_20181219_programid1-2  -> Vector(3, 2, 4),
    >           ztf_20181214_programid1-2  -> Vector(3, 4, 1),
    >           ztf_20181205_programid1-4  -> Vector(3, 1, 2),
    >           ztf_20181217_programid1-4  -> Vector(3, 1, 2),
    >           ztf_20181213_programid1-0  -> Vector(3, 4, 1),
    >           ztf_20181209_programid1-13 -> Vector(3, 2, 4),
    >           ztf_20181212_programid1-4  -> Vector(3, 1, 2),
    >           ztf_20181210_programid1-6  -> Vector(3, 1, 2),
    >           ztf_20181219_programid1-10 -> Vector(3, 1, 2),
    >           ztf_20181209_programid1-5  -> Vector(3, 4, 1),
    >           ztf_20181205_programid1-12 -> Vector(3, 4, 1),
    >           ztf_20181214_programid1-10 -> Vector(3, 2, 4),
    >           ztf_20181217_programid1-12 -> Vector(3, 4, 1),
    >           ztf_20181213_programid1-8  -> Vector(3, 2, 4),
    >           ztf_20181212_programid1-12 -> Vector(3, 4, 1),
    >           ztf_20181210_programid1-14 -> Vector(3, 4, 1),
    >           ztf_20181215_programid1-3  -> Vector(3, 4, 1),
    >           ztf_20181216_programid1-7  -> Vector(3, 1, 2),
    >           ztf_20181215_programid1-11 -> Vector(3, 2, 4),
    >           ztf_20181205_programid1-0  -> Vector(3, 4, 1),
    >           ztf_20181217_programid1-0  -> Vector(3, 4, 1),
    >           ztf_20181216_programid1-15 -> Vector(3, 4, 1),
    >           ztf_20181212_programid1-0  -> Vector(3, 4, 1),
    >           ztf_20181214_programid1-14 -> Vector(3, 4, 1),
    >           ztf_20181209_programid1-1  -> Vector(3, 2, 4),
    >           ztf_20181210_programid1-2  -> Vector(3, 4, 1),
    >           ztf_20181219_programid1-6  -> Vector(3, 4, 1),
    >           ztf_20181214_programid1-6  -> Vector(3, 1, 2),
    >           ztf_20181205_programid1-8  -> Vector(3, 2, 4),
    >           ztf_20181212_programid1-8  -> Vector(3, 2, 4),
    >           ztf_20181217_programid1-8  -> Vector(3, 2, 4),
    >           ztf_20181213_programid1-4  -> Vector(3, 1, 2),
    >           ztf_20181219_programid1-14 -> Vector(3, 2, 4),
    >           ztf_20181210_programid1-10 -> Vector(3, 2, 4),
    >           ztf_20181209_programid1-9  -> Vector(3, 1, 2),
    >           ztf_20181215_programid1-15 -> Vector(3, 4, 1),
    >           ztf_20181213_programid1-12 -> Vector(3, 4, 1),
    >           ztf_20181216_programid1-3  -> Vector(3, 4, 1),
    >           ztf_20181215_programid1-7  -> Vector(3, 1, 2)
    >           )
    >       (kafka.controller.KafkaController)
    >   [2018-12-24 03:12:06,754] TRACE [Controller id=2] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)



    #
    # Possible clues ..
    https://stackoverflow.com/questions/52036973/kafka-halting-because-log-truncation-is-not-allowed-for-topic-error-shuttng-down

    https://stackoverflow.com/questions/47438073/possible-causes-of-exiting-because-log-truncation-is-not-allowed

    https://stackoverflow.com/questions/52206800/kafka-trouble-with-multiple-partitions




# -----------------------------------------------------
# Start Kafka on one of the failed nodes.
#[Stevedore@Edwalafia]

    docker-compose \
        --file kafka.yml \
        up -d

    >   Starting stevedore_emily_1 ... done


    #
    # Kafka stopped before it even started ..

#[Stevedore@Edwalafia]
    >   [2018-12-24 04:22:00,027] ERROR [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Exiting because log truncation is not allowed for partition ztf_20181219_programid1-11,
        current leader's latest offset 0 is less than replica's latest offset 10108 (kafka.server.ReplicaFetcherThread)
    >   [2018-12-24 04:22:00,028] INFO [ReplicaFetcher replicaId=3, leaderId=2, fetcherId=0] Stopped (kafka.server.ReplicaFetcherThread)
    >   [2018-12-24 04:22:00,033] INFO Metrics collection stopped before it even started (io.confluent.support.metrics.BaseMetricsReporter)
    >   [2018-12-24 04:22:00,033] INFO Metrics collection stopped (io.confluent.support.metrics.BaseMetricsReporter)
    >   [2018-12-24 04:22:00,036] INFO [KafkaServer id=3] shutting down (kafka.server.KafkaServer)
    >   [2018-12-24 04:22:00,037] INFO [KafkaServer id=3] Starting controlled shutdown (kafka.server.KafkaServer)

#[Stevedore@Edwalafia]
    >   [2018-12-24 04:22:03,590] INFO [SocketServer brokerId=3] Shutting down socket server (kafka.network.SocketServer)
    >   [2018-12-24 04:22:03,618] INFO [SocketServer brokerId=3] Shutdown completed (kafka.network.SocketServer)
    >   [2018-12-24 04:22:03,622] INFO [KafkaServer id=3] shut down completed (kafka.server.KafkaServer)

# -----------------------------------------------------
# Identify files for the problem topic.
#[Stevedore@Edwalafia]

    find /data1-01 -name ztf_20181219*

    >   -

    find /data1-02 -name ztf_20181219*

    >   /data1-02/ztf_20181219_programid1-10
    >   /data1-02/ztf_20181219_programid1-1
    >   /data1-02/ztf_20181219_programid1-11
    >   /data1-02/ztf_20181219_programid1-5
    >   /data1-02/ztf_20181219_programid1-2
    >   /data1-02/ztf_20181219_programid1-3

    find /data2-01 -name ztf_20181219*

    >   -

    find /data2-02 -name ztf_20181219*

    >   /data2-02/ztf_20181219_programid1-4
    >   /data2-02/ztf_20181219_programid1-14
    >   /data2-02/ztf_20181219_programid1-8
    >   /data2-02/ztf_20181219_programid1-15
    >   /data2-02/ztf_20181219_programid1-6
    >   /data2-02/ztf_20181219_programid1-13


# -----------------------------------------------------
# Delete files for the problem topic.
#[Stevedore@Edwalafia]

    sudo rm -r /data1-02/*

    sudo rm -r /data2-02/*


# -----------------------------------------------------
# Start Kafka on one of the failed nodes.
#[Stevedore@Edwalafia]

    docker-compose \
        --file kafka.yml \
        up -d

    docker logs -f stevedore_emily_1


    >   [2018-12-24 04:41:13,195] INFO Replica loaded for partition ztf_20181205_programid1-14 with initial high watermark 0 (kafka.cluster.Replica)
    >   [2018-12-24 04:41:13,196] INFO Replica loaded for partition ztf_20181205_programid1-14 with initial high watermark 10622 (kafka.cluster.Replica)
    >   [2018-12-24 04:41:13,197] INFO Replica loaded for partition ztf_20181219_programid1-13 with initial high watermark 0 (kafka.cluster.Replica)
    >   [2018-12-24 04:41:13,197] INFO Replica loaded for partition ztf_20181219_programid1-13 with initial high watermark 0 (kafka.cluster.Replica)

    >   [2018-12-24 04:41:13,200] INFO [Log partition=ztf_20181219_programid1-13, dir=/data2-02] Loading producer state from offset 0 with message format version 2 (kafka.log.Log)
    >   [2018-12-24 04:41:13,200] INFO [Log partition=ztf_20181219_programid1-13, dir=/data2-02] Completed load of log with 1 segments, log start offset 0 and log end offset 0 in 1 ms (kafka.log.Log)
    >   [2018-12-24 04:41:13,201] INFO Created log for partition ztf_20181219_programid1-13 in /data2-02 with properties
            {
            compression.type -> producer,
            message.format.version -> 1.1-IV0,
            file.delete.delay.ms -> 60000,
            max.message.bytes -> 10485760,
            min.compaction.lag.ms -> 0,
            message.timestamp.type -> CreateTime,
            min.insync.replicas -> 1,
            segment.jitter.ms -> 0,
            preallocate -> false,
            min.cleanable.dirty.ratio -> 0.5,
            index.interval.bytes -> 4096,
            unclean.leader.election.enable -> false,
            retention.bytes -> -1,
            delete.retention.ms -> 86400000,
            cleanup.policy -> [delete],
            flush.ms -> 9223372036854775807,
            segment.ms -> 604800000,
            segment.bytes -> 1073741824,
            retention.ms -> -1,
            message.timestamp.difference.max.ms -> 9223372036854775807,
            segment.index.bytes -> 10485760,
            flush.messages -> 9223372036854775807
            }. (kafka.log.LogManager)
    >   [2018-12-24 04:41:13,201] INFO [Partition ztf_20181219_programid1-13 broker=3] No checkpointed highwatermark is found for partition ztf_20181219_programid1-13 (kafka.cluster.Partition)

    >   [2018-12-24 04:41:13,201] INFO Replica loaded for partition ztf_20181219_programid1-13 with initial high watermark 0 (kafka.cluster.Replica)
    >   [2018-12-24 04:41:13,203] INFO Replica loaded for partition ztf_20181215_programid1-11 with initial high watermark 640 (kafka.cluster.Replica)
    >   [2018-12-24 04:41:13,203] INFO Replica loaded for partition ztf_20181215_programid1-11 with initial high watermark 0 (kafka.cluster.Replica)
    >   [2018-12-24 04:41:13,203] INFO Replica loaded for partition ztf_20181215_programid1-11 with initial high watermark 0 (kafka.cluster.Replica)

    >   [2018-12-24 04:41:13,292] TRACE [Broker id=3] Started fetcher to new leader as part of become-follower request from controller 2 epoch 13 with correlation id 1 for partition ztf_20181212_programid1-5 (state.change.logger)
    >   [2018-12-24 04:41:13,292] TRACE [Broker id=3] Started fetcher to new leader as part of become-follower request from controller 2 epoch 13 with correlation id 1 for partition ztf_20181215_programid1-14 (state.change.logger)
    >   [2018-12-24 04:41:13,292] TRACE [Broker id=3] Started fetcher to new leader as part of become-follower request from controller 2 epoch 13 with correlation id 1 for partition ztf_20181205_programid1-4 (state.change.logger)
    >   [2018-12-24 04:41:13,292] TRACE [Broker id=3] Started fetcher to new leader as part of become-follower request from controller 2 epoch 13 with correlation id 1 for partition ztf_20181214_programid1-13 (state.change.logger)

    >   [2018-12-24 04:41:13,294] TRACE [Broker id=3] Completed LeaderAndIsr request correlationId 1 from controller 2 epoch 13 for the become-follower transition for partition ztf_20181212_programid1-14 (state.change.logger)
    >   [2018-12-24 04:41:13,294] TRACE [Broker id=3] Completed LeaderAndIsr request correlationId 1 from controller 2 epoch 13 for the become-follower transition for partition ztf_20181205_programid1-11 (state.change.logger)
    >   [2018-12-24 04:41:13,295] TRACE [Broker id=3] Completed LeaderAndIsr request correlationId 1 from controller 2 epoch 13 for the become-follower transition for partition ztf_20181219_programid1-10 (state.change.logger)
    >   [2018-12-24 04:41:13,295] TRACE [Broker id=3] Completed LeaderAndIsr request correlationId 1 from controller 2 epoch 13 for the become-follower transition for partition ztf_20181209_programid1-13 (state.change.logger)

    >   [2018-12-24 04:41:13,989] INFO Updated PartitionLeaderEpoch. New: {epoch:2, offset:0}, Current: {epoch:-1, offset:-1} for Partition: ztf_20181219_programid1-5.
        Cache now contains 0 entries. (kafka.server.epoch.LeaderEpochFileCache)
    >   [2018-12-24 04:41:14,136] INFO Updated PartitionLeaderEpoch. New: {epoch:4, offset:0}, Current: {epoch:-1, offset:-1} for Partition: ztf_20181219_programid1-14.
        Cache now contains 0 entries. (kafka.server.epoch.LeaderEpochFileCache)
    >   [2018-12-24 04:41:14,218] INFO Updated PartitionLeaderEpoch. New: {epoch:4, offset:0}, Current: {epoch:-1, offset:-1} for Partition: ztf_20181219_programid1-10.
        Cache now contains 0 entries. (kafka.server.epoch.LeaderEpochFileCache)
    >   [2018-12-24 04:41:14,304] INFO Updated PartitionLeaderEpoch. New: {epoch:3, offset:0}, Current: {epoch:-1, offset:-1} for Partition: ztf_20181219_programid1-4.
        Cache now contains 0 entries. (kafka.server.epoch.LeaderEpochFileCache)

    >   [2018-12-24 04:42:07,184] TRACE [Broker id=3] Completed LeaderAndIsr request correlationId 47 from controller 2 epoch 13 for the become-leader transition for partition ztf_20181215_programid1-7 (state.change.logger)
    >   [2018-12-24 04:42:07,185] INFO [ReplicaAlterLogDirsManager on broker 3] Added fetcher for partitions List() (kafka.server.ReplicaAlterLogDirsManager)
    >   [2018-12-24 04:42:07,187] TRACE [Broker id=3] Cached leader info PartitionState(controllerEpoch=13, leader=3, leaderEpoch=16, isr=[2, 3], zkVersion=24, replicas=[3, 1, 2], offlineReplicas=[1])
        for partition ztf_20181215_programid1-7 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 48 (state.change.logger)


# -----------------------------------------------------
# Delete the problem topic on Onoza.
#[Stevedore@Onoza]

    sudo rm -r /data1-02/*

    sudo rm -r /data2-02/*


# -----------------------------------------------------
# Start Kafka on Onoza.
#[Stevedore@Onoza]

    docker-compose \
        --file kafka.yml \
        up -d

    docker logs -f stevedore_emily_1


    >   [2018-12-24 04:50:00,436] INFO Updated PartitionLeaderEpoch. New: {epoch:5, offset:10106}, Current: {epoch:4, offset:0} for Partition: ztf_20181219_programid1-14.
        Cache now contains 1 entries. (kafka.server.epoch.LeaderEpochFileCache)
    >   [2018-12-24 04:50:12,140] TRACE [Broker id=4] Cached leader info PartitionState(controllerEpoch=13, leader=3, leaderEpoch=8, isr=[2, 3, 4], zkVersion=13, replicas=[3, 2, 4], offlineReplicas=[])
        for partition ztf_20181219_programid1-14 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 8 (state.change.logger)
    >   [2018-12-24 04:50:27,315] TRACE [Broker id=4] Cached leader info PartitionState(controllerEpoch=11, leader=2, leaderEpoch=6, isr=[2, 3, 4], zkVersion=15, replicas=[2, 3, 4], offlineReplicas=[])
        for partition ztf_20181219_programid1-5 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 9 (state.change.logger)
    >   [2018-12-24 04:50:27,316] TRACE [Broker id=4] Cached leader info PartitionState(controllerEpoch=11, leader=2, leaderEpoch=8, isr=[2, 4], zkVersion=11, replicas=[1, 4, 2], offlineReplicas=[1])
        for partition ztf_20181219_programid1-12 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 9 (state.change.logger)
    >   [2018-12-24 04:50:27,317] TRACE [Broker id=4] Cached leader info PartitionState(controllerEpoch=11, leader=2, leaderEpoch=8, isr=[2, 4], zkVersion=11, replicas=[1, 4, 2], offlineReplicas=[1])
        for partition ztf_20181219_programid1-0 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 9 (state.change.logger)

    >   [2018-12-24 04:52:08,063] INFO [Log partition=ztf_20181217_programid1-0, dir=/data2-01] Truncating to 15722 has no effect as the largest offset in the log is 15721 (kafka.log.Log)
    >   [2018-12-24 04:52:08,063] INFO [ReplicaFetcher replicaId=4, leaderId=3, fetcherId=0] Based on follower's leader epoch, leader replied with an offset 14905 >= the follower's log end offset 14905
        in ztf_20181214_programid1-14. No truncation needed. (kafka.server.ReplicaFetcherThread)
    >   [2018-12-24 04:52:08,063] INFO [Log partition=ztf_20181214_programid1-14, dir=/data2-01] Truncating to 14905 has no effect as the largest offset in the log is 14904 (kafka.log.Log)
    >   [2018-12-24 04:52:08,063] INFO [ReplicaFetcher replicaId=4, leaderId=3, fetcherId=0] Based on follower's leader epoch, leader replied with an offset 9896 >= the follower's log end offset 9896
        in ztf_20181212_programid1-12. No truncation needed. (kafka.server.ReplicaFetcherThread)
    >   [2018-12-24 04:52:08,063] INFO [Log partition=ztf_20181212_programid1-12, dir=/data1-01] Truncating to 9896 has no effect as the largest offset in the log is 9895 (kafka.log.Log)

# -----------------------------------------------------
# Delete the problem topic on Stedigo.
#[Stevedore@Stedigo]

    sudo rm -r /data1-02/*

    sudo rm -r /data2-02/*

# -----------------------------------------------------
# Start Kafka on Stedigo.
#[Stevedore@Stedigo]

    docker-compose \
        --file kafka.yml \
        up -d

    docker logs -f stevedore_emily_1

    >   [2018-12-24 05:00:27,685] TRACE [Broker id=1] Cached leader info PartitionState(controllerEpoch=13, leader=4, leaderEpoch=16, isr=[2, 4, 1], zkVersion=24, replicas=[4, 1, 2], offlineReplicas=[])
        for partition ztf_20181212_programid1-13 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 5 (state.change.logger)
    >   [2018-12-24 05:00:27,685] TRACE [Broker id=1] Cached leader info PartitionState(controllerEpoch=13, leader=4, leaderEpoch=14, isr=[4, 3, 1], zkVersion=24, replicas=[1, 3, 4], offlineReplicas=[])
        for partition ztf_20181210_programid1-4 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 5 (state.change.logger)
    >   [2018-12-24 05:00:27,685] TRACE [Broker id=1] Cached leader info PartitionState(controllerEpoch=13, leader=4, leaderEpoch=15, isr=[4, 3, 1], zkVersion=26, replicas=[4, 3, 1], offlineReplicas=[])
        for partition ztf_20181212_programid1-9 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 5 (state.change.logger)

    >   [2018-12-24 05:00:41,525] INFO Updated PartitionLeaderEpoch. New: {epoch:6, offset:10109}, Current: {epoch:4, offset:0}
        for Partition: ztf_20181219_programid1-10. Cache now contains 1 entries. (kafka.server.epoch.LeaderEpochFileCache)
    >   [2018-12-24 05:00:47,143] TRACE [Broker id=1] Cached leader info PartitionState(controllerEpoch=13, leader=3, leaderEpoch=9, isr=[2, 3, 1], zkVersion=13, replicas=[3, 1, 2], offlineReplicas=[])
        for partition ztf_20181219_programid1-10 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 6 (state.change.logger)
    >   [2018-12-24 05:01:04,815] TRACE [Broker id=1] Cached leader info PartitionState(controllerEpoch=11, leader=2, leaderEpoch=6, isr=[2, 3, 1], zkVersion=12, replicas=[1, 2, 3], offlineReplicas=[])
        for partition ztf_20181219_programid1-4 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 7 (state.change.logger)

    >   [2018-12-24 05:02:08,361] TRACE [Broker id=1] Completed LeaderAndIsr request correlationId 82 from controller 2 epoch 13 for the become-leader transition
        for partition ztf_20181217_programid1-10 (state.change.logger)
    >   [2018-12-24 05:02:08,362] INFO [ReplicaAlterLogDirsManager on broker 1] Added fetcher for partitions List() (kafka.server.ReplicaAlterLogDirsManager)
    >   [2018-12-24 05:02:08,364] TRACE [Broker id=1] Cached leader info PartitionState(controllerEpoch=13, leader=1, leaderEpoch=17, isr=[2, 4, 1], zkVersion=25, replicas=[1, 4, 2], offlineReplicas=[])
        for partition ztf_20181217_programid1-10 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 83 (state.change.logger)
    >   [2018-12-24 05:02:08,368] TRACE [Broker id=1] Received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=1, leaderEpoch=17, isr=2,4,1, zkVersion=25, replicas=1,4,2, isNew=false)
        correlation id 84 from controller 2 epoch 13 for partition ztf_20181212_programid1-10 (state.change.logger)


# -----------------------------------------------------
# Check our client offsets in the ZTF broker.
#[user@trop03]

    devnode=Rusaldez

    ztfconnect=public.alerts.ztf.uw.edu:9092
    roegroupid=ztf-mirror.roe.ac.uk

    date ; \
    ssh \
        ${sshopts[*]} \
        ${sshuser:?}@${devnode:?} \
        "
        docker run --rm phymatopus/kafka-core \
            bin/kafka-consumer-groups.sh \
                --bootstrap-server "${ztfconnect:?}" \
                --describe \
                --group "${roegroupid:?}"
         " \
    | sort \
    ; date


    >   Mon 24 Dec 05:06:52 GMT 2018
    >   Consumer group 'ztf-mirror.roe.ac.uk' has no active members.
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID     HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          9953            20858           10905           -               -               -
    >   ztf_20181219_programid1 10         9906            20859           10953           -               -               -
    >   ztf_20181219_programid1 1          10159           20859           10700           -               -               -
    >   ztf_20181219_programid1 11         9932            20858           10926           -               -               -
    >   ztf_20181219_programid1 12         10173           20858           10685           -               -               -
    >   ztf_20181219_programid1 13         9925            20859           10934           -               -               -
    >   ztf_20181219_programid1 2          9898            20858           10960           -               -               -
    >   ztf_20181219_programid1 3          9938            20859           10921           -               -               -
    >   ztf_20181219_programid1 4          10175           20859           10684           -               -               -
    >   ztf_20181219_programid1 5          9922            20858           10936           -               -               -
    >   ztf_20181219_programid1 6          19831           20858           1027            -               -               -
    >   ztf_20181219_programid1 7          19778           20859           1081            -               -               -
    >   ztf_20181219_programid1 8          9947            20858           10911           -               -               -
    >   ztf_20181219_programid1 9          10155           20859           10704           -               -               -
    >   Mon 24 Dec 05:07:01 GMT 2018


# -----------------------------------------------------
# Reset our client offsets in the ZTF broker.
#[user@trop03]

    devnode=Rusaldez

    ztftopicid=ztf_20181219_programid1
    ztfconnect=public.alerts.ztf.uw.edu:9092
    roegroupid=ztf-mirror.roe.ac.uk

    date ; \
    ssh \
        ${sshopts[*]} \
        ${sshuser:?}@${devnode:?} \
        "
        docker run --rm phymatopus/kafka-core \
            bin/kafka-consumer-groups.sh \
                --bootstrap-server "${ztfconnect:?}" \
                --group "${roegroupid:?}" \
                --reset-offsets \
                --to-earliest \
                --execute \
                --topic ${ztftopicid:?}
         " \
    | sort \
    ; date


    >   Mon 24 Dec 05:07:28 GMT 2018
    >   TOPIC                          PARTITION  NEW-OFFSET
    >   ztf_20181219_programid1        0          0
    >   ztf_20181219_programid1        1          0
    >   ztf_20181219_programid1        10         0
    >   ztf_20181219_programid1        11         0
    >   ztf_20181219_programid1        12         0
    >   ztf_20181219_programid1        13         0
    >   ztf_20181219_programid1        2          0
    >   ztf_20181219_programid1        3          0
    >   ztf_20181219_programid1        4          0
    >   ztf_20181219_programid1        5          0
    >   ztf_20181219_programid1        6          0
    >   ztf_20181219_programid1        7          0
    >   ztf_20181219_programid1        8          0
    >   ztf_20181219_programid1        9          0
    >   Mon 24 Dec 05:07:35 GMT 2018


# -----------------------------------------------------
# Check our client offsets in the ZTF broker.
#[user@trop03]

    devnode=Rusaldez

    ztfconnect=public.alerts.ztf.uw.edu:9092
    roegroupid=ztf-mirror.roe.ac.uk

    date ; \
    ssh \
        ${sshopts[*]} \
        ${sshuser:?}@${devnode:?} \
        "
        docker run --rm phymatopus/kafka-core \
            bin/kafka-consumer-groups.sh \
                --bootstrap-server "${ztfconnect:?}" \
                --describe \
                --group "${roegroupid:?}"
         " \
    | sort \
    ; date


    >   Mon 24 Dec 05:07:59 GMT 2018
    >   Consumer group 'ztf-mirror.roe.ac.uk' has no active members.
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID     HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          0               20858           20858           -               -               -
    >   ztf_20181219_programid1 10         0               20859           20859           -               -               -
    >   ztf_20181219_programid1 1          0               20859           20859           -               -               -
    >   ztf_20181219_programid1 11         0               20858           20858           -               -               -
    >   ztf_20181219_programid1 12         0               20858           20858           -               -               -
    >   ztf_20181219_programid1 13         0               20859           20859           -               -               -
    >   ztf_20181219_programid1 2          0               20858           20858           -               -               -
    >   ztf_20181219_programid1 3          0               20859           20859           -               -               -
    >   ztf_20181219_programid1 4          0               20859           20859           -               -               -
    >   ztf_20181219_programid1 5          0               20858           20858           -               -               -
    >   ztf_20181219_programid1 6          0               20858           20858           -               -               -
    >   ztf_20181219_programid1 7          0               20859           20859           -               -               -
    >   ztf_20181219_programid1 8          0               20858           20858           -               -               -
    >   ztf_20181219_programid1 9          0               20859           20859           -               -               -
    >   Mon 24 Dec 05:08:08 GMT 2018


# -----------------------------------------------------
# Update the topic and start MirrorMaker on each node.
#[user@trop03]

    ztftopicid=ztf_20181219_programid1

    for vmname in ${mmnames[@]}
        do
            echo "---- ----"
            echo "vmname [${vmname:?}]"
            ssh \
                ${scpopts[*]} \
                ${sshuser:?}@${vmname:?} \
                "
                docker-compose \
                    --file mirror.yml \
                    down
                sed -i \"
                    s/^ztftopicid=.*/ztftopicid=${ztftopicid:?}/
                    \" mirror.env
                docker-compose \
                    --file mirror.yml \
                    up -d
                "
        done


    >   ---- ----
    >   vmname [Afoaviel]
    >   Removing network stevedore_default
    >   Network stevedore_default not found.
    >   Creating network "stevedore_default" with the default driver
    >   Creating stevedore_tina_1 ... done
    >   ---- ----
    >   vmname [Rusaldez]
    >   Removing network stevedore_default
    >   Network stevedore_default not found.
    >   Creating network "stevedore_default" with the default driver
    >   Creating stevedore_tina_1 ... done


# -----------------------------------------------------
# Check our client offsets in the ZTF broker.
#[user@trop03]

    devnode=Rusaldez

    ztfconnect=public.alerts.ztf.uw.edu:9092
    roegroupid=ztf-mirror.roe.ac.uk

    date ; \
    ssh \
        ${sshopts[*]} \
        ${sshuser:?}@${devnode:?} \
        "
        docker run --rm phymatopus/kafka-core \
            bin/kafka-consumer-groups.sh \
                --bootstrap-server "${ztfconnect:?}" \
                --describe \
                --group "${roegroupid:?}"
         " \
    | sort \
    ; date


    >   Mon 24 Dec 05:12:06 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          498             20858           20360           ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 10         499             20859           20360           ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 11         496             20858           20362           ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 12         495             20858           20363           ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 13         497             20859           20362           ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 1          499             20859           20360           ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 2          500             20858           20358           ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 3          498             20859           20361           ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 4          500             20859           20359           ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 5          500             20858           20358           ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 6          969             20858           19889           ztf-mirror.roe.ac.uk-3-2c15e1d3-3d7a-412c-a5b6-5279ed4a088b /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 7          986             20859           19873           ztf-mirror.roe.ac.uk-3-3bab556f-29c2-492b-8cb7-28b552dc37a2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 8          501             20858           20357           ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 9          499             20859           20360           ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 05:12:14 GMT 2018


# -----------------------------------------------------
# Check the disc use on each Kafka node.
#[user@trop03]

    for vmname in ${kfnames[@]}
        do
            ssh \
                ${sshopts[*]} \
                ${sshuser:?}@${vmname:?} \
                    "
                    echo \"---- ---- ---- ----\"
                    echo \"[\$(hostname)][\$(date)]\"

                    echo \"---- ----\"
                    du -h -d 1 \"/data1-02\"

                    echo "---- ----"
                    du -h -d 1 \"/data2-02\"
                    "
        done


    >   ---- ---- ---- ----
    >   [Stedigo][Mon 24 Dec 05:12:38 GMT 2018]
    >   ---- ----
    >   697M	/data1-02/ztf_20181219_programid1-10
    >   697M	/data1-02/ztf_20181219_programid1-4
    >   49M	/data1-02/ztf_20181219_programid1-8
    >   697M	/data1-02/ztf_20181219_programid1-12
    >   49M	/data1-02/ztf_20181219_programid1-6
    >   697M	/data1-02/ztf_20181219_programid1-0
    >   2.9G	/data1-02
    >   ---- ----
    >   49M	/data2-02/ztf_20181219_programid1-7
    >   49M	/data2-02/ztf_20181219_programid1-1
    >   49M	/data2-02/ztf_20181219_programid1-15
    >   49M	/data2-02/ztf_20181219_programid1-9
    >   49M	/data2-02/ztf_20181219_programid1-3
    >   49M	/data2-02/ztf_20181219_programid1-13
    >   292M	/data2-02
    >   ---- ---- ---- ----
    >   [Angece][Mon 24 Dec 05:12:39 GMT 2018]
    >   ---- ----
    >   697M	/data1-02/ztf_20181219_programid1-10
    >   697M	/data1-02/ztf_20181219_programid1-4
    >   696M	/data1-02/ztf_20181219_programid1-14
    >   697M	/data1-02/ztf_20181219_programid1-5
    >   697M	/data1-02/ztf_20181219_programid1-12
    >   697M	/data1-02/ztf_20181219_programid1-0
    >   4.1G	/data1-02
    >   ---- ----
    >   49M	/data2-02/ztf_20181219_programid1-7
    >   49M	/data2-02/ztf_20181219_programid1-1
    >   49M	/data2-02/ztf_20181219_programid1-11
    >   49M	/data2-02/ztf_20181219_programid1-2
    >   49M	/data2-02/ztf_20181219_programid1-9
    >   49M	/data2-02/ztf_20181219_programid1-13
    >   292M	/data2-02
    >   ---- ---- ---- ----
    >   [Edwalafia][Mon 24 Dec 05:12:39 GMT 2018]
    >   ---- ----
    >   697M	/data1-02/ztf_20181219_programid1-10
    >   49M	/data1-02/ztf_20181219_programid1-1
    >   49M	/data1-02/ztf_20181219_programid1-11
    >   697M	/data1-02/ztf_20181219_programid1-5
    >   49M	/data1-02/ztf_20181219_programid1-2
    >   49M	/data1-02/ztf_20181219_programid1-3
    >   1.6G	/data1-02
    >   ---- ----
    >   697M	/data2-02/ztf_20181219_programid1-4
    >   696M	/data2-02/ztf_20181219_programid1-14
    >   49M	/data2-02/ztf_20181219_programid1-8
    >   49M	/data2-02/ztf_20181219_programid1-15
    >   49M	/data2-02/ztf_20181219_programid1-6
    >   49M	/data2-02/ztf_20181219_programid1-13
    >   1.6G	/data2-02
    >   ---- ---- ---- ----
    >   [Onoza][Mon 24 Dec 05:12:40 GMT 2018]
    >   ---- ----
    >   49M	/data1-02/ztf_20181219_programid1-8
    >   49M	/data1-02/ztf_20181219_programid1-6
    >   49M	/data1-02/ztf_20181219_programid1-7
    >   49M	/data1-02/ztf_20181219_programid1-11
    >   49M	/data1-02/ztf_20181219_programid1-2
    >   49M	/data1-02/ztf_20181219_programid1-9
    >   293M	/data1-02
    >   ---- ----
    >   49M	/data2-02/ztf_20181219_programid1-15
    >   49M	/data2-02/ztf_20181219_programid1-3
    >   696M	/data2-02/ztf_20181219_programid1-14
    >   697M	/data2-02/ztf_20181219_programid1-5
    >   697M	/data2-02/ztf_20181219_programid1-12
    >   697M	/data2-02/ztf_20181219_programid1-0
    >   2.9G	/data2-02


# -----------------------------------------------------
# Check our client offsets in the ZTF broker.
#[user@trop03]

    devnode=Rusaldez

    ztfconnect=public.alerts.ztf.uw.edu:9092
    roegroupid=ztf-mirror.roe.ac.uk

    date ; \
    ssh \
        ${sshopts[*]} \
        ${sshuser:?}@${devnode:?} \
        "
        docker run --rm phymatopus/kafka-core \
            bin/kafka-consumer-groups.sh \
                --bootstrap-server "${ztfconnect:?}" \
                --describe \
                --group "${roegroupid:?}"
         " \
    | sort \
    ; date


    >   Mon 24 Dec 05:32:57 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          6141            20858           14717           ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 10         5877            20859           14982           ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 11         6140            20858           14718           ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 12         6125            20858           14733           ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 13         6132            20859           14727           ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 1          6154            20859           14705           ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 2          5876            20858           14982           ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 3          6144            20859           14715           ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 4          6131            20859           14728           ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 5          6130            20858           14728           ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 6          11954           20858           8904            ztf-mirror.roe.ac.uk-3-2c15e1d3-3d7a-412c-a5b6-5279ed4a088b /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 7          11985           20859           8874            ztf-mirror.roe.ac.uk-3-3bab556f-29c2-492b-8cb7-28b552dc37a2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 8          6133            20858           14725           ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 9          6149            20859           14710           ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 05:33:05 GMT 2018


    >   Mon 24 Dec 05:43:22 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          8851            20858           12007           ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 10         8826            20859           12033           ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 11         8859            20858           11999           ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 12         8833            20858           12025           ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 13         8847            20859           12012           ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 1          8864            20859           11995           ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 2          8822            20858           12036           ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 3          8860            20859           11999           ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 4          8836            20859           12023           ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 5          8843            20858           12015           ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 6          17196           20858           3662            ztf-mirror.roe.ac.uk-3-2c15e1d3-3d7a-412c-a5b6-5279ed4a088b /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 7          17229           20859           3630            ztf-mirror.roe.ac.uk-3-3bab556f-29c2-492b-8cb7-28b552dc37a2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 8          8845            20858           12013           ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 9          8856            20859           12003           ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 05:43:29 GMT 2018


    >   Mon 24 Dec 05:55:08 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          11859           20858           8999            ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 10         11814           20859           9045            ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 11         12117           20858           8741            ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 1          11844           20859           9015            ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 12         11811           20858           9047            ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 13         11850           20859           9009            ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 2          11809           20858           9049            ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 3          12127           20859           8732            ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 4          11820           20859           9039            ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 5          11848           20858           9010            ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 6          20858           20858           0               ztf-mirror.roe.ac.uk-3-2c15e1d3-3d7a-412c-a5b6-5279ed4a088b /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 7          20859           20859           0               ztf-mirror.roe.ac.uk-3-3bab556f-29c2-492b-8cb7-28b552dc37a2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 8          11852           20858           9006            ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 9          11840           20859           9019            ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 05:55:16 GMT 2018


    >   Mon 24 Dec 06:04:57 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          14529           20858           6329            ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 10         14490           20859           6369            ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 11         14555           20858           6303            ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 1          14542           20859           6317            ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 12         14511           20858           6347            ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 13         14546           20859           6313            ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 2          14486           20858           6372            ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 3          14562           20859           6297            ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 4          14520           20859           6339            ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 5          14545           20858           6313            ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 6          20858           20858           0               ztf-mirror.roe.ac.uk-3-2c15e1d3-3d7a-412c-a5b6-5279ed4a088b /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 7          20859           20859           0               ztf-mirror.roe.ac.uk-3-3bab556f-29c2-492b-8cb7-28b552dc37a2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 8          14527           20858           6331            ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 9          14542           20859           6317            ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 06:05:05 GMT 2018


    >   Mon 24 Dec 06:14:14 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          16966           20858           3892            ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 10         16906           20859           3953            ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 11         16976           20858           3882            ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 1          16984           20859           3875            ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 12         16881           20858           3977            ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 13         16995           20859           3864            ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 2          16901           20858           3957            ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 3          16980           20859           3879            ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 4          16893           20859           3966            ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 5          16980           20858           3878            ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 6          20858           20858           0               ztf-mirror.roe.ac.uk-3-2c15e1d3-3d7a-412c-a5b6-5279ed4a088b /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 7          20859           20859           0               ztf-mirror.roe.ac.uk-3-3bab556f-29c2-492b-8cb7-28b552dc37a2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 8          16964           20858           3894            ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 9          16978           20859           3881            ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 06:14:22 GMT 2018


    >   Mon 24 Dec 06:29:03 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          20858           20858           0               ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 10         20859           20859           0               ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 11         20858           20858           0               ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 1          20859           20859           0               ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 12         20858           20858           0               ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 13         20859           20859           0               ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 2          20858           20858           0               ztf-mirror.roe.ac.uk-1-35a31c0c-46d2-4e5d-b125-4f6d5e154c8c /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 3          20859           20859           0               ztf-mirror.roe.ac.uk-1-de98248d-c31a-486a-852e-7b14ef671fb4 /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181219_programid1 4          20859           20859           0               ztf-mirror.roe.ac.uk-2-1b06344d-191f-46fa-856f-e1f95a7f7103 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 5          20858           20858           0               ztf-mirror.roe.ac.uk-2-731db81c-dd3e-434a-a642-2887231e3aba /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181219_programid1 6          20858           20858           0               ztf-mirror.roe.ac.uk-3-2c15e1d3-3d7a-412c-a5b6-5279ed4a088b /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 7          20859           20859           0               ztf-mirror.roe.ac.uk-3-3bab556f-29c2-492b-8cb7-28b552dc37a2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181219_programid1 8          20858           20858           0               ztf-mirror.roe.ac.uk-0-65f3288d-decd-4c40-96bf-7c5757869bb8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181219_programid1 9          20859           20859           0               ztf-mirror.roe.ac.uk-0-d9103067-2a70-4a2a-8ee8-7c32358446ba /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 06:29:11 GMT 2018


# -----------------------------------------------------
# Check the disc use on each Kafka node.
#[user@trop03]

    for vmname in ${kfnames[@]}
        do
            ssh \
                ${sshopts[*]} \
                ${sshuser:?}@${vmname:?} \
                    "
                    echo \"---- ---- ---- ----\"
                    echo \"[\$(hostname)][\$(date)]\"

                    echo \"---- ----\"
                    du -h -d 1 \"/data1-02\"

                    echo "---- ----"
                    du -h -d 1 \"/data2-02\"
                    "
        done


    >   ---- ---- ---- ----
    >   [Stedigo][Mon 24 Dec 06:29:42 GMT 2018]
    >   ---- ----
    >   1.8G	/data1-02/ztf_20181219_programid1-10
    >   1.8G	/data1-02/ztf_20181219_programid1-4
    >   1.2G	/data1-02/ztf_20181219_programid1-8
    >   1.8G	/data1-02/ztf_20181219_programid1-12
    >   1.2G	/data1-02/ztf_20181219_programid1-6
    >   1.8G	/data1-02/ztf_20181219_programid1-0
    >   9.4G	/data1-02
    >   ---- ----
    >   1.2G	/data2-02/ztf_20181219_programid1-7
    >   1.2G	/data2-02/ztf_20181219_programid1-1
    >   1.2G	/data2-02/ztf_20181219_programid1-15
    >   1.2G	/data2-02/ztf_20181219_programid1-9
    >   1.2G	/data2-02/ztf_20181219_programid1-3
    >   1.2G	/data2-02/ztf_20181219_programid1-13
    >   6.9G	/data2-02
    >   ---- ---- ---- ----
    >   [Angece][Mon 24 Dec 06:29:42 GMT 2018]
    >   ---- ----
    >   1.8G	/data1-02/ztf_20181219_programid1-10
    >   1.8G	/data1-02/ztf_20181219_programid1-4
    >   1.8G	/data1-02/ztf_20181219_programid1-14
    >   1.8G	/data1-02/ztf_20181219_programid1-5
    >   1.8G	/data1-02/ztf_20181219_programid1-12
    >   1.8G	/data1-02/ztf_20181219_programid1-0
    >   11G	/data1-02
    >   ---- ----
    >   1.2G	/data2-02/ztf_20181219_programid1-7
    >   1.2G	/data2-02/ztf_20181219_programid1-1
    >   1.2G	/data2-02/ztf_20181219_programid1-11
    >   1.2G	/data2-02/ztf_20181219_programid1-2
    >   1.2G	/data2-02/ztf_20181219_programid1-9
    >   1.2G	/data2-02/ztf_20181219_programid1-13
    >   6.9G	/data2-02
    >   ---- ---- ---- ----
    >   [Edwalafia][Mon 24 Dec 06:29:43 GMT 2018]
    >   ---- ----
    >   1.8G	/data1-02/ztf_20181219_programid1-10
    >   1.2G	/data1-02/ztf_20181219_programid1-1
    >   1.2G	/data1-02/ztf_20181219_programid1-11
    >   1.8G	/data1-02/ztf_20181219_programid1-5
    >   1.2G	/data1-02/ztf_20181219_programid1-2
    >   1.2G	/data1-02/ztf_20181219_programid1-3
    >   8.2G	/data1-02
    >   ---- ----
    >   1.8G	/data2-02/ztf_20181219_programid1-4
    >   1.8G	/data2-02/ztf_20181219_programid1-14
    >   1.2G	/data2-02/ztf_20181219_programid1-8
    >   1.2G	/data2-02/ztf_20181219_programid1-15
    >   1.2G	/data2-02/ztf_20181219_programid1-6
    >   1.2G	/data2-02/ztf_20181219_programid1-13
    >   8.2G	/data2-02
    >   ---- ---- ---- ----
    >   [Onoza][Mon 24 Dec 06:29:43 GMT 2018]
    >   ---- ----
    >   1.2G	/data1-02/ztf_20181219_programid1-8
    >   1.2G	/data1-02/ztf_20181219_programid1-6
    >   1.2G	/data1-02/ztf_20181219_programid1-7
    >   1.2G	/data1-02/ztf_20181219_programid1-11
    >   1.2G	/data1-02/ztf_20181219_programid1-2
    >   1.2G	/data1-02/ztf_20181219_programid1-9
    >   6.9G	/data1-02
    >   ---- ----
    >   1.2G	/data2-02/ztf_20181219_programid1-15
    >   1.2G	/data2-02/ztf_20181219_programid1-3
    >   1.8G	/data2-02/ztf_20181219_programid1-14
    >   1.8G	/data2-02/ztf_20181219_programid1-5
    >   1.8G	/data2-02/ztf_20181219_programid1-12
    >   1.8G	/data2-02/ztf_20181219_programid1-0
    >   9.4G	/data2-02

# -----------------------------------------------------
# Update the topic and start MirrorMaker on each node.
#[user@trop03]

    ztftopicid=ztf_20181220_programid1

    for vmname in ${mmnames[@]}
        do
            echo "---- ----"
            echo "vmname [${vmname:?}]"
            ssh \
                ${scpopts[*]} \
                ${sshuser:?}@${vmname:?} \
                "
                docker-compose \
                    --file mirror.yml \
                    down
                sed -i \"
                    s/^ztftopicid=.*/ztftopicid=${ztftopicid:?}/
                    \" mirror.env
                docker-compose \
                    --file mirror.yml \
                    up -d
                "
        done


    >   ---- ----
    >   vmname [Afoaviel]
    >   Stopping stevedore_tina_1 ... done
    >   Removing stevedore_tina_1 ... done
    >   Removing network stevedore_default
    >   Creating network "stevedore_default" with the default driver
    >   Creating stevedore_tina_1 ... done
    >   ---- ----
    >   vmname [Rusaldez]
    >   Stopping stevedore_tina_1 ... done
    >   Removing stevedore_tina_1 ... done
    >   Removing network stevedore_default
    >   Creating network "stevedore_default" with the default driver
    >   Creating stevedore_tina_1 ... done


# -----------------------------------------------------
# Check our client offsets in the ZTF broker.
#[user@trop03]

    devnode=Rusaldez

    ztfconnect=public.alerts.ztf.uw.edu:9092
    roegroupid=ztf-mirror.roe.ac.uk

    date ; \
    ssh \
        ${sshopts[*]} \
        ${sshuser:?}@${devnode:?} \
        "
        docker run --rm phymatopus/kafka-core \
            bin/kafka-consumer-groups.sh \
                --bootstrap-server "${ztfconnect:?}" \
                --describe \
                --group "${roegroupid:?}"
         " \
    | sort \
    ; date


    >   Mon 24 Dec 06:31:05 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 10         20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 11         20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 1          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 12         20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 13         20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 2          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 3          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 4          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 5          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 6          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 7          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 8          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 9          20859           20859           0               -                                                           -               -
    >   ztf_20181220_programid1 0          -               11534           -               ztf-mirror.roe.ac.uk-0-891b5fc1-3bfe-42bc-a890-610c632ad1e8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181220_programid1 10         -               11534           -               ztf-mirror.roe.ac.uk-1-6a0888cb-5be5-4f36-8f64-1356836f098f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 11         -               11534           -               ztf-mirror.roe.ac.uk-1-f06d3dcc-b643-4dd0-bf7c-bb519e06262f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 1          -               11534           -               ztf-mirror.roe.ac.uk-0-99f38dbe-2fd6-4b02-aeb9-6c5a1361dee8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181220_programid1 12         -               11534           -               ztf-mirror.roe.ac.uk-2-163d14a8-5870-4b81-9d46-2b620516505f /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 13         -               11534           -               ztf-mirror.roe.ac.uk-2-f64f7550-7405-4c36-8cdc-f0d4c41d4262 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 2          -               11534           -               ztf-mirror.roe.ac.uk-1-6a0888cb-5be5-4f36-8f64-1356836f098f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 3          -               11534           -               ztf-mirror.roe.ac.uk-1-f06d3dcc-b643-4dd0-bf7c-bb519e06262f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 4          -               11534           -               ztf-mirror.roe.ac.uk-2-163d14a8-5870-4b81-9d46-2b620516505f /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 5          -               11535           -               ztf-mirror.roe.ac.uk-2-f64f7550-7405-4c36-8cdc-f0d4c41d4262 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 6          -               11534           -               ztf-mirror.roe.ac.uk-3-43853814-116d-463e-a674-8d5610626938 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181220_programid1 7          -               11534           -               ztf-mirror.roe.ac.uk-3-8090afb7-dc91-4982-8dfb-257627ad46b2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181220_programid1 8          -               11534           -               ztf-mirror.roe.ac.uk-0-891b5fc1-3bfe-42bc-a890-610c632ad1e8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181220_programid1 9          -               11534           -               ztf-mirror.roe.ac.uk-0-99f38dbe-2fd6-4b02-aeb9-6c5a1361dee8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 06:31:15 GMT 2018


    >   Mon 24 Dec 06:31:58 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 10         20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 11         20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 1          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 12         20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 13         20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 2          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 3          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 4          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 5          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 6          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 7          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 8          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 9          20859           20859           0               -                                                           -               -
    >   ztf_20181220_programid1 0          243             11534           11291           ztf-mirror.roe.ac.uk-0-891b5fc1-3bfe-42bc-a890-610c632ad1e8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181220_programid1 10         245             11534           11289           ztf-mirror.roe.ac.uk-1-6a0888cb-5be5-4f36-8f64-1356836f098f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 11         199             11534           11335           ztf-mirror.roe.ac.uk-1-f06d3dcc-b643-4dd0-bf7c-bb519e06262f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 1          198             11534           11336           ztf-mirror.roe.ac.uk-0-99f38dbe-2fd6-4b02-aeb9-6c5a1361dee8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181220_programid1 12         199             11534           11335           ztf-mirror.roe.ac.uk-2-163d14a8-5870-4b81-9d46-2b620516505f /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 13         244             11534           11290           ztf-mirror.roe.ac.uk-2-f64f7550-7405-4c36-8cdc-f0d4c41d4262 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 2          242             11534           11292           ztf-mirror.roe.ac.uk-1-6a0888cb-5be5-4f36-8f64-1356836f098f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 3          199             11534           11335           ztf-mirror.roe.ac.uk-1-f06d3dcc-b643-4dd0-bf7c-bb519e06262f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 4          202             11534           11332           ztf-mirror.roe.ac.uk-2-163d14a8-5870-4b81-9d46-2b620516505f /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 5          244             11535           11291           ztf-mirror.roe.ac.uk-2-f64f7550-7405-4c36-8cdc-f0d4c41d4262 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 6          463             11534           11071           ztf-mirror.roe.ac.uk-3-43853814-116d-463e-a674-8d5610626938 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181220_programid1 7          398             11534           11136           ztf-mirror.roe.ac.uk-3-8090afb7-dc91-4982-8dfb-257627ad46b2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181220_programid1 8          243             11534           11291           ztf-mirror.roe.ac.uk-0-891b5fc1-3bfe-42bc-a890-610c632ad1e8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181220_programid1 9          201             11534           11333           ztf-mirror.roe.ac.uk-0-99f38dbe-2fd6-4b02-aeb9-6c5a1361dee8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 06:32:08 GMT 2018


    >   Mon 24 Dec 10:36:38 GMT 2018
    >   TOPIC                   PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                                 HOST            CLIENT-ID
    >   ztf_20181219_programid1 0          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 10         20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 11         20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 1          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 12         20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 13         20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 2          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 3          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 4          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 5          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 6          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 7          20859           20859           0               -                                                           -               -
    >   ztf_20181219_programid1 8          20858           20858           0               -                                                           -               -
    >   ztf_20181219_programid1 9          20859           20859           0               -                                                           -               -
    >   ztf_20181220_programid1 0          11534           11534           0               ztf-mirror.roe.ac.uk-0-891b5fc1-3bfe-42bc-a890-610c632ad1e8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181220_programid1 10         11534           11534           0               ztf-mirror.roe.ac.uk-1-6a0888cb-5be5-4f36-8f64-1356836f098f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 11         11534           11534           0               ztf-mirror.roe.ac.uk-1-f06d3dcc-b643-4dd0-bf7c-bb519e06262f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 1          11534           11534           0               ztf-mirror.roe.ac.uk-0-99f38dbe-2fd6-4b02-aeb9-6c5a1361dee8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181220_programid1 12         11534           11534           0               ztf-mirror.roe.ac.uk-2-163d14a8-5870-4b81-9d46-2b620516505f /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 13         11534           11534           0               ztf-mirror.roe.ac.uk-2-f64f7550-7405-4c36-8cdc-f0d4c41d4262 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 2          11534           11534           0               ztf-mirror.roe.ac.uk-1-6a0888cb-5be5-4f36-8f64-1356836f098f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 3          11534           11534           0               ztf-mirror.roe.ac.uk-1-f06d3dcc-b643-4dd0-bf7c-bb519e06262f /129.215.175.98 ztf-mirror.roe.ac.uk-1
    >   ztf_20181220_programid1 4          11534           11534           0               ztf-mirror.roe.ac.uk-2-163d14a8-5870-4b81-9d46-2b620516505f /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 5          11535           11535           0               ztf-mirror.roe.ac.uk-2-f64f7550-7405-4c36-8cdc-f0d4c41d4262 /129.215.175.98 ztf-mirror.roe.ac.uk-2
    >   ztf_20181220_programid1 6          11534           11534           0               ztf-mirror.roe.ac.uk-3-43853814-116d-463e-a674-8d5610626938 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181220_programid1 7          11534           11534           0               ztf-mirror.roe.ac.uk-3-8090afb7-dc91-4982-8dfb-257627ad46b2 /129.215.175.98 ztf-mirror.roe.ac.uk-3
    >   ztf_20181220_programid1 8          11534           11534           0               ztf-mirror.roe.ac.uk-0-891b5fc1-3bfe-42bc-a890-610c632ad1e8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   ztf_20181220_programid1 9          11534           11534           0               ztf-mirror.roe.ac.uk-0-99f38dbe-2fd6-4b02-aeb9-6c5a1361dee8 /129.215.175.98 ztf-mirror.roe.ac.uk-0
    >   Mon 24 Dec 10:36:48 GMT 2018


# -----------------------------------------------------
# Check the disc use on each Kafka node.
#[user@trop03]

    for vmname in ${kfnames[@]}
        do
            ssh \
                ${sshopts[*]} \
                ${sshuser:?}@${vmname:?} \
                    "
                    echo \"---- ---- ---- ----\"
                    echo \"[\$(hostname)][\$(date)]\"

                    echo \"---- ----\"
                    du -h -d 1 \"/data1-01\"

                    echo \"---- ----\"
                    du -h -d 1 \"/data1-02\"

                    echo \"---- ----\"
                    du -h -d 1 \"/data2-01\"

                    echo "---- ----"
                    du -h -d 1 \"/data2-02\"
                    "
        done

    >   ---- ---- ---- ----
    >   [Stedigo][Mon 24 Dec 11:04:50 GMT 2018]
    >   ---- ----
    >   0	/data1-01/__confluent.support.metrics-0
    >   715M	/data1-01/ztf_20181205_programid1-6
    >   716M	/data1-01/ztf_20181205_programid1-14
    >   715M	/data1-01/ztf_20181205_programid1-12
    >   716M	/data1-01/ztf_20181205_programid1-0
    >   715M	/data1-01/ztf_20181205_programid1-4
    >   716M	/data1-01/ztf_20181205_programid1-1
    >   269M	/data1-01/ztf_20181209_programid1-7
    >   269M	/data1-01/ztf_20181209_programid1-15
    >   269M	/data1-01/ztf_20181209_programid1-14
    >   269M	/data1-01/ztf_20181209_programid1-5
    >   269M	/data1-01/ztf_20181209_programid1-12
    >   269M	/data1-01/ztf_20181209_programid1-6
    >   437M	/data1-01/ztf_20181210_programid1-0
    >   437M	/data1-01/ztf_20181210_programid1-8
    >   437M	/data1-01/ztf_20181210_programid1-9
    >   437M	/data1-01/ztf_20181210_programid1-3
    >   436M	/data1-01/ztf_20181210_programid1-5
    >   437M	/data1-01/ztf_20181210_programid1-2
    >   646M	/data1-01/ztf_20181212_programid1-2
    >   646M	/data1-01/ztf_20181212_programid1-10
    >   647M	/data1-01/ztf_20181212_programid1-12
    >   646M	/data1-01/ztf_20181212_programid1-9
    >   646M	/data1-01/ztf_20181212_programid1-7
    >   646M	/data1-01/ztf_20181212_programid1-1
    >   497M	/data1-01/ztf_20181213_programid1-10
    >   497M	/data1-01/ztf_20181213_programid1-2
    >   497M	/data1-01/ztf_20181213_programid1-9
    >   496M	/data1-01/ztf_20181213_programid1-4
    >   496M	/data1-01/ztf_20181213_programid1-1
    >   496M	/data1-01/ztf_20181213_programid1-11
    >   957M	/data1-01/ztf_20181214_programid1-8
    >   957M	/data1-01/ztf_20181214_programid1-0
    >   957M	/data1-01/ztf_20181214_programid1-5
    >   958M	/data1-01/ztf_20181214_programid1-2
    >   957M	/data1-01/ztf_20181214_programid1-9
    >   957M	/data1-01/ztf_20181214_programid1-3
    >   42M	/data1-01/ztf_20181215_programid1-9
    >   42M	/data1-01/ztf_20181215_programid1-1
    >   42M	/data1-01/ztf_20181215_programid1-15
    >   42M	/data1-01/ztf_20181215_programid1-6
    >   42M	/data1-01/ztf_20181215_programid1-0
    >   42M	/data1-01/ztf_20181215_programid1-7
    >   561M	/data1-01/ztf_20181216_programid1-1
    >   560M	/data1-01/ztf_20181216_programid1-9
    >   560M	/data1-01/ztf_20181216_programid1-3
    >   561M	/data1-01/ztf_20181216_programid1-7
    >   560M	/data1-01/ztf_20181216_programid1-15
    >   560M	/data1-01/ztf_20181216_programid1-0
    >   992M	/data1-01/ztf_20181217_programid1-2
    >   991M	/data1-01/ztf_20181217_programid1-10
    >   992M	/data1-01/ztf_20181217_programid1-12
    >   991M	/data1-01/ztf_20181217_programid1-0
    >   991M	/data1-01/ztf_20181217_programid1-13
    >   993M	/data1-01/ztf_20181217_programid1-7
    >   30G	/data1-01
    >   ---- ----
    >   1.8G	/data1-02/ztf_20181219_programid1-10
    >   1.8G	/data1-02/ztf_20181219_programid1-4
    >   1.2G	/data1-02/ztf_20181219_programid1-8
    >   1.8G	/data1-02/ztf_20181219_programid1-12
    >   1.2G	/data1-02/ztf_20181219_programid1-6
    >   1.8G	/data1-02/ztf_20181219_programid1-0
    >   646M	/data1-02/ztf_20181220_programid1-9
    >   646M	/data1-02/ztf_20181220_programid1-1
    >   646M	/data1-02/ztf_20181220_programid1-15
    >   646M	/data1-02/ztf_20181220_programid1-6
    >   646M	/data1-02/ztf_20181220_programid1-10
    >   646M	/data1-02/ztf_20181220_programid1-7
    >   14G	/data1-02
    >   ---- ----
    >   716M	/data2-01/ztf_20181205_programid1-2
    >   716M	/data2-01/ztf_20181205_programid1-10
    >   715M	/data2-01/ztf_20181205_programid1-11
    >   716M	/data2-01/ztf_20181205_programid1-9
    >   716M	/data2-01/ztf_20181205_programid1-7
    >   715M	/data2-01/ztf_20181205_programid1-13
    >   269M	/data2-01/ztf_20181209_programid1-3
    >   269M	/data2-01/ztf_20181209_programid1-11
    >   269M	/data2-01/ztf_20181209_programid1-0
    >   269M	/data2-01/ztf_20181209_programid1-8
    >   269M	/data2-01/ztf_20181209_programid1-2
    >   269M	/data2-01/ztf_20181209_programid1-9
    >   436M	/data2-01/ztf_20181210_programid1-12
    >   436M	/data2-01/ztf_20181210_programid1-4
    >   437M	/data2-01/ztf_20181210_programid1-15
    >   437M	/data2-01/ztf_20181210_programid1-6
    >   436M	/data2-01/ztf_20181210_programid1-14
    >   437M	/data2-01/ztf_20181210_programid1-11
    >   647M	/data2-01/ztf_20181212_programid1-14
    >   647M	/data2-01/ztf_20181212_programid1-6
    >   646M	/data2-01/ztf_20181212_programid1-11
    >   646M	/data2-01/ztf_20181212_programid1-0
    >   646M	/data2-01/ztf_20181212_programid1-13
    >   646M	/data2-01/ztf_20181212_programid1-4
    >   496M	/data2-01/ztf_20181213_programid1-6
    >   496M	/data2-01/ztf_20181213_programid1-14
    >   496M	/data2-01/ztf_20181213_programid1-12
    >   497M	/data2-01/ztf_20181213_programid1-0
    >   496M	/data2-01/ztf_20181213_programid1-13
    >   496M	/data2-01/ztf_20181213_programid1-7
    >   957M	/data2-01/ztf_20181214_programid1-4
    >   957M	/data2-01/ztf_20181214_programid1-12
    >   957M	/data2-01/ztf_20181214_programid1-11
    >   957M	/data2-01/ztf_20181214_programid1-14
    >   958M	/data2-01/ztf_20181214_programid1-15
    >   958M	/data2-01/ztf_20181214_programid1-6
    >   42M	/data2-01/ztf_20181215_programid1-5
    >   42M	/data2-01/ztf_20181215_programid1-13
    >   42M	/data2-01/ztf_20181215_programid1-8
    >   42M	/data2-01/ztf_20181215_programid1-12
    >   42M	/data2-01/ztf_20181215_programid1-3
    >   42M	/data2-01/ztf_20181215_programid1-10
    >   560M	/data2-01/ztf_20181216_programid1-13
    >   560M	/data2-01/ztf_20181216_programid1-5
    >   560M	/data2-01/ztf_20181216_programid1-6
    >   560M	/data2-01/ztf_20181216_programid1-10
    >   560M	/data2-01/ztf_20181216_programid1-8
    >   560M	/data2-01/ztf_20181216_programid1-12
    >   992M	/data2-01/ztf_20181217_programid1-14
    >   992M	/data2-01/ztf_20181217_programid1-6
    >   993M	/data2-01/ztf_20181217_programid1-11
    >   992M	/data2-01/ztf_20181217_programid1-9
    >   992M	/data2-01/ztf_20181217_programid1-4
    >   992M	/data2-01/ztf_20181217_programid1-1
    >   30G	/data2-01
    >   ---- ----
    >   1.2G	/data2-02/ztf_20181219_programid1-7
    >   1.2G	/data2-02/ztf_20181219_programid1-1
    >   1.2G	/data2-02/ztf_20181219_programid1-15
    >   1.2G	/data2-02/ztf_20181219_programid1-9
    >   1.2G	/data2-02/ztf_20181219_programid1-3
    >   1.2G	/data2-02/ztf_20181219_programid1-13
    >   646M	/data2-02/ztf_20181220_programid1-13
    >   646M	/data2-02/ztf_20181220_programid1-5
    >   646M	/data2-02/ztf_20181220_programid1-12
    >   646M	/data2-02/ztf_20181220_programid1-3
    >   646M	/data2-02/ztf_20181220_programid1-0
    >   646M	/data2-02/ztf_20181220_programid1-8
    >   11G	/data2-02
    >   ---- ---- ---- ----
    >   [Angece][Mon 24 Dec 11:04:50 GMT 2018]
    >   ---- ----
    >   0	/data1-01/__confluent.support.metrics-0
    >   715M	/data1-01/ztf_20181205_programid1-15
    >   716M	/data1-01/ztf_20181205_programid1-7
    >   715M	/data1-01/ztf_20181205_programid1-5
    >   716M	/data1-01/ztf_20181205_programid1-10
    >   715M	/data1-01/ztf_20181205_programid1-13
    >   716M	/data1-01/ztf_20181205_programid1-14
    >   269M	/data1-01/ztf_20181209_programid1-4
    >   269M	/data1-01/ztf_20181209_programid1-12
    >   269M	/data1-01/ztf_20181209_programid1-13
    >   269M	/data1-01/ztf_20181209_programid1-7
    >   269M	/data1-01/ztf_20181209_programid1-15
    >   269M	/data1-01/ztf_20181209_programid1-6
    >   437M	/data1-01/ztf_20181210_programid1-13
    >   436M	/data1-01/ztf_20181210_programid1-5
    >   436M	/data1-01/ztf_20181210_programid1-12
    >   437M	/data1-01/ztf_20181210_programid1-3
    >   437M	/data1-01/ztf_20181210_programid1-10
    >   437M	/data1-01/ztf_20181210_programid1-8
    >   646M	/data1-01/ztf_20181212_programid1-15
    >   646M	/data1-01/ztf_20181212_programid1-7
    >   646M	/data1-01/ztf_20181212_programid1-8
    >   646M	/data1-01/ztf_20181212_programid1-2
    >   646M	/data1-01/ztf_20181212_programid1-10
    >   646M	/data1-01/ztf_20181212_programid1-1
    >   496M	/data1-01/ztf_20181213_programid1-7
    >   496M	/data1-01/ztf_20181213_programid1-15
    >   496M	/data1-01/ztf_20181213_programid1-13
    >   497M	/data1-01/ztf_20181213_programid1-10
    >   496M	/data1-01/ztf_20181213_programid1-8
    >   497M	/data1-01/ztf_20181213_programid1-2
    >   957M	/data1-01/ztf_20181214_programid1-5
    >   957M	/data1-01/ztf_20181214_programid1-13
    >   957M	/data1-01/ztf_20181214_programid1-7
    >   958M	/data1-01/ztf_20181214_programid1-15
    >   958M	/data1-01/ztf_20181214_programid1-6
    >   957M	/data1-01/ztf_20181214_programid1-0
    >   42M	/data1-01/ztf_20181215_programid1-6
    >   42M	/data1-01/ztf_20181215_programid1-14
    >   42M	/data1-01/ztf_20181215_programid1-9
    >   42M	/data1-01/ztf_20181215_programid1-13
    >   42M	/data1-01/ztf_20181215_programid1-4
    >   42M	/data1-01/ztf_20181215_programid1-11
    >   560M	/data1-01/ztf_20181216_programid1-10
    >   560M	/data1-01/ztf_20181216_programid1-2
    >   561M	/data1-01/ztf_20181216_programid1-7
    >   561M	/data1-01/ztf_20181216_programid1-1
    >   560M	/data1-01/ztf_20181216_programid1-12
    >   560M	/data1-01/ztf_20181216_programid1-9
    >   993M	/data1-01/ztf_20181217_programid1-15
    >   993M	/data1-01/ztf_20181217_programid1-7
    >   991M	/data1-01/ztf_20181217_programid1-8
    >   992M	/data1-01/ztf_20181217_programid1-2
    >   991M	/data1-01/ztf_20181217_programid1-13
    >   992M	/data1-01/ztf_20181217_programid1-1
    >   30G	/data1-01
    >   ---- ----
    >   1.8G	/data1-02/ztf_20181219_programid1-10
    >   1.8G	/data1-02/ztf_20181219_programid1-4
    >   1.8G	/data1-02/ztf_20181219_programid1-14
    >   1.8G	/data1-02/ztf_20181219_programid1-5
    >   1.8G	/data1-02/ztf_20181219_programid1-12
    >   1.8G	/data1-02/ztf_20181219_programid1-0
    >   646M	/data1-02/ztf_20181220_programid1-6
    >   646M	/data1-02/ztf_20181220_programid1-14
    >   646M	/data1-02/ztf_20181220_programid1-12
    >   646M	/data1-02/ztf_20181220_programid1-13
    >   646M	/data1-02/ztf_20181220_programid1-7
    >   646M	/data1-02/ztf_20181220_programid1-1
    >   15G	/data1-02
    >   ---- ----
    >   715M	/data2-01/ztf_20181205_programid1-11
    >   715M	/data2-01/ztf_20181205_programid1-3
    >   716M	/data2-01/ztf_20181205_programid1-8
    >   716M	/data2-01/ztf_20181205_programid1-2
    >   715M	/data2-01/ztf_20181205_programid1-4
    >   716M	/data2-01/ztf_20181205_programid1-1
    >   269M	/data2-01/ztf_20181209_programid1-0
    >   269M	/data2-01/ztf_20181209_programid1-8
    >   269M	/data2-01/ztf_20181209_programid1-3
    >   269M	/data2-01/ztf_20181209_programid1-10
    >   269M	/data2-01/ztf_20181209_programid1-1
    >   269M	/data2-01/ztf_20181209_programid1-9
    >   437M	/data2-01/ztf_20181210_programid1-9
    >   437M	/data2-01/ztf_20181210_programid1-1
    >   437M	/data2-01/ztf_20181210_programid1-15
    >   437M	/data2-01/ztf_20181210_programid1-6
    >   437M	/data2-01/ztf_20181210_programid1-0
    >   437M	/data2-01/ztf_20181210_programid1-7
    >   646M	/data2-01/ztf_20181212_programid1-11
    >   646M	/data2-01/ztf_20181212_programid1-3
    >   647M	/data2-01/ztf_20181212_programid1-14
    >   646M	/data2-01/ztf_20181212_programid1-5
    >   646M	/data2-01/ztf_20181212_programid1-13
    >   646M	/data2-01/ztf_20181212_programid1-4
    >   496M	/data2-01/ztf_20181213_programid1-3
    >   496M	/data2-01/ztf_20181213_programid1-11
    >   496M	/data2-01/ztf_20181213_programid1-4
    >   496M	/data2-01/ztf_20181213_programid1-1
    >   496M	/data2-01/ztf_20181213_programid1-14
    >   496M	/data2-01/ztf_20181213_programid1-5
    >   958M	/data2-01/ztf_20181214_programid1-1
    >   957M	/data2-01/ztf_20181214_programid1-9
    >   958M	/data2-01/ztf_20181214_programid1-10
    >   957M	/data2-01/ztf_20181214_programid1-8
    >   957M	/data2-01/ztf_20181214_programid1-12
    >   957M	/data2-01/ztf_20181214_programid1-3
    >   42M	/data2-01/ztf_20181215_programid1-2
    >   42M	/data2-01/ztf_20181215_programid1-10
    >   42M	/data2-01/ztf_20181215_programid1-12
    >   42M	/data2-01/ztf_20181215_programid1-0
    >   42M	/data2-01/ztf_20181215_programid1-7
    >   42M	/data2-01/ztf_20181215_programid1-1
    >   560M	/data2-01/ztf_20181216_programid1-6
    >   560M	/data2-01/ztf_20181216_programid1-14
    >   560M	/data2-01/ztf_20181216_programid1-13
    >   560M	/data2-01/ztf_20181216_programid1-4
    >   560M	/data2-01/ztf_20181216_programid1-11
    >   560M	/data2-01/ztf_20181216_programid1-0
    >   993M	/data2-01/ztf_20181217_programid1-11
    >   993M	/data2-01/ztf_20181217_programid1-3
    >   992M	/data2-01/ztf_20181217_programid1-14
    >   992M	/data2-01/ztf_20181217_programid1-5
    >   992M	/data2-01/ztf_20181217_programid1-4
    >   991M	/data2-01/ztf_20181217_programid1-10
    >   30G	/data2-01
    >   ---- ----
    >   1.2G	/data2-02/ztf_20181219_programid1-7
    >   1.2G	/data2-02/ztf_20181219_programid1-1
    >   1.2G	/data2-02/ztf_20181219_programid1-11
    >   1.2G	/data2-02/ztf_20181219_programid1-2
    >   1.2G	/data2-02/ztf_20181219_programid1-9
    >   1.2G	/data2-02/ztf_20181219_programid1-13
    >   646M	/data2-02/ztf_20181220_programid1-10
    >   646M	/data2-02/ztf_20181220_programid1-2
    >   646M	/data2-02/ztf_20181220_programid1-9
    >   646M	/data2-02/ztf_20181220_programid1-0
    >   646M	/data2-02/ztf_20181220_programid1-4
    >   646M	/data2-02/ztf_20181220_programid1-11
    >   11G	/data2-02
    >   ---- ---- ---- ----
    >   [Edwalafia][Mon 24 Dec 11:04:51 GMT 2018]
    >   ---- ----
    >   0	/data1-01/__confluent.support.metrics-0
    >   715M	/data1-01/ztf_20181205_programid1-12
    >   715M	/data1-01/ztf_20181205_programid1-4
    >   715M	/data1-01/ztf_20181205_programid1-5
    >   715M	/data1-01/ztf_20181205_programid1-15
    >   715M	/data1-01/ztf_20181205_programid1-6
    >   716M	/data1-01/ztf_20181205_programid1-14
    >   269M	/data1-01/ztf_20181209_programid1-1
    >   269M	/data1-01/ztf_20181209_programid1-9
    >   269M	/data1-01/ztf_20181209_programid1-10
    >   269M	/data1-01/ztf_20181209_programid1-4
    >   269M	/data1-01/ztf_20181209_programid1-11
    >   269M	/data1-01/ztf_20181209_programid1-12
    >   437M	/data1-01/ztf_20181210_programid1-10
    >   437M	/data1-01/ztf_20181210_programid1-2
    >   437M	/data1-01/ztf_20181210_programid1-9
    >   437M	/data1-01/ztf_20181210_programid1-13
    >   436M	/data1-01/ztf_20181210_programid1-4
    >   437M	/data1-01/ztf_20181210_programid1-11
    >   647M	/data1-01/ztf_20181212_programid1-12
    >   646M	/data1-01/ztf_20181212_programid1-4
    >   646M	/data1-01/ztf_20181212_programid1-11
    >   646M	/data1-01/ztf_20181212_programid1-2
    >   646M	/data1-01/ztf_20181212_programid1-9
    >   646M	/data1-01/ztf_20181212_programid1-3
    >   497M	/data1-01/ztf_20181213_programid1-0
    >   496M	/data1-01/ztf_20181213_programid1-8
    >   496M	/data1-01/ztf_20181213_programid1-6
    >   496M	/data1-01/ztf_20181213_programid1-14
    >   496M	/data1-01/ztf_20181213_programid1-5
    >   496M	/data1-01/ztf_20181213_programid1-15
    >   957M	/data1-01/ztf_20181214_programid1-14
    >   958M	/data1-01/ztf_20181214_programid1-6
    >   957M	/data1-01/ztf_20181214_programid1-4
    >   957M	/data1-01/ztf_20181214_programid1-11
    >   957M	/data1-01/ztf_20181214_programid1-9
    >   957M	/data1-01/ztf_20181214_programid1-13
    >   42M	/data1-01/ztf_20181215_programid1-3
    >   42M	/data1-01/ztf_20181215_programid1-11
    >   42M	/data1-01/ztf_20181215_programid1-5
    >   42M	/data1-01/ztf_20181215_programid1-13
    >   42M	/data1-01/ztf_20181215_programid1-4
    >   42M	/data1-01/ztf_20181215_programid1-14
    >   561M	/data1-01/ztf_20181216_programid1-7
    >   560M	/data1-01/ztf_20181216_programid1-15
    >   560M	/data1-01/ztf_20181216_programid1-10
    >   561M	/data1-01/ztf_20181216_programid1-1
    >   560M	/data1-01/ztf_20181216_programid1-8
    >   560M	/data1-01/ztf_20181216_programid1-2
    >   992M	/data1-01/ztf_20181217_programid1-12
    >   992M	/data1-01/ztf_20181217_programid1-4
    >   993M	/data1-01/ztf_20181217_programid1-11
    >   992M	/data1-01/ztf_20181217_programid1-2
    >   992M	/data1-01/ztf_20181217_programid1-9
    >   993M	/data1-01/ztf_20181217_programid1-3
    >   30G	/data1-01
    >   ---- ----
    >   1.8G	/data1-02/ztf_20181219_programid1-10
    >   1.2G	/data1-02/ztf_20181219_programid1-1
    >   1.2G	/data1-02/ztf_20181219_programid1-11
    >   1.8G	/data1-02/ztf_20181219_programid1-5
    >   1.2G	/data1-02/ztf_20181219_programid1-2
    >   1.2G	/data1-02/ztf_20181219_programid1-3
    >   646M	/data1-02/ztf_20181220_programid1-15
    >   646M	/data1-02/ztf_20181220_programid1-7
    >   646M	/data1-02/ztf_20181220_programid1-13
    >   646M	/data1-02/ztf_20181220_programid1-4
    >   646M	/data1-02/ztf_20181220_programid1-14
    >   646M	/data1-02/ztf_20181220_programid1-5
    >   12G	/data1-02
    >   ---- ----
    >   716M	/data2-01/ztf_20181205_programid1-8
    >   716M	/data2-01/ztf_20181205_programid1-0
    >   715M	/data2-01/ztf_20181205_programid1-11
    >   716M	/data2-01/ztf_20181205_programid1-2
    >   716M	/data2-01/ztf_20181205_programid1-9
    >   715M	/data2-01/ztf_20181205_programid1-3
    >   269M	/data2-01/ztf_20181209_programid1-13
    >   269M	/data2-01/ztf_20181209_programid1-5
    >   269M	/data2-01/ztf_20181209_programid1-0
    >   269M	/data2-01/ztf_20181209_programid1-7
    >   269M	/data2-01/ztf_20181209_programid1-14
    >   269M	/data2-01/ztf_20181209_programid1-2
    >   437M	/data2-01/ztf_20181210_programid1-6
    >   436M	/data2-01/ztf_20181210_programid1-14
    >   436M	/data2-01/ztf_20181210_programid1-12
    >   437M	/data2-01/ztf_20181210_programid1-0
    >   437M	/data2-01/ztf_20181210_programid1-7
    >   437M	/data2-01/ztf_20181210_programid1-1
    >   646M	/data2-01/ztf_20181212_programid1-8
    >   646M	/data2-01/ztf_20181212_programid1-0
    >   647M	/data2-01/ztf_20181212_programid1-14
    >   646M	/data2-01/ztf_20181212_programid1-5
    >   646M	/data2-01/ztf_20181212_programid1-15
    >   647M	/data2-01/ztf_20181212_programid1-6
    >   496M	/data2-01/ztf_20181213_programid1-12
    >   496M	/data2-01/ztf_20181213_programid1-4
    >   497M	/data2-01/ztf_20181213_programid1-9
    >   496M	/data2-01/ztf_20181213_programid1-3
    >   496M	/data2-01/ztf_20181213_programid1-11
    >   497M	/data2-01/ztf_20181213_programid1-2
    >   958M	/data2-01/ztf_20181214_programid1-10
    >   958M	/data2-01/ztf_20181214_programid1-2
    >   957M	/data2-01/ztf_20181214_programid1-7
    >   958M	/data2-01/ztf_20181214_programid1-1
    >   957M	/data2-01/ztf_20181214_programid1-12
    >   957M	/data2-01/ztf_20181214_programid1-0
    >   42M	/data2-01/ztf_20181215_programid1-15
    >   42M	/data2-01/ztf_20181215_programid1-7
    >   42M	/data2-01/ztf_20181215_programid1-8
    >   42M	/data2-01/ztf_20181215_programid1-2
    >   42M	/data2-01/ztf_20181215_programid1-10
    >   42M	/data2-01/ztf_20181215_programid1-1
    >   560M	/data2-01/ztf_20181216_programid1-3
    >   560M	/data2-01/ztf_20181216_programid1-11
    >   560M	/data2-01/ztf_20181216_programid1-13
    >   560M	/data2-01/ztf_20181216_programid1-4
    >   560M	/data2-01/ztf_20181216_programid1-14
    >   560M	/data2-01/ztf_20181216_programid1-5
    >   991M	/data2-01/ztf_20181217_programid1-8
    >   991M	/data2-01/ztf_20181217_programid1-0
    >   992M	/data2-01/ztf_20181217_programid1-14
    >   992M	/data2-01/ztf_20181217_programid1-5
    >   993M	/data2-01/ztf_20181217_programid1-15
    >   992M	/data2-01/ztf_20181217_programid1-6
    >   30G	/data2-01
    >   ---- ----
    >   1.8G	/data2-02/ztf_20181219_programid1-4
    >   1.8G	/data2-02/ztf_20181219_programid1-14
    >   1.2G	/data2-02/ztf_20181219_programid1-8
    >   1.2G	/data2-02/ztf_20181219_programid1-15
    >   1.2G	/data2-02/ztf_20181219_programid1-6
    >   1.2G	/data2-02/ztf_20181219_programid1-13
    >   646M	/data2-02/ztf_20181220_programid1-3
    >   646M	/data2-02/ztf_20181220_programid1-11
    >   646M	/data2-02/ztf_20181220_programid1-10
    >   646M	/data2-02/ztf_20181220_programid1-1
    >   646M	/data2-02/ztf_20181220_programid1-8
    >   646M	/data2-02/ztf_20181220_programid1-2
    >   12G	/data2-02
    >   ---- ---- ---- ----
    >   [Onoza][Mon 24 Dec 11:04:51 GMT 2018]
    >   ---- ----
    >   715M	/data1-01/ztf_20181205_programid1-5
    >   715M	/data1-01/ztf_20181205_programid1-13
    >   716M	/data1-01/ztf_20181205_programid1-8
    >   715M	/data1-01/ztf_20181205_programid1-12
    >   715M	/data1-01/ztf_20181205_programid1-3
    >   716M	/data1-01/ztf_20181205_programid1-10
    >   269M	/data1-01/ztf_20181209_programid1-10
    >   269M	/data1-01/ztf_20181209_programid1-2
    >   269M	/data1-01/ztf_20181209_programid1-3
    >   269M	/data1-01/ztf_20181209_programid1-4
    >   269M	/data1-01/ztf_20181209_programid1-11
    >   269M	/data1-01/ztf_20181209_programid1-5
    >   437M	/data1-01/ztf_20181210_programid1-15
    >   437M	/data1-01/ztf_20181210_programid1-7
    >   437M	/data1-01/ztf_20181210_programid1-13
    >   436M	/data1-01/ztf_20181210_programid1-4
    >   437M	/data1-01/ztf_20181210_programid1-8
    >   436M	/data1-01/ztf_20181210_programid1-5
    >   646M	/data1-01/ztf_20181212_programid1-5
    >   646M	/data1-01/ztf_20181212_programid1-13
    >   646M	/data1-01/ztf_20181212_programid1-8
    >   647M	/data1-01/ztf_20181212_programid1-12
    >   647M	/data1-01/ztf_20181212_programid1-6
    >   646M	/data1-01/ztf_20181212_programid1-10
    >   497M	/data1-01/ztf_20181213_programid1-9
    >   496M	/data1-01/ztf_20181213_programid1-1
    >   496M	/data1-01/ztf_20181213_programid1-12
    >   496M	/data1-01/ztf_20181213_programid1-3
    >   497M	/data1-01/ztf_20181213_programid1-10
    >   496M	/data1-01/ztf_20181213_programid1-8
    >   957M	/data1-01/ztf_20181214_programid1-7
    >   958M	/data1-01/ztf_20181214_programid1-15
    >   958M	/data1-01/ztf_20181214_programid1-10
    >   958M	/data1-01/ztf_20181214_programid1-1
    >   957M	/data1-01/ztf_20181214_programid1-5
    >   958M	/data1-01/ztf_20181214_programid1-2
    >   42M	/data1-01/ztf_20181215_programid1-8
    >   42M	/data1-01/ztf_20181215_programid1-0
    >   42M	/data1-01/ztf_20181215_programid1-15
    >   42M	/data1-01/ztf_20181215_programid1-2
    >   42M	/data1-01/ztf_20181215_programid1-6
    >   42M	/data1-01/ztf_20181215_programid1-14
    >   560M	/data1-01/ztf_20181216_programid1-4
    >   560M	/data1-01/ztf_20181216_programid1-12
    >   560M	/data1-01/ztf_20181216_programid1-6
    >   560M	/data1-01/ztf_20181216_programid1-14
    >   560M	/data1-01/ztf_20181216_programid1-5
    >   560M	/data1-01/ztf_20181216_programid1-15
    >   992M	/data1-01/ztf_20181217_programid1-5
    >   991M	/data1-01/ztf_20181217_programid1-13
    >   991M	/data1-01/ztf_20181217_programid1-8
    >   992M	/data1-01/ztf_20181217_programid1-12
    >   993M	/data1-01/ztf_20181217_programid1-3
    >   991M	/data1-01/ztf_20181217_programid1-10
    >   30G	/data1-01
    >   ---- ----
    >   1.2G	/data1-02/ztf_20181219_programid1-8
    >   1.2G	/data1-02/ztf_20181219_programid1-6
    >   1.2G	/data1-02/ztf_20181219_programid1-7
    >   1.2G	/data1-02/ztf_20181219_programid1-11
    >   1.2G	/data1-02/ztf_20181219_programid1-2
    >   1.2G	/data1-02/ztf_20181219_programid1-9
    >   646M	/data1-02/ztf_20181220_programid1-12
    >   646M	/data1-02/ztf_20181220_programid1-4
    >   646M	/data1-02/ztf_20181220_programid1-15
    >   646M	/data1-02/ztf_20181220_programid1-6
    >   646M	/data1-02/ztf_20181220_programid1-14
    >   646M	/data1-02/ztf_20181220_programid1-5
    >   11G	/data1-02
    >   ---- ----
    >   716M	/data2-01/ztf_20181205_programid1-9
    >   716M	/data2-01/ztf_20181205_programid1-1
    >   715M	/data2-01/ztf_20181205_programid1-15
    >   715M	/data2-01/ztf_20181205_programid1-6
    >   716M	/data2-01/ztf_20181205_programid1-0
    >   716M	/data2-01/ztf_20181205_programid1-7
    >   269M	/data2-01/ztf_20181209_programid1-14
    >   269M	/data2-01/ztf_20181209_programid1-6
    >   269M	/data2-01/ztf_20181209_programid1-13
    >   269M	/data2-01/ztf_20181209_programid1-1
    >   269M	/data2-01/ztf_20181209_programid1-8
    >   269M	/data2-01/ztf_20181209_programid1-15
    >   437M	/data2-01/ztf_20181210_programid1-3
    >   437M	/data2-01/ztf_20181210_programid1-11
    >   437M	/data2-01/ztf_20181210_programid1-10
    >   437M	/data2-01/ztf_20181210_programid1-1
    >   436M	/data2-01/ztf_20181210_programid1-14
    >   437M	/data2-01/ztf_20181210_programid1-2
    >   646M	/data2-01/ztf_20181212_programid1-9
    >   646M	/data2-01/ztf_20181212_programid1-1
    >   646M	/data2-01/ztf_20181212_programid1-15
    >   646M	/data2-01/ztf_20181212_programid1-0
    >   646M	/data2-01/ztf_20181212_programid1-3
    >   646M	/data2-01/ztf_20181212_programid1-7
    >   496M	/data2-01/ztf_20181213_programid1-13
    >   496M	/data2-01/ztf_20181213_programid1-5
    >   496M	/data2-01/ztf_20181213_programid1-6
    >   497M	/data2-01/ztf_20181213_programid1-0
    >   496M	/data2-01/ztf_20181213_programid1-7
    >   496M	/data2-01/ztf_20181213_programid1-15
    >   957M	/data2-01/ztf_20181214_programid1-11
    >   957M	/data2-01/ztf_20181214_programid1-3
    >   957M	/data2-01/ztf_20181214_programid1-4
    >   957M	/data2-01/ztf_20181214_programid1-8
    >   957M	/data2-01/ztf_20181214_programid1-14
    >   957M	/data2-01/ztf_20181214_programid1-13
    >   42M	/data2-01/ztf_20181215_programid1-12
    >   42M	/data2-01/ztf_20181215_programid1-4
    >   42M	/data2-01/ztf_20181215_programid1-5
    >   42M	/data2-01/ztf_20181215_programid1-9
    >   42M	/data2-01/ztf_20181215_programid1-3
    >   42M	/data2-01/ztf_20181215_programid1-11
    >   560M	/data2-01/ztf_20181216_programid1-8
    >   560M	/data2-01/ztf_20181216_programid1-0
    >   560M	/data2-01/ztf_20181216_programid1-3
    >   560M	/data2-01/ztf_20181216_programid1-11
    >   560M	/data2-01/ztf_20181216_programid1-2
    >   560M	/data2-01/ztf_20181216_programid1-9
    >   992M	/data2-01/ztf_20181217_programid1-9
    >   992M	/data2-01/ztf_20181217_programid1-1
    >   993M	/data2-01/ztf_20181217_programid1-15
    >   992M	/data2-01/ztf_20181217_programid1-6
    >   991M	/data2-01/ztf_20181217_programid1-0
    >   993M	/data2-01/ztf_20181217_programid1-7
    >   30G	/data2-01
    >   ---- ----
    >   1.2G	/data2-02/ztf_20181219_programid1-15
    >   1.2G	/data2-02/ztf_20181219_programid1-3
    >   1.8G	/data2-02/ztf_20181219_programid1-14
    >   1.8G	/data2-02/ztf_20181219_programid1-5
    >   1.8G	/data2-02/ztf_20181219_programid1-12
    >   1.8G	/data2-02/ztf_20181219_programid1-0
    >   646M	/data2-02/ztf_20181220_programid1-0
    >   646M	/data2-02/ztf_20181220_programid1-8
    >   646M	/data2-02/ztf_20181220_programid1-9
    >   646M	/data2-02/ztf_20181220_programid1-3
    >   646M	/data2-02/ztf_20181220_programid1-11
    >   646M	/data2-02/ztf_20181220_programid1-2
    >   14G	/data2-02


# -----------------------------------------------------
# Check the disc use on each Kafka node.
#[user@trop03]

    for vmname in ${kfnames[@]}
        do
            ssh \
                ${sshopts[*]} \
                ${sshuser:?}@${vmname:?} \
                    "
                    echo \"---- ---- ---- ----\"
                    echo \"[\$(hostname)][\$(date)]\"

                    echo \"---- ----\"
                    df -h \"/data1-01\"

                    echo \"---- ----\"
                    df -h \"/data1-02\"

                    echo \"---- ----\"
                    df -h \"/data2-01\"

                    echo "---- ----"
                    df -h \"/data2-02\"
                    "
        done


    >   ---- ---- ---- ----
    >   [Stedigo][Mon 24 Dec 11:06:13 GMT 2018]
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdc         32G   31G  4.2M 100% /data1-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vde         64G   14G   49G  22% /data1-02
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdd         32G   31G  3.3M 100% /data2-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdf         64G   11G   52G  18% /data2-02
    >   ---- ---- ---- ----
    >   [Angece][Mon 24 Dec 11:06:14 GMT 2018]
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdc         32G   31G  3.7M 100% /data1-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vde         64G   15G   48G  24% /data1-02
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdd         32G   31G  4.1M 100% /data2-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdf         64G   11G   52G  18% /data2-02
    >   ---- ---- ---- ----
    >   [Edwalafia][Mon 24 Dec 11:06:14 GMT 2018]
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdc         32G   31G  5.9M 100% /data1-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vde         64G   12G   51G  20% /data1-02
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdd         32G   31G  3.4M 100% /data2-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdf         64G   12G   51G  20% /data2-02
    >   ---- ---- ---- ----
    >   [Onoza][Mon 24 Dec 11:06:15 GMT 2018]
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdc         32G   31G  4.4M 100% /data1-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vde         64G   11G   52G  18% /data1-02
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdd         32G   31G  4.6M 100% /data2-01
    >   ---- ----
    >   Filesystem      Size  Used Avail Use% Mounted on
    >   /dev/vdf         64G   14G   49G  22% /data2-02



